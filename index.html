<!DOCTYPE html>
<html lang="th">
<head>
    <!-- ตั้งค่าพื้นฐานของหน้าเว็บ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบแผนที่โรงเรียนอัจฉริยะ</title>
    
    <!-- เพิ่ม Font Awesome สำหรับไอคอนสวยๆ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* =================== CSS STYLES - ตั้งค่าการแสดงผล =================== */
        
        /* รีเซ็ตการตั้งค่าเริ่มต้นของเบราว์เซอร์ */
        * {
            margin: 0;           /* ไม่มีระยะขอบนอก */
            padding: 0;          /* ไม่มีระยะขอบใน */
            box-sizing: border-box; /* คำนวณขนาดรวมขอบและระยะขอบ */
        }

        /* สไตล์พื้นฐานของ body */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* ฟอนต์หลัก */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);  /* พื้นหลังไล่สี */
            min-height: 100vh;   /* ความสูงขั้นต่ำเต็มจอ */
            color: #333;         /* สีข้อความหลัก */
            overflow-x: hidden;  /* ซ่อนแถบเลื่อนแนวนอน */
        }

        /* คอนเทนเนอร์หลักของเว็บไซต์ */
        .container {
            max-width: 1200px;  /* ความกว้างสูงสุด */
            margin: 0 auto;     /* จัดกึ่งกลาง */
            padding: 20px;      /* ระยะขอบใน */
        }

        /* ส่วนหัวของเว็บไซต์ */
        .header {
            background: white;                              /* พื้นหลังสีขาว */
            padding: 20px;                                  /* ระยะขอบใน */
            border-radius: 15px;                           /* มุมโค้ง */
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);      /* เงา */
            margin-bottom: 20px;                           /* ระยะห่างด้านล่าง */
            text-align: center;                            /* จัดข้อความกึ่งกลาง */
            position: relative;                            /* ตำแหน่งสัมพัทธ์ */
        }

        .header h1 {
            color: #333;         /* สีข้อความ */
            margin-bottom: 10px; /* ระยะห่างด้านล่าง */
            font-size: 2em;      /* ขนาดฟอนต์ */
        }

        /* ปุ่มแท็บนำทาง */
        .nav-tabs {
            display: flex;            /* จัดเรียงแนวนอน */
            gap: 10px;               /* ระยะห่างระหว่างปุ่ม */
            justify-content: center; /* จัดกึ่งกลาง */
            margin-top: 20px;        /* ระยะห่างด้านบน */
            flex-wrap: wrap;         /* ขึ้นบรรทัดใหม่เมื่อไม่พอ */
        }

        .nav-tab {
            padding: 10px 20px;                               /* ระยะขอบใน */
            background: #f8f9ff;                             /* สีพื้นหลัง */
            border: none;                                     /* ไม่มีขอบ */
            border-radius: 25px;                             /* มุมโค้งมาก */
            cursor: pointer;                                 /* เปลี่ยนเคอร์เซอร์เมื่อชี้ */
            transition: all 0.3s ease;                      /* เอฟเฟ็กต์การเปลี่ยน */
            font-weight: 500;                                /* ความหนาฟอนต์ */
        }

        /* เมื่อปุ่มแท็บถูกเลือก */
        .nav-tab.active {
            background: #667eea;                                 /* สีพื้นหลังเมื่อเลือก */
            color: white;                                        /* สีข้อความเมื่อเลือก */
            transform: translateY(-2px);                        /* ยกขึ้นเล็กน้อย */
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);   /* เงาสี */
        }

        /* เมื่อชี้เมาส์ที่ปุ่มแท็บ */
        .nav-tab:hover {
            transform: translateY(-2px);                  /* ยกขึ้นเล็กน้อย */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);      /* เงา */
        }

        /* ปุ่ม Admin พิเศษ */
        .admin-btn {
            position: absolute;    /* ตำแหน่งสัมบูรณ์ */
            top: 20px;            /* ห่างจากด้านบน */
            right: 20px;          /* ห่างจากด้านขวา */
            padding: 8px 16px;    /* ระยะขอบใน */
            background: #dc3545;  /* สีแดง */
            color: white;         /* ข้อความสีขาว */
            border: none;         /* ไม่มีขอบ */
            border-radius: 20px;  /* มุมโค้ง */
            cursor: pointer;      /* เปลี่ยนเคอร์เซอร์ */
            font-size: 12px;      /* ขนาดฟอนต์เล็ก */
            transition: all 0.3s ease; /* เอฟเฟ็กต์การเปลี่ยน */
        }

        .admin-btn:hover {
            background: #c82333;  /* สีเข้มขึ้นเมื่อชี้ */
            transform: scale(1.05); /* ขยายเล็กน้อย */
        }

        /* ปุ่มออกจากระบบ */
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 8px 16px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        /* หน้าต่างๆ ของเว็บไซต์ */
        .page {
            display: none;                               /* ซ่อนเริ่มต้น */
            background: white;                           /* พื้นหลังสีขาว */
            border-radius: 15px;                         /* มุมโค้ง */
            padding: 30px;                              /* ระยะขอบใน */
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);   /* เงา */
            min-height: 500px;                          /* ความสูงขั้นต่ำ */
        }

        /* หน้าที่กำลังแสดง */
        .page.active {
            display: block;                   /* แสดง */
            animation: fadeIn 0.5s ease-in-out; /* เอฟเฟ็กต์จางเข้า */
        }

        /* เอฟเฟ็กต์จางเข้า */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); } /* เริ่มต้นจาง + เลื่อนลง */
            to { opacity: 1; transform: translateY(0); }      /* สุดท้ายชัด + ตำแหน่งปกติ */
        }

        /* ======================== หน้าล็อกอิน ======================== */
        
        .login-container {
            max-width: 400px;     /* ความกว้างสูงสุด */
            margin: 50px auto;    /* จัดกึ่งกลางแนวตั้ง */
            text-align: center;   /* ข้อความกึ่งกลาง */
        }

        .login-form {
            background: white;                            /* พื้นหลังสีขาว */
            padding: 40px;                               /* ระยะขอบใน */
            border-radius: 15px;                         /* มุมโค้ง */
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);    /* เงา */
        }

        .login-form h2 {
            color: #667eea;       /* สีข้อความ */
            margin-bottom: 30px;  /* ระยะห่างด้านล่าง */
        }

        .form-group {
            margin-bottom: 20px;  /* ระยะห่างด้านล่าง */
            text-align: left;     /* ข้อความจัดซ้าย */
        }

        .form-group label {
            display: block;       /* แสดงเป็นบล็อก */
            margin-bottom: 5px;   /* ระยะห่างด้านล่าง */
            font-weight: 500;     /* ความหนาฟอนต์ */
        }

        .form-group input {
            width: 100%;                         /* ความกว้างเต็ม */
            padding: 12px;                       /* ระยะขอบใน */
            border: 2px solid #ddd;              /* ขอบ */
            border-radius: 8px;                  /* มุมโค้ง */
            font-size: 16px;                     /* ขนาดฟอนต์ */
            transition: border-color 0.3s ease; /* เอฟเฟ็กต์การเปลี่ยนสีขอบ */
        }

        /* เมื่อคลิกที่ช่องกรอกข้อมูล */
        .form-group input:focus {
            outline: none;           /* ไม่มีขอบฟ้า */
            border-color: #667eea;   /* เปลี่ยนสีขอบ */
        }

        .login-btn {
            width: 100%;                    /* ความกว้างเต็ม */
            padding: 12px;                  /* ระยะขอบใน */
            background: #667eea;            /* สีพื้นหลัง */
            color: white;                   /* สีข้อความ */
            border: none;                   /* ไม่มีขอบ */
            border-radius: 8px;             /* มุมโค้ง */
            font-size: 16px;                /* ขนาดฟอนต์ */
            cursor: pointer;                /* เปลี่ยนเคอร์เซอร์ */
            transition: background 0.3s ease; /* เอฟเฟ็กต์การเปลี่ยนสี */
        }

        .login-btn:hover {
            background: #5a6fd8; /* สีเข้มขึ้นเมื่อชี้ */
        }

        /* ======================== ระบบการค้นหา ======================== */
        
        .search-box {
            display: flex;       /* จัดเรียงแนวนอน */
            gap: 10px;          /* ระยะห่างระหว่างองค์ประกอบ */
            margin-bottom: 15px; /* ระยะห่างด้านล่าง */
            flex-wrap: wrap;    /* ขึ้นบรรทัดใหม่เมื่อไม่พอ */
        }

        .search-input {
            flex: 1;                             /* ขยายเต็มพื้นที่ */
            min-width: 250px;                    /* ความกว้างขั้นต่ำ */
            padding: 12px 15px;                  /* ระยะขอบใน */
            border: 2px solid #ddd;              /* ขอบ */
            border-radius: 10px;                 /* มุมโค้ง */
            font-size: 16px;                     /* ขนาดฟอนต์ */
            transition: all 0.3s ease;          /* เอฟเฟ็กต์การเปลี่ยน */
        }

        .search-input:focus {
            outline: none;                                    /* ไม่มีขอบฟ้า */
            border-color: #667eea;                           /* เปลี่ยนสีขอบ */
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); /* เงาสี */
        }

        .search-btn {
            padding: 12px 24px;                       /* ระยะขอบใน */
            background: #667eea;                      /* สีพื้นหลัง */
            color: white;                             /* สีข้อความ */
            border: none;                             /* ไม่มีขอบ */
            border-radius: 10px;                      /* มุมโค้ง */
            cursor: pointer;                          /* เปลี่ยนเคอร์เซอร์ */
            font-weight: 500;                         /* ความหนาฟอนต์ */
            transition: all 0.3s ease;               /* เอฟเฟ็กต์การเปลี่ยน */
            white-space: nowrap;                      /* ไม่ขึ้นบรรทัดใหม่ */
        }

        .search-btn:hover {
            background: #5a6fd8;                                /* สีเข้มขึ้น */
            transform: translateY(-2px);                        /* ยกขึ้น */
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);   /* เงาสี */
        }

        /* ปุ่มเปลี่ยนโหมดการค้นหา */
        .search-mode-tabs {
            display: flex;            /* จัดเรียงแนวนอน */
            gap: 10px;               /* ระยะห่าง */
            justify-content: center; /* จัดกึ่งกลาง */
            margin-bottom: 20px;     /* ระยะห่างด้านล่าง */
            flex-wrap: wrap;         /* ขึ้นบรรทัดใหม่ */
        }

        .search-mode-btn {
            padding: 10px 20px;                               /* ระยะขอบใน */
            background: #f8f9ff;                             /* สีพื้นหลัง */
            border: 2px solid #ddd;                          /* ขอบ */
            border-radius: 25px;                             /* มุมโค้ง */
            cursor: pointer;                                 /* เปลี่ยนเคอร์เซอร์ */
            transition: all 0.3s ease;                      /* เอฟเฟ็กต์การเปลี่ยน */
            font-weight: 500;                                /* ความหนาฟอนต์ */
            color: #333;                                     /* สีข้อความ */
        }

        .search-mode-btn.active {
            background: #667eea;                                /* สีพื้นหลังเมื่อเลือก */
            color: white;                                       /* สีข้อความเมื่อเลือก */
            border-color: #667eea;                             /* สีขอบเมื่อเลือก */
            transform: translateY(-2px);                       /* ยกขึ้น */
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);  /* เงาสี */
        }

        .search-mode-btn:hover {
            transform: translateY(-2px);                /* ยกขึ้น */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);    /* เงา */
        }

        /* ส่วนการค้นหาแต่ละโหมด */
        .search-section {
            display: none; /* ซ่อนเริ่มต้น */
        }

        .search-section.active {
            display: block;                      /* แสดงเมื่อเลือก */
            animation: fadeIn 0.3s ease-in-out; /* เอฟเฟ็กต์จางเข้า */
        }

        /* ======================== ผลการค้นหาแบบเรียลไทม์ ======================== */
        
        .live-results {
            margin-top: 15px;      /* ระยะห่างด้านบน */
            max-height: 300px;     /* ความสูงสูงสุด */
            overflow-y: auto;      /* แถบเลื่อนแนวตั้ง */
            border-radius: 10px;   /* มุมโค้ง */
        }

        .live-result-item {
            padding: 12px 15px;                  /* ระยะขอบใน */
            background: white;                   /* พื้นหลังสีขาว */
            border: 1px solid #e0e0e0;           /* ขอบบาง */
            margin-bottom: 2px;                  /* ระยะห่างด้านล่าง */
            cursor: pointer;                     /* เปลี่ยนเคอร์เซอร์ */
            transition: all 0.3s ease;          /* เอฟเฟ็กต์การเปลี่ยน */
            display: flex;                       /* จัดเรียงแนวนอน */
            align-items: center;                 /* จัดกึ่งกลางแนวตั้ง */
            gap: 10px;                          /* ระยะห่าง */
        }

        /* รายการแรกมีมุมโค้งด้านบน */
        .live-result-item:first-child {
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
        }

        /* รายการสุดท้ายมีมุมโค้งด้านล่าง */
        .live-result-item:last-child {
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            margin-bottom: 0;
        }

        /* เมื่อชี้เมาส์ที่รายการผลลัพธ์ */
        .live-result-item:hover {
            background: #f0f8ff;                    /* เปลี่ยนสีพื้นหลัง */
            border-color: #667eea;                  /* เปลี่ยนสีขอบ */
            transform: translateX(5px);             /* เลื่อนขวา */
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); /* เงา */
        }

        .live-result-icon {
            font-size: 20px;  /* ขนาดไอคอน */
            min-width: 30px;   /* ความกว้างขั้นต่ำ */
        }

        .live-result-content {
            flex: 1; /* ขยายเต็มพื้นที่ */
        }

        .live-result-title {
            font-weight: 600;    /* ความหนาฟอนต์ */
            color: #333;         /* สีข้อความ */
            margin-bottom: 2px;  /* ระยะห่างด้านล่าง */
        }

        .live-result-subtitle {
            font-size: 12px; /* ขนาดฟอนต์เล็ก */
            color: #666;      /* สีข้อความอ่อน */
        }

        /* ======================== ระบบ Dropdown ======================== */
        
        .dropdown-container {
            background: white;                        /* พื้นหลังสีขาว */
            padding: 20px;                           /* ระยะขอบใน */
            border-radius: 15px;                     /* มุมโค้ง */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); /* เงา */
        }

        .dropdown-group {
            margin-bottom: 20px; /* ระยะห่างด้านล่าง */
        }

        .dropdown-group label {
            display: block;       /* แสดงเป็นบล็อก */
            margin-bottom: 8px;   /* ระยะห่างด้านล่าง */
            font-weight: 600;     /* ความหนาฟอนต์ */
            color: #333;          /* สีข้อความ */
        }

        .custom-dropdown {
            position: relative; /* ตำแหน่งสัมพัทธ์ */
            width: 100%;        /* ความกว้างเต็ม */
        }

        .dropdown-input {
            width: 100%;                             /* ความกว้างเต็ม */
            padding: 12px 40px 12px 15px;           /* ระยะขอบใน */
            border: 2px solid #ddd;                  /* ขอบ */
            border-radius: 10px;                     /* มุมโค้ง */
            font-size: 16px;                         /* ขนาดฟอนต์ */
            background: white;                       /* พื้นหลังสีขาว */
            cursor: pointer;                         /* เปลี่ยนเคอร์เซอร์ */
            transition: all 0.3s ease;              /* เอฟเฟ็กต์การเปลี่ยน */
        }

        .dropdown-input:focus {
            outline: none;                                    /* ไม่มีขอบฟ้า */
            border-color: #667eea;                           /* เปลี่ยนสีขอบ */
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); /* เงาสี */
        }

        /* ลูกศรของ dropdown */
        .dropdown-arrow {
            position: absolute;              /* ตำแหน่งสัมบูรณ์ */
            top: 50%;                       /* กึ่งกลางแนวตั้ง */
            right: 15px;                    /* ห่างจากขวา */
            transform: translateY(-50%);    /* จัดกึ่งกลางแนวตั้ง */
            color: #666;                    /* สีเทา */
            font-size: 12px;                /* ขนาดฟอนต์เล็ก */
            pointer-events: none;           /* ไม่สามารถคลิกได้ */
            transition: transform 0.3s ease; /* เอฟเฟ็กต์การหมุน */
        }

        /* ลูกศรหมุนเมื่อเปิด dropdown */
        .custom-dropdown.open .dropdown-arrow {
            transform: translateY(-50%) rotate(180deg);
        }

        /* รายการตัวเลือกใน dropdown */
        .dropdown-options {
            position: absolute;                    /* ตำแหน่งสัมบูรณ์ */
            top: 100%;                            /* ด้านล่างของ input */
            left: 0;                              /* ซ้ายสุด */
            right: 0;                             /* ขวาสุด */
            background: white;                    /* พื้นหลังสีขาว */
            border: 2px solid #667eea;           /* ขอบสี */
            border-top: none;                     /* ไม่มีขอบด้านบน */
            border-radius: 0 0 10px 10px;        /* มุมโค้งด้านล่าง */
            max-height: 200px;                    /* ความสูงสูงสุด */
            overflow-y: auto;                     /* แถบเลื่อนแนวตั้ง */
            z-index: 1000;                        /* ลำดับการแสดง */
            display: none;                        /* ซ่อนเริ่มต้น */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); /* เงา */
        }

        .dropdown-options.show {
            display: block; /* แสดงเมื่อเปิด */
        }

        .dropdown-option {
            padding: 12px 15px;                 /* ระยะขอบใน */
            cursor: pointer;                    /* เปลี่ยนเคอร์เซอร์ */
            transition: background 0.2s ease;  /* เอฟเฟ็กต์การเปลี่ยนสี */
            border-bottom: 1px solid #f0f0f0;  /* ขอบด้านล่าง */
            display: flex;                      /* จัดเรียงแนวนอน */
            align-items: center;                /* จัดกึ่งกลางแนวตั้ง */
            gap: 10px;                         /* ระยะห่าง */
        }

        .dropdown-option:last-child {
            border-bottom: none; /* รายการสุดท้ายไม่มีขอบ */
        }

        .dropdown-option:hover {
            background: #f0f8ff; /* สีพื้นหลังเมื่อชี้ */
        }

        .dropdown-option.selected {
            background: #667eea; /* สีพื้นหลังเมื่อเลือก */
            color: white;        /* สีข้อความเมื่อเลือก */
        }

        .dropdown-option.selected .dropdown-option-subtitle {
            color: rgba(255,255,255,0.8); /* สีข้อความรองเมื่อเลือก */
        }

        .dropdown-option-icon {
            font-size: 16px;  /* ขนาดไอคอน */
            min-width: 20px;   /* ความกว้างขั้นต่ำ */
        }

        .dropdown-option-text {
            flex: 1; /* ขยายเต็มพื้นที่ */
        }

        .dropdown-option-subtitle {
            font-size: 12px;    /* ขนาดฟอนต์เล็ก */
            opacity: 0.7;       /* ความทึบ */
            margin-top: 2px;    /* ระยะห่างด้านบน */
        }

        /* ปุ่มกระทำใน dropdown */
        .dropdown-actions {
            display: flex;            /* จัดเรียงแนวนอน */
            gap: 10px;               /* ระยะห่าง */
            justify-content: center; /* จัดกึ่งกลาง */
            margin-top: 20px;        /* ระยะห่างด้านบน */
            flex-wrap: wrap;         /* ขึ้นบรรทัดใหม่ */
        }

        /* ======================== การแสดงผลการค้นหา ======================== */
        
        .search-results {
            margin-top: 20px; /* ระยะห่างด้านบน */
        }

        .result-item {
            padding: 15px;                            /* ระยะขอบใน */
            background: #f8f9ff;                     /* พื้นหลังสีอ่อน */
            border-left: 4px solid #667eea;          /* ขอบซ้ายสี */
            margin-bottom: 10px;                     /* ระยะห่างด้านล่าง */
            border-radius: 0 8px 8px 0;              /* มุมโค้งทางขวา */
            cursor: pointer;                          /* เปลี่ยนเคอร์เซอร์ */
            transition: all 0.3s ease;               /* เอฟเฟ็กต์การเปลี่ยน */
        }

        .result-item:hover {
            background: #e6f3ff;        /* เปลี่ยนสีเมื่อชี้ */
            transform: translateX(5px);  /* เลื่อนขวา */
        }

        /* ข้อความเมื่อไม่พบผลลัพธ์ */
        .no-results {
            text-align: center;          /* ข้อความกึ่งกลาง */
            padding: 30px 20px;          /* ระยะขอบใน */
            color: #666;                 /* สีข้อความอ่อน */
            background: #f8f9ff;         /* พื้นหลังสีอ่อน */
            border-radius: 10px;         /* มุมโค้ง */
            margin-top: 15px;            /* ระยะห่างด้านบน */
        }

        .no-results-icon {
            font-size: 48px;      /* ขนาดไอคอนใหญ่ */
            margin-bottom: 10px;  /* ระยะห่างด้านล่าง */
        }

        /* ======================== แผนที่ ======================== */
        
        .map-container {
            display: flex;        /* จัดเรียงแนวนอน */
            gap: 20px;           /* ระยะห่าง */
            height: 500px;       /* ความสูง */
            margin-top: 20px;    /* ระยะห่างด้านบน */
        }

        .map-area {
            flex: 2;                                 /* สัดส่วน 2 ส่วน */
            background: #f8f9ff;                    /* พื้นหลังสีอ่อน */
            border: 2px solid #667eea;              /* ขอบสี */
            border-radius: 10px;                    /* มุมโค้ง */
            position: relative;                     /* ตำแหน่งสัมพัทธ์ */
            overflow: hidden;                       /* ซ่อนส่วนเกิน */
        }

        .map-image {
            width: 100%;         /* ความกว้างเต็ม */
            height: 100%;        /* ความสูงเต็ม */
            object-fit: cover;   /* ปรับขนาดให้พอดี */
        }

        /* ตัวชี้ตำแหน่งบนแผนที่ */
        .room-marker {
            position: absolute;                      /* ตำแหน่งสัมบูรณ์ */
            width: 30px;                            /* ความกว้าง */
            height: 30px;                           /* ความสูง */
            background: #667eea;                    /* สีพื้นหลัง */
            border-radius: 50%;                     /* ทำให้เป็นวงกลม */
            cursor: pointer;                        /* เปลี่ยนเคอร์เซอร์ */
            display: flex;                          /* จัดเรียง */
            align-items: center;                    /* จัดกึ่งกลางแนวตั้ง */
            justify-content: center;                /* จัดกึ่งกลางแนวนอน */
            color: white;                           /* สีข้อความ */
            font-weight: bold;                      /* ความหนาฟอนต์ */
            transition: all 0.3s ease;             /* เอฟเฟ็กต์การเปลี่ยน */
            border: 3px solid white;                /* ขอบสีขาว */
            box-shadow: 0 2px 10px rgba(0,0,0,0.3); /* เงา */
            z-index: 100;                           /* ลำดับการแสดง */
        }

        .room-marker:hover {
            transform: scale(1.3); /* ขยายเมื่อชี้ */
            z-index: 200;          /* ลำดับการแสดงสูงขึ้น */
        }

        /* ตัวชี้ที่ถูกเน้น */
        .room-marker.highlighted {
            background: #dc3545;                      /* สีแดง */
            animation: bounce 1s ease-in-out infinite; /* เอฟเฟ็กต์กระเด้ง */
        }

        /* เอฟเฟ็กต์กระเด้ง */
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }     /* ตำแหน่งปกติ */
            40% { transform: translateY(-10px); }                     /* กระเด้งสูง */
            60% { transform: translateY(-5px); }                      /* กระเด้งต่ำ */
        }

        /* ตัวชี้ตำแหน่งผู้ใช้ */
        .user-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #28a745;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            z-index: 150;
            cursor: move;
        }

        .user-marker::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }

        /* เส้นทาง */
        .route-path {
            position: absolute;
            border: 3px dashed #28a745;
            z-index: 50;
            animation: dash 2s linear infinite;
        }

        @keyframes dash {
            to { stroke-dashoffset: -20; }
        }

        /* ปุ่มควบคุมแผนที่ */
        .map-controls {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 200;
        }

        .map-control-btn {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.9);
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .map-control-btn:hover {
            background: white;
            transform: scale(1.1);
        }

        /* เข็มทิศ */
        .compass {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.9);
            border-radius: 50%;
            border: 2px solid #667eea;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
            transition: transform 0.3s ease;
        }

        .compass-needle {
            width: 30px;
            height: 30px;
            background: linear-gradient(180deg, #dc3545 0%, #dc3545 50%, #666 50%, #666 100%);
            border-radius: 50%;
            position: relative;
        }

        .compass-needle::before {
            content: 'N';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
            font-weight: bold;
            color: #dc3545;
        }

        /* ข้อมูลห้อง */
        .room-info {
            flex: 1;                             /* สัดส่วน 1 ส่วน */
            background: #f8f9ff;                /* พื้นหลังสีอ่อน */
            padding: 20px;                      /* ระยะขอบใน */
            border-radius: 10px;                /* มุมโค้ง */
            border: 2px solid #ddd;             /* ขอบ */
        }

        .room-details {
            display: none; /* ซ่อนเริ่มต้น */
        }

        .room-details.active {
            display: block; /* แสดงเมื่อเลือก */
        }

        /* ======================== แกลอรี่รูปภาพ ======================== */
        
        .image-gallery {
            margin-top: 15px; /* ระยะห่างด้านบน */
        }

        .gallery-images {
            display: grid;                                      /* จัดเรียงแบบตาราง */
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); /* คอลัมน์อัตโนมัติ */
            gap: 10px;                                         /* ระยะห่าง */
            margin-top: 10px;                                  /* ระยะห่างด้านบน */
        }

        .gallery-image {
            width: 100%;                    /* ความกว้างเต็ม */
            height: 80px;                   /* ความสูงคงที่ */
            object-fit: cover;              /* ปรับขนาดให้พอดี */
            border-radius: 8px;             /* มุมโค้ง */
            cursor: pointer;                /* เปลี่ยนเคอร์เซอร์ */
            transition: transform 0.3s ease; /* เอฟเฟ็กต์การขยาย */
        }

        .gallery-image:hover {
            transform: scale(1.05); /* ขยายเล็กน้อยเมื่อชี้ */
        }

        /* ปุ่มเปลี่ยนมุมมองรูปภาพ */
        .view-mode-buttons {
            margin-top: 10px;
            display: flex;
            gap: 5px;
        }

        .view-mode-btn {
            padding: 5px 10px;
            background: #f8f9ff;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .view-mode-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .view-mode-btn:hover {
            background: #e6f3ff;
        }

        /* ======================== Modal รูปภาพ ======================== */
        
        .image-modal {
            display: none;               /* ซ่อนเริ่มต้น */
            position: fixed;             /* ตำแหน่งคงที่ */
            top: 0;                     /* ด้านบนสุด */
            left: 0;                    /* ด้านซ้ายสุด */
            width: 100%;                /* ความกว้างเต็มจอ */
            height: 100%;               /* ความสูงเต็มจอ */
            background: rgba(0,0,0,0.8); /* พื้นหลังดำใส */
            z-index: 2000;              /* ลำดับการแสดงสูงสุด */
            cursor: pointer;            /* เปลี่ยนเคอร์เซอร์ */
        }

        .modal-content {
            position: absolute;                    /* ตำแหน่งสัมบูรณ์ */
            top: 50%;                             /* กึ่งกลางแนวตั้ง */
            left: 50%;                            /* กึ่งกลางแนวนอน */
            transform: translate(-50%, -50%);     /* จัดกึ่งกลางแบบสมบูรณ์ */
            max-width: 90%;                       /* ความกว้างสูงสุด */
            max-height: 90%;                      /* ความสูงสูงสุด */
        }

        .modal-image {
            width: 100%;           /* ความกว้างเต็ม */
            height: 100%;          /* ความสูงเต็ม */
            object-fit: contain;   /* ปรับขนาดให้พอดีโดยไม่ตัด */
        }

        /* Modal แผนที่แบบเต็มจอ */
        .fullscreen-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 3000;
        }

        .fullscreen-modal.active {
            display: block;
        }

        .fullscreen-map {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .fullscreen-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            z-index: 3100;
        }

        .fullscreen-btn {
            padding: 10px 15px;
            background: rgba(255,255,255,0.9);
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover {
            background: white;
        }

        /* ======================== การ์ดแนะนำ ======================== */
        
        .suggestion-card {
            background: #f8f9ff;                        /* พื้นหลังสีอ่อน */
            padding: 20px;                              /* ระยะขอบใน */
            border-radius: 10px;                        /* มุมโค้ง */
            border: 2px solid #ddd;                     /* ขอบ */
            cursor: pointer;                            /* เปลี่ยนเคอร์เซอร์ */
            transition: all 0.3s ease;                 /* เอฟเฟ็กต์การเปลี่ยน */
            text-align: center;                         /* ข้อความกึ่งกลาง */
        }

        .suggestion-card:hover {
            border-color: #667eea;                              /* เปลี่ยนสีขอบ */
            transform: translateY(-5px);                        /* ยกขึ้น */
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);   /* เงาสี */
        }

        .suggestion-card h4 {
            color: #333;         /* สีข้อความ */
            margin-bottom: 10px; /* ระยะห่างด้านล่าง */
            font-size: 16px;     /* ขนาดฟอนต์ */
        }

        .suggestion-card p {
            color: #666;         /* สีข้อความอ่อน */
            margin-bottom: 5px;  /* ระยะห่างด้านล่าง */
            font-size: 14px;     /* ขนาดฟอนต์ */
        }

        .suggestion-card small {
            color: #999;     /* สีข้อความอ่อนมาก */
            font-size: 12px; /* ขนาดฟอนต์เล็ก */
        }

        /* ======================== หน้าแอดมิน ======================== */
        
        .admin-section {
            margin-bottom: 30px;                        /* ระยะห่างด้านล่าง */
            padding: 25px;                              /* ระยะขอบใน */
            background: #f8f9ff;                        /* พื้นหลังสีอ่อน */
            border-radius: 12px;                        /* มุมโค้ง */
            border: 2px solid #ddd;                     /* ขอบ */
        }

        .admin-section h3 {
            color: #333;                              /* สีข้อความ */
            margin-bottom: 15px;                      /* ระยะห่างด้านล่าง */
            padding-bottom: 10px;                     /* ระยะขอบใน */
            border-bottom: 2px solid #667eea;         /* ขอบด้านล่างสี */
        }

        .admin-tabs {
            display: flex;       /* จัดเรียงแนวนอน */
            gap: 10px;          /* ระยะห่าง */
            margin-bottom: 20px; /* ระยะห่างด้านล่าง */
            flex-wrap: wrap;    /* ขึ้นบรรทัดใหม่ */
        }

        .admin-tab {
            padding: 10px 20px;                /* ระยะขอบใน */
            background: #f8f9ff;              /* พื้นหลังสีอ่อน */
            border: none;                      /* ไม่มีขอบ */
            border-radius: 20px;               /* มุมโค้ง */
            cursor: pointer;                   /* เปลี่ยนเคอร์เซอร์ */
            transition: all 0.3s ease;        /* เอฟเฟ็กต์การเปลี่ยน */
            font-weight: 500;                  /* ความหนาฟอนต์ */
        }

        .admin-tab.active {
            background: #667eea; /* สีพื้นหลังเมื่อเลือก */
            color: white;        /* สีข้อความเมื่อเลือก */
        }

        .admin-content {
            display: none; /* ซ่อนเริ่มต้น */
        }

        .admin-content.active {
            display: block; /* แสดงเมื่อเลือก */
        }

        /* ======================== ตาราง ======================== */
        
        .room-table {
            width: 100%;                             /* ความกว้างเต็ม */
            border-collapse: collapse;               /* รวมขอบ */
            margin-top: 15px;                        /* ระยะห่างด้านบน */
            background: white;                       /* พื้นหลังสีขาว */
            border-radius: 10px;                     /* มุมโค้ง */
            overflow: hidden;                        /* ซ่อนส่วนเกิน */
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); /* เงา */
        }

        .room-table th, .room-table td {
            padding: 12px;           /* ระยะขอบใน */
            text-align: left;        /* ข้อความจัดซ้าย */
            border-bottom: 1px solid #ddd; /* ขอบด้านล่าง */
        }

        .room-table th {
            background: #667eea; /* พื้นหลังสีหลัก */
            color: white;        /* ข้อความสีขาว */
            font-weight: 600;    /* ความหนาฟอนต์ */
        }

        .room-table tr:hover {
            background: #f8f9ff; /* สีพื้นหลังเมื่อชี้ */
        }

        /* ======================== ฟอร์ม ======================== */
        
        .form-row {
            display: flex;       /* จัดเรียงแนวนอน */
            gap: 10px;          /* ระยะห่าง */
            margin-bottom: 15px; /* ระยะห่างด้านล่าง */
            flex-wrap: wrap;    /* ขึ้นบรรทัดใหม่ */
        }

        .form-row input, .form-row textarea, .form-row select {
            flex: 1;                             /* ขยายเต็มพื้นที่ */
            min-width: 200px;                    /* ความกว้างขั้นต่ำ */
            padding: 10px;                       /* ระยะขอบใน */
            border: 2px solid #ddd;              /* ขอบ */
            border-radius: 8px;                  /* มุมโค้ง */
            font-size: 14px;                     /* ขนาดฟอนต์ */
        }

        .form-row input:focus, .form-row textarea:focus, .form-row select:focus {
            outline: none;           /* ไม่มีขอบฟ้า */
            border-color: #667eea;   /* เปลี่ยนสีขอบ */
        }

        .form-row textarea {
            min-height: 80px;  /* ความสูงขั้นต่ำ */
            resize: vertical;  /* ปรับขนาดแนวตั้งได้ */
        }

        /* ======================== ปุ่ม ======================== */
        
        .btn {
            padding: 8px 16px;                 /* ระยะขอบใน */
            border: none;                      /* ไม่มีขอบ */
            border-radius: 5px;                /* มุมโค้ง */
            cursor: pointer;                   /* เปลี่ยนเคอร์เซอร์ */
            margin-right: 5px;                 /* ระยะห่างด้านขวา */
            margin-bottom: 5px;                /* ระยะห่างด้านล่าง */
            transition: all 0.3s ease;        /* เอฟเฟ็กต์การเปลี่ยน */
            font-size: 12px;                   /* ขนาดฟอนต์ */
            font-weight: 500;                  /* ความหนาฟอนต์ */
        }

        /* สีปุ่มแต่ละประเภท */
        .btn-primary { background: #667eea; color: white; } /* ปุ่มหลัก - สีน้ำเงิน */
        .btn-success { background: #28a745; color: white; } /* ปุ่มสำเร็จ - สีเขียว */
        .btn-danger { background: #dc3545; color: white; }  /* ปุ่มอันตราย - สีแดง */
        .btn-warning { background: #ffc107; color: #333; }  /* ปุ่มเตือน - สีเหลือง */

        .btn:hover {
            transform: translateY(-2px);                /* ยกขึ้นเมื่อชี้ */
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);    /* เงา */
        }

        /* ======================== อัปโหลดไฟล์ ======================== */
        
        .upload-area {
            padding: 30px;                           /* ระยะขอบใน */
            border: 3px dashed #ddd;                 /* ขอบประ */
            border-radius: 15px;                     /* มุมโค้ง */
            text-align: center;                      /* ข้อความกึ่งกลาง */
            cursor: pointer;                         /* เปลี่ยนเคอร์เซอร์ */
            transition: all 0.3s ease;              /* เอฟเฟ็กต์การเปลี่ยน */
            background: white;                       /* พื้นหลังสีขาว */
            margin-bottom: 20px;                     /* ระยะห่างด้านล่าง */
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: #667eea;  /* เปลี่ยนสีขอบเมื่อชี้ */
            background: #f8f9ff;    /* เปลี่ยนสีพื้นหลังเมื่อชี้ */
        }

        .file-input {
            display: none; /* ซ่อน input ไฟล์ */
        }

        /* ======================== การแจ้งเตือน ======================== */
        
        .notification {
            position: fixed;                       /* ตำแหน่งคงที่ */
            top: 20px;                            /* ห่างจากด้านบน */
            right: 20px;                          /* ห่างจากด้านขวา */
            padding: 15px 20px;                   /* ระยะขอบใน */
            background: #28a745;                  /* สีพื้นหลังเขียว */
            color: white;                         /* ข้อความสีขาว */
            border-radius: 8px;                   /* มุมโค้ง */
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3); /* เงาสีเขียว */
            opacity: 0;                           /* โปร่งใสเริ่มต้น */
            transform: translateX(300px);         /* เลื่อนออกไปด้านขวา */
            transition: all 0.3s ease;           /* เอฟเฟ็กต์การเปลี่ยน */
            z-index: 3000;                        /* ลำดับการแสดงสูง */
            max-width: 300px;                     /* ความกว้างสูงสุด */
        }

        .notification.show {
            opacity: 1;                /* แสดงเต็มที่ */
            transform: translateX(0);  /* กลับมาตำแหน่งปกติ */
        }

        .notification.error {
            background: #dc3545; /* สีแดงสำหรับข้อผิดพลาด */
        }

        .notification.warning {
            background: #ffc107; /* สีเหลืองสำหรับคำเตือน */
            color: #333;         /* ข้อความสีเข้ม */
        }

        /* ======================== โหลดดิ้ง ======================== */
        
        .loading {
            display: none;        /* ซ่อนเริ่มต้น */
            text-align: center;   /* ข้อความกึ่งกลาง */
            padding: 20px;        /* ระยะขอบใน */
        }

        .loading.show {
            display: block; /* แสดงเมื่อโหลด */
        }

        .spinner {
            border: 4px solid #f3f3f3;               /* ขอบสีอ่อน */
            border-top: 4px solid #667eea;           /* ขอบบนสีหลัก */
            border-radius: 50%;                      /* ทำให้เป็นวงกลม */
            width: 40px;                             /* ความกว้าง */
            height: 40px;                            /* ความสูง */
            animation: spin 1s linear infinite;      /* เอฟเฟ็กต์หมุน */
            margin: 0 auto 10px;                     /* จัดกึ่งกลาง */
        }

        /* เอฟเฟ็กต์หมุน */
        @keyframes spin {
            0% { transform: rotate(0deg); }    /* เริ่มต้น 0 องศา */
            100% { transform: rotate(360deg); } /* สิ้นสุด 360 องศา */
        }

        /* ======================== คลาสช่วย ======================== */
        
        .hidden {
            display: none !important; /* ซ่อนแบบบังคับ */
        }

        /* ======================== คำแนะนำสำหรับผู้ใช้ใหม่ ======================== */
        
        .user-guide {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .guide-step {
            background: rgba(255,255,255,0.1);
            padding: 10px 15px;
            border-radius: 10px;
            margin: 5px;
            display: inline-block;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .guide-step:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .quick-help {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: #667eea;
            border-radius: 50%;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .quick-help:hover {
            transform: scale(1.1);
            background: #5a6fd8;
        }

        /* ======================== Responsive Design - รองรับหน้าจอขนาดต่างๆ ======================== */
        
        /* หน้าจอขนาดกลาง (แท็บเล็ต) */
        @media (max-width: 768px) {
            .container {
                padding: 10px; /* ระยะขอบใน */
            }

            .header h1 {
                font-size: 1.5em; /* ขนาดฟอนต์เล็กลง */
            }

            .map-container {
                flex-direction: column; /* เปลี่ยนเป็นแนวตั้ง */
                height: auto;          /* ความสูงอัตโนมัติ */
            }

            .map-area {
                height: 300px;        /* ความสูงคงที่ */
                margin-bottom: 20px;  /* ระยะห่างด้านล่าง */
            }

            .nav-tabs, .admin-tabs {
                flex-direction: column; /* เปลี่ยนเป็นแนวตั้ง */
            }

            .nav-tab, .admin-tab {
                margin-bottom: 5px; /* ระยะห่างด้านล่าง */
                text-align: center; /* ข้อความกึ่งกลาง */
            }

            .search-box, .form-row {
                flex-direction: column; /* เปลี่ยนเป็นแนวตั้ง */
            }

            .search-btn {
                width: 100%;      /* ความกว้างเต็ม */
                margin-top: 10px; /* ระยะห่างด้านบน */
            }

            .form-row input, .form-row textarea, .form-row select {
                min-width: 100%;      /* ความกว้างขั้นต่ำเต็ม */
                margin-bottom: 10px;  /* ระยะห่างด้านล่าง */
            }

            .room-table {
                font-size: 12px;           /* ขนาดฟอนต์เล็ก */
                display: block;            /* แสดงเป็นบล็อก */
                overflow-x: auto;          /* แถบเลื่อนแนวนอน */
                white-space: nowrap;       /* ไม่ขึ้นบรรทัดใหม่ */
            }

            .room-table th, .room-table td {
                padding: 8px 4px;   /* ระยะขอบในเล็ก */
                min-width: 100px;   /* ความกว้างขั้นต่ำ */
            }
        }

        /* หน้าจอขนาดเล็ก (มือถือ) */
        @media (max-width: 480px) {
            .header {
                padding: 15px; /* ระยะขอบใน */
            }

            .page {
                padding: 20px; /* ระยะขอบใน */
            }

            .map-area {
                height: 250px; /* ความสูงเล็กลง */
            }

            .suggestion-card {
                padding: 15px; /* ระยะขอบใน */
            }

            .suggestion-card h4 {
                font-size: 14px; /* ขนาดฟอนต์เล็ก */
            }

            .suggestion-card p {
                font-size: 12px; /* ขนาดฟอนต์เล็ก */
            }

            .result-item {
                padding: 12px; /* ระยะขอบใน */
            }

            .live-result-item {
                padding: 10px 12px; /* ระยะขอบใน */
            }

            .live-result-title {
                font-size: 14px; /* ขนาดฟอนต์เล็ก */
            }

            .live-result-subtitle {
                font-size: 11px; /* ขนาดฟอนต์เล็กมาก */
            }

            .notification {
                top: 10px;                /* ห่างจากด้านบนเล็ก */
                right: 10px;              /* ห่างจากด้านขวาเล็ก */
                left: 10px;               /* ห่างจากด้านซ้ายเล็ก */
                max-width: none;          /* ไม่จำกัดความกว้าง */
                transform: translateY(-100px); /* เลื่อนขึ้น */
            }

            .notification.show {
                transform: translateY(0); /* กลับมาตำแหน่งปกติ */
            }
        }
    </style>
</head>
<body>
    <!-- ======================== หน้าล็อกอินแอดมิน ======================== -->
    <div class="login-page" id="loginPage">
        <div class="login-container">
            <div class="login-form">
                <h2>🔐 เข้าสู่ระบบผู้ดูแล</h2>
                <form onsubmit="adminLogin(event)">
                    <div class="form-group">
                        <label for="username">ชื่อผู้ใช้:</label>
                        <input type="text" id="username" placeholder="admin" required>
                    </div>
                    <div class="form-group">
                        <label for="password">รหัสผ่าน:</label>
                        <input type="password" id="password" placeholder="1234" required>
                    </div>
                    <button type="submit" class="login-btn">เข้าสู่ระบบ</button>
                </form>
                <p style="margin-top: 20px; font-size: 14px; color: #666;">
                    รหัสผ่านเริ่มต้น: <strong>admin / 1234</strong><br>
                    <a href="#" onclick="showMainApp(false)" style="color: #667eea;">กลับไปหน้าหลัก</a>
                </p>
            </div>
        </div>
    </div>

    <!-- ======================== หน้าหลักของเว็บไซต์ ======================== -->
    <div class="main-app hidden" id="mainApp">
        <div class="container">
            <!-- ส่วนหัวของเว็บไซต์ -->
            <div class="header">
                <!-- ปุ่ม Admin และ Logout -->
                <button class="admin-btn" id="adminBtn" onclick="showAdminLogin()">
                    <i class="fas fa-cog"></i> Admin
                </button>
                <button class="logout-btn hidden" id="logoutBtn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> ออกจากระบบ
                </button>
                
                <h1>🏫 ระบบแผนที่โรงเรียนอัจฉริยะ</h1>
                <p>ค้นหาห้องเรียนและสถานที่ต่างๆ ภายในโรงเรียน</p>
                
                <!-- เมนูนำทาง -->
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="showPage('search')">
                        <i class="fas fa-search"></i> ค้นหาห้อง
                    </button>
                    <button class="nav-tab" onclick="showPage('map')">
                        <i class="fas fa-map"></i> แผนที่
                    </button>
                    <button class="nav-tab hidden" id="adminTab" onclick="showPage('admin')">
                        <i class="fas fa-cogs"></i> จัดการข้อมูล
                    </button>
                </div>
            </div>

            <!-- ======================== หน้าค้นหา ======================== -->
            <div class="page active" id="search-page">
                <!-- คำแนะนำสำหรับผู้ใช้ใหม่ -->
                <div class="user-guide" id="userGuide">
                    <h3><i class="fas fa-info-circle"></i> คู่มือการใช้งาน</h3>
                    <p>เลือกวิธีการค้นหาที่เหมาะกับคุณ:</p>
                    <div style="margin-top: 10px;">
                        <span class="guide-step" onclick="switchSearchMode('free')">
                            🔤 ค้นหาแบบพิมพ์
                        </span>
                        <span class="guide-step" onclick="switchSearchMode('dropdown')">
                            📋 ค้นหาแบบเลือก
                        </span>
                        <span class="guide-step" onclick="quickSearch('classroom')">
                            🎓 ดูห้องเรียน
                        </span>
                        <span class="guide-step" onclick="showPage('map')">
                            🗺️ ดูแผนที่
                        </span>
                    </div>
                    <small style="display: block; margin-top: 10px;">
                        <i class="fas fa-lightbulb"></i> เคล็ดลับ: คลิกที่จุดบนแผนที่เพื่อดูข้อมูลห้อง
                    </small>
                </div>

                <div class="search-container">
                    <h2><i class="fas fa-search"></i> ค้นหาห้องเรียน</h2>
                    
                    <!-- ปุ่มเปลี่ยนโหมดการค้นหา -->
                    <div class="search-mode-tabs">
                        <button class="search-mode-btn active" onclick="switchSearchMode('free')" data-mode="free">
                            <i class="fas fa-keyboard"></i> ค้นหาแบบอิสระ
                        </button>
                        <button class="search-mode-btn" onclick="switchSearchMode('dropdown')" data-mode="dropdown">
                            <i class="fas fa-list"></i> ค้นหาแบบเลือก
                        </button>
                    </div>
                    
                    <!-- ค้นหาแบบอิสระ -->
                    <div class="search-section active" id="freeSearch">
                        <div class="search-box">
                            <input class="search-input" id="searchInput" 
                                   onkeypress="handleSearchKeyPress(event)" 
                                   oninput="liveSearch()" 
                                   placeholder="🔍 พิมพ์ชื่อห้อง รหัส หรือตำแหน่ง เช่น ม.4/1, R001, ห้องคอมพิวเตอร์..." 
                                   type="text">
                            <button class="search-btn" onclick="searchRoom()">
                                <i class="fas fa-search"></i> ค้นหา
                            </button>
                        </div>
                        <!-- ผลลัพธ์แบบ live search -->
                        <div class="live-results" id="liveResults"></div>
                    </div>
                    
                    <!-- ค้นหาแบบ dropdown -->
                    <div class="search-section" id="dropdownSearch">
                        <div class="dropdown-container">
                            <div class="dropdown-group">
                                <label for="roomCodeSelect"><i class="fas fa-hashtag"></i> เลือกรหัสห้อง:</label>
                                <div class="custom-dropdown">
                                    <input type="text" id="roomCodeSelect" class="dropdown-input" 
                                           placeholder="พิมพ์หรือเลือกรหัสห้อง..." 
                                           oninput="filterDropdown('code')" 
                                           onfocus="showDropdown('code')" readonly>
                                    <div class="dropdown-arrow">▼</div>
                                    <div class="dropdown-options" id="codeDropdown"></div>
                                </div>
                            </div>
                            
                            <div class="dropdown-group">
                                <label for="roomNameSelect"><i class="fas fa-home"></i> เลือกชื่อห้อง:</label>
                                <div class="custom-dropdown">
                                    <input type="text" id="roomNameSelect" class="dropdown-input" 
                                           placeholder="พิมพ์หรือเลือกชื่อห้อง..." 
                                           oninput="filterDropdown('name')" 
                                           onfocus="showDropdown('name')" readonly>
                                    <div class="dropdown-arrow">▼</div>
                                    <div class="dropdown-options" id="nameDropdown"></div>
                                </div>
                            </div>
                            
                            <div class="dropdown-group">
                                <label for="locationSelect"><i class="fas fa-map-marker-alt"></i> เลือกตำแหน่ง:</label>
                                <div class="custom-dropdown">
                                    <input type="text" id="locationSelect" class="dropdown-input" 
                                           placeholder="พิมพ์หรือเลือกตำแหน่ง..." 
                                           oninput="filterDropdown('location')" 
                                           onfocus="showDropdown('location')" readonly>
                                    <div class="dropdown-arrow">▼</div>
                                    <div class="dropdown-options" id="locationDropdown"></div>
                                </div>
                            </div>
                            
                            <div class="dropdown-actions">
                                <button class="search-btn" onclick="searchFromDropdown()">
                                    <i class="fas fa-search"></i> ค้นหา
                                </button>
                                <button class="search-btn" onclick="clearAllDropdowns()" style="background: #6c757d;">
                                    <i class="fas fa-redo"></i> ล้าง
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ผลการค้นหา -->
                    <div class="search-results" id="searchResults"></div>
                </div>

                <!-- ตัวอย่างห้องยอดนิยม -->
                <div class="suggestions" id="suggestions">
                    <h3 style="text-align: center; margin-bottom: 20px;">
                        <i class="fas fa-star"></i> ค้นหาด่วนตามหมวดหมู่
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div class="suggestion-card" onclick="quickSearch('classroom')">
                            <h4><i class="fas fa-graduation-cap"></i> ห้องเรียน</h4>
                            <p>ห้องเรียนปกติทั้งหมด</p>
                            <small>ม.1 - ม.6</small>
                        </div>
                        <div class="suggestion-card" onclick="quickSearch('special')">
                            <h4><i class="fas fa-flask"></i> ห้องพิเศษ</h4>
                            <p>ห้องปฏิบัติการและห้องพิเศษ</p>
                            <small>คอมพิวเตอร์, วิทยาศาสตร์, ดนตรี</small>
                        </div>
                        <div class="suggestion-card" onclick="quickSearch('facilities')">
                            <h4><i class="fas fa-building"></i> สิ่งอำนวยความสะดวก</h4>
                            <p>ห้องสมุด โรงอาหาร หอประชุม</p>
                            <small>บริการทั่วไป</small>
                        </div>
                        <div class="suggestion-card" onclick="quickSearch('office')">
                            <h4><i class="fas fa-briefcase"></i> ห้องสำนักงาน</h4>
                            <p>ห้องผู้บริหารและเจ้าหน้าที่</p>
                            <small>บริหาร, พยาบาล</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ======================== หน้าแผนที่ ======================== -->
            <div class="page" id="map-page">
                <h2><i class="fas fa-map"></i> แผนที่โรงเรียน</h2>
                
                <!-- ข้อมูลและคำแนะนำ -->
                <div style="background: #e6f3ff; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <p><strong><i class="fas fa-map-marker-alt"></i> สถานที่:</strong> <span id="currentLocation">โรงเรียนอัจฉริยะ</span></p>
                    <p><strong><i class="fas fa-lightbulb"></i> วิธีใช้:</strong> คลิกที่จุดสีน้ำเงินบนแผนที่เพื่อดูข้อมูลห้อง | ลากจุดเขียวเพื่อตั้งตำแหน่งของคุณ</p>
                    <div style="margin-top: 10px;">
                        <button class="search-btn" onclick="openFullscreenMap()" style="margin-right: 10px;">
                            <i class="fas fa-expand"></i> ดูแผนที่เต็มจอ
                        </button>
                        <button class="search-btn" onclick="toggleUserPosition()" style="margin-right: 10px;">
                            <i class="fas fa-crosshairs"></i> ตั้งตำแหน่งฉัน
                        </button>
                        <button class="search-btn" onclick="getCurrentLocation()">
                            <i class="fas fa-location-arrow"></i> ใช้ GPS
                        </button>
                    </div>
                </div>
                
                <!-- คอนเทนเนอร์แผนที่ -->
                <div class="map-container">
                    <div class="map-area" id="mapArea">
                        <!-- รูปแผนที่ -->
                        <img id="schoolMap" class="map-image" 
                             src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f0f0f0'/%3E%3Ctext x='400' y='250' text-anchor='middle' font-family='Arial' font-size='24' fill='%23666'%3E🏫 แผนที่โรงเรียนอัจฉริยะ%3C/text%3E%3Ctext x='400' y='280' text-anchor='middle' font-family='Arial' font-size='16' fill='%23999'%3E(อัปโหลดแผนที่ในหน้าจัดการข้อมูล)%3C/text%3E%3Ctext x='400' y='320' text-anchor='middle' font-family='Arial' font-size='14' fill='%23999'%3E📍 คลิกจุดสีน้ำเงินเพื่อดูข้อมูลห้อง%3C/text%3E%3Ctext x='400' y='350' text-anchor='middle' font-family='Arial' font-size='14' fill='%23999'%3E🟢 ลากจุดเขียวเพื่อตั้งตำแหน่งของคุณ%3C/text%3E%3C/svg%3E" 
                             alt="แผนที่โรงเรียน">
                        
                        <!-- ปุ่มควบคุมแผนที่ -->
                        <div class="map-controls">
                            <button class="map-control-btn" onclick="zoomIn()" title="ขยาย">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="map-control-btn" onclick="zoomOut()" title="ย่อ">
                                <i class="fas fa-minus"></i>
                            </button>
                            <button class="map-control-btn" onclick="resetZoom()" title="รีเซ็ต">
                                <i class="fas fa-home"></i>
                            </button>
                        </div>

                        <!-- เข็มทิศ -->
                        <div class="compass" id="compass">
                            <div class="compass-needle" id="compassNeedle"></div>
                        </div>
                        
                        <!-- จุดห้องต่างๆ บนแผนที่ -->
                        <div id="roomMarkers"></div>
                        
                        <!-- ตำแหน่งผู้ใช้ -->
                        <div id="userMarker" class="user-marker hidden" style="top: 50%; left: 10%;"></div>
                        
                        <!-- เส้นทาง -->
                        <div id="routePath"></div>
                    </div>
                    
                    <!-- ข้อมูลห้อง -->
                    <div class="room-info">
                        <div id="defaultInfo">
                            <h3><i class="fas fa-info-circle"></i> ข้อมูลห้อง</h3>
                            <p>คลิกที่จุดสีน้ำเงินบนแผนที่เพื่อดูข้อมูลรายละเอียดของแต่ละห้อง</p>
                            <br>
                            <h4><i class="fas fa-map-signs"></i> คำอธิบายสัญลักษณ์:</h4>
                            <p>🎓 = ห้องเรียน</p>
                            <p>💻 = ห้องคอมพิวเตอร์</p>
                            <p>📚 = ห้องสมุด</p>
                            <p>🍽️ = โรงอาหาร</p>
                            <p>🎵 = ห้องดนตรี</p>
                            <p>🟢 = ตำแหน่งของคุณ</p>
                            <br>
                            <p><i class="fas fa-hand-pointer"></i> <strong>เคล็ดลับ:</strong> ลากจุดเขียวเพื่อตั้งตำแหน่งของคุณ</p>
                        </div>
                        
                        <div class="room-details" id="roomDetails">
                            <h3 id="roomName"></h3>
                            <p><strong><i class="fas fa-map-marker-alt"></i> ตำแหน่ง:</strong> <span id="roomLocation"></span></p>
                            <p><strong><i class="fas fa-info"></i> รายละเอียด:</strong> <span id="roomDescription"></span></p>
                            <p><strong><i class="fas fa-clock"></i> เวลาเปิด:</strong> <span id="roomHours"></span></p>
                            <p><strong><i class="fas fa-phone"></i> ติดต่อ:</strong> <span id="roomContact"></span></p>
                            
                            <!-- ปุ่มเปลี่ยนมุมมองรูปภาพ -->
                            <div class="view-mode-buttons">
                                <button class="view-mode-btn active" onclick="setViewMode('2d')" data-mode="2d">
                                    <i class="fas fa-image"></i> 2D
                                </button>
                                <button class="view-mode-btn" onclick="setViewMode('3d')" data-mode="3d">
                                    <i class="fas fa-cube"></i> 3D
                                </button>
                            </div>
                            
                            <!-- แกลอรี่รูปภาพ -->
                            <div class="image-gallery" id="imageGallery">
                                <h4><i class="fas fa-images"></i> รูปภาพห้อง:</h4>
                                <div class="gallery-images" id="galleryImages"></div>
                            </div>
                            
                            <br>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="search-btn" onclick="getDirections()">
                                    <i class="fas fa-route"></i> ขอเส้นทาง
                                </button>
                                <button class="search-btn" onclick="showRouteDetails()" style="background: #28a745;">
                                    <i class="fas fa-list"></i> รายละเอียดเส้นทาง
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ======================== หน้าแอดมิน ======================== -->
            <div class="page" id="admin-page">
                <h2><i class="fas fa-cogs"></i> จัดการข้อมูลระบบ</h2>
                
                <!-- เมนูแอดมิน -->
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="showAdminContent('room-manage')">
                        <i class="fas fa-home"></i> จัดการห้อง
                    </button>
                    <button class="admin-tab" onclick="showAdminContent('map-config')">
                        <i class="fas fa-map"></i> ตั้งค่าแผนที่
                    </button>
                    <button class="admin-tab" onclick="showAdminContent('data-sync')">
                        <i class="fas fa-sync"></i> ซิงค์ข้อมูล
                    </button>
                </div>

                <!-- จัดการห้อง -->
                <div class="admin-content active" id="room-manage">
                    <div class="admin-section">
                        <h3><i class="fas fa-table"></i> ข้อมูลห้องทั้งหมด</h3>
                        <div style="margin-bottom: 15px;">
                            <button class="btn btn-success" onclick="loadSampleData()">
                                <i class="fas fa-database"></i> โหลดข้อมูลตัวอย่าง (20 รายการ)
                            </button>
                            <button class="btn btn-warning" onclick="clearAllData()">
                                <i class="fas fa-trash"></i> ล้างข้อมูลทั้งหมด
                            </button>
                        </div>
                        <div class="loading" id="roomsLoading">
                            <div class="spinner"></div>
                            <p>กำลังโหลดข้อมูล...</p>
                        </div>
                        <table class="room-table" id="roomTable">
                            <thead>
                                <tr>
                                    <th>รหัสห้อง</th>
                                    <th>ชื่อห้อง</th>
                                    <th>ตำแหน่ง</th>
                                    <th>สถานะ</th>
                                    <th>การจัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="roomTableBody"></tbody>
                        </table>
                    </div>

                    <div class="admin-section">
                        <h3><i class="fas fa-plus"></i> เพิ่ม/แก้ไขห้อง</h3>
                        <form id="roomForm" onsubmit="saveRoom(event)">
                            <input type="hidden" id="editingRoomId">
                            
                            <div class="form-row">
                                <input type="text" id="roomCode" placeholder="รหัสห้อง (เช่น R001)" required>
                                <input type="text" id="roomName" placeholder="ชื่อห้อง" required>
                            </div>
                            
                            <div class="form-row">
                                <input type="text" id="roomLocation" placeholder="ตำแหน่ง (เช่น ชั้น 2 อาคาร A)" required>
                                <input type="text" id="roomHours" placeholder="เวลาเปิด-ปิด" value="08:00 - 17:00">
                            </div>
                            
                            <div class="form-row">
                                <input type="tel" id="roomContact" placeholder="เบอร์ติดต่อ">
                                <select id="roomStatus">
                                    <option value="active">✅ ใช้งาน</option>
                                    <option value="maintenance">🔧 ปรับปรุง</option>
                                    <option value="closed">❌ ปิด</option>
                                </select>
                            </div>
                            
                            <div class="form-row">
                                <textarea id="roomDescription" placeholder="รายละเอียดเพิ่มเติม"></textarea>
                            </div>
                            
                            <div class="form-row">
                                <input type="number" id="roomX" placeholder="ตำแหน่ง X บนแผนที่ (%)" min="0" max="100" step="0.1">
                                <input type="number" id="roomY" placeholder="ตำแหน่ง Y บนแผนที่ (%)" min="0" max="100" step="0.1">
                            </div>
                            
                            <div class="form-row">
                                <input type="url" id="roomImages" placeholder="ลิงก์รูปภาพ (คั่นด้วย , สำหรับหลายรูป)">
                            </div>
                            
                            <div class="form-row">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> บันทึก
                                </button>
                                <button type="button" class="btn btn-warning" onclick="clearForm()">
                                    <i class="fas fa-redo"></i> ล้างฟอร์ม
                                </button>
                                <button type="button" class="btn btn-success" onclick="syncToGoogleSheets()">
                                    <i class="fas fa-upload"></i> บันทึกลง Google Sheets
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- ตั้งค่าแผนที่ -->
                <div class="admin-content" id="map-config">
                    <div class="admin-section">
                        <h3><i class="fas fa-map"></i> อัปโหลดแผนที่โรงเรียน</h3>
                        
                        <div class="upload-area" id="mapUploadArea">
                            <input type="file" class="file-input" id="mapFileInput" accept="image/*" onchange="handleMapUpload(event)">
                            <div onclick="document.getElementById('mapFileInput').click()">
                                <h3><i class="fas fa-cloud-upload-alt"></i> อัปโหลดแผนที่ใหม่</h3>
                                <p>คลิกเพื่อเลือกไฟล์รูปภาพแผนที่ หรือลากวางไฟล์มาที่นี่</p>
                                <small>รองรับไฟล์: JPG, PNG, GIF (ขนาดไม่เกิน 5MB)</small>
                            </div>
                        </div>
                        
                        <div id="currentMapStatus">
                            <p><strong>สถานะแผนที่:</strong> <span id="mapStatus">ใช้แผนที่เริ่มต้น</span></p>
                            <img id="currentMapPreview" class="hidden" style="max-width: 100%; max-height: 200px; border-radius: 10px; margin-top: 10px;">
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <button class="btn btn-success" onclick="applyCustomMap()">
                                <i class="fas fa-check"></i> ใช้แผนที่ที่อัปโหลด
                            </button>
                            <button class="btn btn-danger" onclick="resetToDefaultMap()">
                                <i class="fas fa-undo"></i> ใช้แผนที่เริ่มต้น
                            </button>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h3><i class="fas fa-school"></i> ข้อมูลโรงเรียน</h3>
                        <div class="form-row">
                            <input type="text" id="schoolName" placeholder="ชื่อโรงเรียน" value="โรงเรียนอัจฉริยะ">
                            <input type="text" id="schoolAddress" placeholder="ที่อยู่โรงเรียน" value="123 ถนนพัฒนาการ กรุงเทพฯ">
                        </div>
                        <button class="btn btn-primary" onclick="updateSchoolInfo()">
                            <i class="fas fa-save"></i> บันทึกข้อมูล
                        </button>
                    </div>

                    <div class="admin-section">
                        <h3><i class="fas fa-cog"></i> ตั้งค่าระบบ</h3>
                        <div class="form-row">
                            <label>
                                <input type="radio" name="dataMode" value="sample" checked onchange="setDataMode('sample')">
                                ใช้ข้อมูลตัวอย่าง (20 รายการ)
                            </label>
                        </div>
                        <div class="form-row">
                            <label>
                                <input type="radio" name="dataMode" value="real" onchange="setDataMode('real')">
                                ใช้ข้อมูลจริงจากฐานข้อมูล
                            </label>
                        </div>
                        <p style="font-size: 14px; color: #666; margin-top: 10px;">
                            <i class="fas fa-info-circle"></i> 
                            โหมดข้อมูลตัวอย่าง: แสดงข้อมูลจำลองสำหรับทดสอบระบบ<br>
                            โหมดข้อมูลจริง: เชื่อมต่อกับฐานข้อมูลจริงของโรงเรียน
                        </p>
                    </div>
                </div>

                <!-- ซิงค์ข้อมูล -->
                <div class="admin-content" id="data-sync">
                    <div class="admin-section">
                        <h3><i class="fas fa-sync"></i> การเชื่อมต่อ Google Sheets</h3>
                        
                        <div class="form-row">
                            <input type="text" id="sheetId" placeholder="Google Sheet ID" value="">
                            <input type="text" id="sheetName" placeholder="ชื่อ Sheet" value="ข้อมูลห้อง">
                        </div>
                        
                        <div class="form-row">
                            <input type="text" id="apiKey" placeholder="Google Sheets API Key (ถ้ามี)" value="">
                        </div>
                        
                        <div class="form-row">
                            <button class="btn btn-primary" onclick="testConnection()">
                                <i class="fas fa-search"></i> ทดสอบการเชื่อมต่อ
                            </button>
                            <button class="btn btn-success" onclick="syncFromGoogleSheets()">
                                <i class="fas fa-download"></i> ดึงข้อมูลจาก Sheets
                            </button>
                            <button class="btn btn-warning" onclick="backupData()">
                                <i class="fas fa-download"></i> สำรองข้อมูล
                            </button>
                        </div>
                        
                        <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 8px; margin-top: 15px;">
                            <h4><i class="fas fa-info-circle"></i> วิธีการตั้งค่า Google Sheets:</h4>
                            <ol style="margin: 10px 0; padding-left: 20px;">
                                <li>สร้าง Google Sheet ใหม่</li>
                                <li>สร้างหัวตาราง: รหัสห้อง | ชื่อห้อง | ตำแหน่ง | รายละเอียด | เวลาเปิด | ติดต่อ | สถานะ | X | Y | รูปภาพ</li>
                                <li>แชร์ Sheet ให้ "Anyone with the link can view"</li>
                                <li>คัดลอก Sheet ID มาใส่ด้านบน</li>
                            </ol>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h3><i class="fas fa-chart-bar"></i> สถิติการใช้งาน</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h4 style="color: #667eea;"><i class="fas fa-home"></i> จำนวนห้องทั้งหมด</h4>
                                <p id="totalRooms" style="font-size: 2em; margin: 10px 0; color: #333;">0</p>
                            </div>
                            <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h4 style="color: #28a745;"><i class="fas fa-check-circle"></i> ห้องที่ใช้งานได้</h4>
                                <p id="activeRooms" style="font-size: 2em; margin: 10px 0; color: #333;">0</p>
                            </div>
                            <div style="background: white; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h4 style="color: #ffc107;"><i class="fas fa-search"></i> การค้นหาวันนี้</h4>
                                <p id="todaySearches" style="font-size: 2em; margin: 10px 0; color: #333;">0</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ======================== Modal แผนที่เต็มจอ ======================== -->
    <div class="fullscreen-modal" id="fullscreenModal">
        <div class="fullscreen-controls">
            <button class="fullscreen-btn" onclick="closeFullscreenMap()">
                <i class="fas fa-times"></i> ปิด
            </button>
            <button class="fullscreen-btn" onclick="toggleUserPosition()">
                <i class="fas fa-crosshairs"></i> ตำแหน่งฉัน
            </button>
        </div>
        <div class="fullscreen-map" id="fullscreenMapContainer">
            <!-- แผนที่เต็มจอจะถูกคัดลอกมาที่นี่ -->
        </div>
    </div>

    <!-- ======================== Modal รูปภาพขยาย ======================== -->
    <div class="image-modal" id="imageModal" onclick="closeImageModal()">
        <div class="modal-content">
            <img class="modal-image" id="modalImage" src="" alt="รูปภาพขยาย">
        </div>
    </div>

    <!-- ======================== ปุ่มช่วยเหลือด่วน ======================== -->
    <button class="quick-help" id="quickHelp" onclick="showQuickHelp()" title="ช่วยเหลือ">
        <i class="fas fa-question"></i>
    </button>

    <!-- ======================== การแจ้งเตือน ======================== -->
    <div class="notification" id="notification"></div>

    <script>
        // =================== ตัวแปร Global - เก็บข้อมูลสำคัญของระบบ ===================
        
        let roomData = {};                    // เก็บข้อมูลห้องทั้งหมด
        let isAdminLoggedIn = false;          // สถานะการล็อกอินของแอดมิน
        let customMapImage = null;            // รูปแผนที่ที่อัปโหลดเอง
        let searchCount = 0;                  // จำนวนการค้นหาในวันนี้
        let searchMode = 'free';              // โหมดการค้นหา: 'free' หรือ 'dropdown'
        let liveSearchTimeout = null;         // ตัวจับเวลาสำหรับการค้นหาแบบเรียลไทม์
        let isDropdownOpen = { code: false, name: false, location: false }; // สถานะการเปิด dropdown
        let notificationQueue = [];           // คิวข้อความแจ้งเตือน
        let isShowingNotification = false;    // สถานะการแสดงการแจ้งเตือน
        let userPosition = { x: 10, y: 50 };  // ตำแหน่งผู้ใช้บนแผนที่ (เปอร์เซ็นต์)
        let selectedRoom = null;              // ห้องที่เลือกในปัจจุบัน
        let mapZoom = 1;                      // ระดับการซูมแผนที่
        let dataMode = 'sample';              // โหมดข้อมูล: 'sample' หรือ 'real'
        let viewMode = '2d';                  // โหมดการแสดงรูปภาพ: '2d' หรือ '3d'
        let deviceOrientation = 0;            // ทิศทางของอุปกรณ์ (องศา)

        // =================== ข้อมูลตัวอย่าง 20 รายการ ===================
        
        const sampleRoomData = {
            'R001': {
                code: 'R001', name: 'ห้องเรียน ม.1/1', location: 'ชั้น 1 อาคาร A',
                description: 'ห้องเรียนปกติสำหรับนักเรียนชั้นมัธยมศึกษาปีที่ 1 ห้อง 1 รองรับนักเรียน 35 คน มีกระดานอัจฉริยะและโปรเจคเตอร์',
                hours: '08:00 - 16:30', contact: '02-123-4567', status: 'active', x: 15, y: 25,
                images: ['https://picsum.photos/400/300?random=1', 'https://picsum.photos/400/300?random=2']
            },
            'R002': {
                code: 'R002', name: 'ห้องเรียน ม.2/1', location: 'ชั้น 1 อาคาร A',
                description: 'ห้องเรียนปกติสำหรับนักเรียนชั้นมัธยมศึกษาปีที่ 2 ห้อง 1 รองรับนักเรียน 35 คน',
                hours: '08:00 - 16:30', contact: '02-123-4567', status: 'active', x: 35, y: 25,
                images: ['https://picsum.photos/400/300?random=3']
            },
            'R003': {
                code: 'R003', name: 'ห้องเรียน ม.3/1', location: 'ชั้น 2 อาคาร A',
                description: 'ห้องเรียนปกติสำหรับนักเรียนชั้นมัธยมศึกษาปีที่ 3 ห้อง 1 รองรับนักเรียน 35 คน',
                hours: '08:00 - 16:30', contact: '02-123-4567', status: 'active', x: 15, y: 15,
                images: ['https://picsum.photos/400/300?random=4', 'https://picsum.photos/400/300?random=5']
            },
            'R004': {
                code: 'R004', name: 'ห้องเรียน ม.4/1', location: 'ชั้น 2 อาคาร A',
                description: 'ห้องเรียนปกติสำหรับนักเรียนชั้นมัธยมศึกษาปีที่ 4 ห้อง 1 รองรับนักเรียน 40 คน',
                hours: '08:00 - 16:30', contact: '02-123-4567', status: 'active', x: 35, y: 15,
                images: ['https://picsum.photos/400/300?random=6']
            },
            'R005': {
                code: 'R005', name: 'ห้องเรียน ม.5/1', location: 'ชั้น 3 อาคาร A',
                description: 'ห้องเรียนปกติสำหรับนักเรียนชั้นมัธยมศึกษาปีที่ 5 ห้อง 1 รองรับนักเรียน 40 คน',
                hours: '08:00 - 16:30', contact: '02-123-4567', status: 'active', x: 15, y: 5,
                images: ['https://picsum.photos/400/300?random=7', 'https://picsum.photos/400/300?random=8']
            },
            'R006': {
                code: 'R006', name: 'ห้องเรียน ม.6/1', location: 'ชั้น 3 อาคาร A',
                description: 'ห้องเรียนปกติสำหรับนักเรียนชั้นมัธยมศึกษาปีที่ 6 ห้อง 1 รองรับนักเรียน 40 คน',
                hours: '08:00 - 16:30', contact: '02-123-4567', status: 'active', x: 35, y: 5,
                images: ['https://picsum.photos/400/300?random=9']
            },
            'C001': {
                code: 'C001', name: 'ห้องคอมพิวเตอร์ 1', location: 'ชั้น 2 อาคาร B',
                description: 'ห้องปฏิบัติการคอมพิวเตอร์ มีเครื่องคอมพิวเตอร์ 30 เครื่อง พร้อมโปรเจคเตอร์และระบบเสียง มีอินเทอร์เน็ตความเร็วสูง',
                hours: '08:00 - 17:00', contact: '02-123-4568', status: 'active', x: 60, y: 15,
                images: ['https://picsum.photos/400/300?random=10', 'https://picsum.photos/400/300?random=11']
            },
            'C002': {
                code: 'C002', name: 'ห้องคอมพิวเตอร์ 2', location: 'ชั้น 2 อาคาร B',
                description: 'ห้องปฏิบัติการคอมพิวเตอร์ขั้นสูง มีเครื่องคอมพิวเตอร์สเปคสูง 25 เครื่อง สำหรับการเรียนการสอนการออกแบบและการเขียนโปรแกรม',
                hours: '08:00 - 17:00', contact: '02-123-4568', status: 'active', x: 80, y: 15,
                images: ['https://picsum.photos/400/300?random=12']
            },
            'L001': {
                code: 'L001', name: 'ห้องสมุดหลัก', location: 'ชั้น 1 อาคาร C',
                description: 'ห้องสมุดหลักของโรงเรียน มีหนังสือมากกว่า 15,000 เล่ม พร้อมพื้นที่อ่านหนังสือ 80 ที่นั่ง มีระบบค้นหาหนังสืออิเล็กทรอนิกส์',
                hours: '07:30 - 18:00', contact: '02-123-4569', status: 'active', x: 20, y: 60,
                images: ['https://picsum.photos/400/300?random=13', 'https://picsum.photos/400/300?random=14']
            },
            'S001': {
                code: 'S001', name: 'ห้องปฏิบัติการวิทยาศาสตร์ 1', location: 'ชั้น 3 อาคาร B',
                description: 'ห้องปฏิบัติการฟิสิกส์ มีอุปกรณ์การทดลองครบชุด พร้อมระบบความปลอดภัยสูง มีตู้ดูดควันและอุปกรณ์ป้องกันอุบัติเหตุ',
                hours: '08:00 - 17:00', contact: '02-123-4570', status: 'active', x: 60, y: 5,
                images: ['https://picsum.photos/400/300?random=15']
            },
            'S002': {
                code: 'S002', name: 'ห้องปฏิบัติการวิทยาศาสตร์ 2', location: 'ชั้น 3 อาคาร B',
                description: 'ห้องปฏิบัติการเคมี มีอุปกรณ์การทดลองทางเคมีครบชุด พร้อมระบบระบายอากาศและการจัดการสารเคมีอย่างปลอดภัย',
                hours: '08:00 - 17:00', contact: '02-123-4570', status: 'active', x: 80, y: 5,
                images: ['https://picsum.photos/400/300?random=16', 'https://picsum.photos/400/300?random=17']
            },
            'M001': {
                code: 'M001', name: 'ห้องดนตรี', location: 'ชั้น 1 อาคาร D',
                description: 'ห้องเรียนดนตรีพร้อมเครื่องดนตรีหลากหลายชนิด มีเปียโน คีย์บอร์ด กีตาร์ กลองชุด และระบบเสียงคุณภาพสูง',
                hours: '08:00 - 17:00', contact: '02-123-4571', status: 'active', x: 15, y: 80,
                images: ['https://picsum.photos/400/300?random=18']
            },
            'A001': {
                code: 'A001', name: 'ห้องศิลปะ', location: 'ชั้น 1 อาคาร D',
                description: 'ห้องเรียนศิลปะพร้อมอุปกรณ์วาดภาพ จิตรกรรม และงานประดิษฐ์ มีโต๊ะวาดภาพ 20 ตัว และพื้นที่แสดงผลงาน',
                hours: '08:00 - 17:00', contact: '02-123-4572', status: 'active', x: 35, y: 80,
                images: ['https://picsum.photos/400/300?random=19', 'https://picsum.photos/400/300?random=20']
            },
            'G001': {
                code: 'G001', name: 'โรงยิม', location: 'อาคารกีฬา',
                description: 'โรงยิมในร่มขนาดใหญ่ สามารถใช้เล่นกีฬาได้หลายประเภท มีสนามบาสเกตบอล แบดมินตัน และวอลเลย์บอล',
                hours: '07:00 - 18:00', contact: '02-123-4573', status: 'active', x: 85, y: 60,
                images: ['https://picsum.photos/400/300?random=21']
            },
            'F001': {
                code: 'F001', name: 'โรงอาหาร', location: 'ชั้น 1 อาคาร E',
                description: 'โรงอาหารของโรงเรียนที่รองรับนักเรียน 500 คน มีร้านอาหารหลากหลาย 8 ร้าน พร้อมโซนนั่งกินในร่มและกลางแจ้ง',
                hours: '06:30 - 16:00', contact: '02-123-4574', status: 'active', x: 50, y: 85,
                images: ['https://picsum.photos/400/300?random=22', 'https://picsum.photos/400/300?random=23']
            },
            'H001': {
                code: 'H001', name: 'หอประชุมใหญ่', location: 'ชั้น 2 อาคาร F',
                description: 'หอประชุมใหญ่ที่รองรับได้ 800 คน พร้อมระบบเสียงและภาพทันสมัย มีเวทีขนาดใหญ่สำหรับการแสดงและกิจกรรม',
                hours: '08:00 - 17:00', contact: '02-123-4575', status: 'active', x: 70, y: 75,
                images: ['https://picsum.photos/400/300?random=24']
            },
            'O001': {
                code: 'O001', name: 'ห้องผู้อำนวยการ', location: 'ชั้น 2 อาคาร A',
                description: 'ห้องทำงานของผู้อำนวยการโรงเรียน พร้อมห้องประชุมเล็กสำหรับการพบปะกับผู้ปกครองและแขกผู้มาเยือน',
                hours: '08:00 - 16:30', contact: '02-123-4560', status: 'active', x: 25, y: 15,
                images: ['https://picsum.photos/400/300?random=25', 'https://picsum.photos/400/300?random=26']
            },
            'O002': {
                code: 'O002', name: 'ห้องสำนักงานธุรการ', location: 'ชั้น 1 อาคาร A',
                description: 'ห้องสำนักงานธุรการสำหรับการติดต่อราชการ การลงทะเบียน และการออกเอกสารต่างๆ ของนักเรียนและบุคลากร',
                hours: '08:00 - 16:30', contact: '02-123-4561', status: 'active', x: 25, y: 25,
                images: ['https://picsum.photos/400/300?random=27']
            },
            'N001': {
                code: 'N001', name: 'ห้องพยาบาล', location: 'ชั้น 1 อาคาร A',
                description: 'ห้องพยาบาลโรงเรียนพร้อมอุปกรณ์การแพทย์เบื้องต้น มีพยาบาลวิชาชีพประจำสำหรับดูแลสุขภาพนักเรียนและบุคลากร',
                hours: '08:00 - 16:30', contact: '02-123-4562', status: 'active', x: 5, y: 25,
                images: ['https://picsum.photos/400/300?random=28', 'https://picsum.photos/400/300?random=29']
            }
        };

        // =================== ฟังก์ชันการจัดการการล็อกอิน ===================
        
        /**
         * ฟังก์ชันสำหรับการล็อกอินของแอดมิน
         * รับข้อมูลจากฟอร์มและตรวจสอบกับข้อมูลที่กำหนดไว้
         */
        function adminLogin(event) {
            event.preventDefault(); // ป้องกันการ submit form แบบปกติ
            
            // ดึงค่าจากช่องกรอกข้อมูล
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            // ตรวจสอบชื่อผู้ใช้และรหัสผ่าน
            if (username === 'admin' && password === '1234') {
                isAdminLoggedIn = true;                    // ตั้งสถานะการล็อกอิน
                showMainApp(true);                         // แสดงหน้าหลักพร้อมสิทธิ์แอดมิน
                showNotification('✅ เข้าสู่ระบบสำเร็จ!', 'success'); // แสดงข้อความสำเร็จ
            } else {
                showNotification('❌ ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง', 'error'); // แสดงข้อความผิดพลาด
            }
        }

        /**
         * ฟังก์ชันแสดงหน้าล็อกอินแอดมิน
         */
        function showAdminLogin() {
            document.getElementById('loginPage').classList.remove('hidden');   // แสดงหน้าล็อกอิน
            document.getElementById('mainApp').classList.add('hidden');        // ซ่อนหน้าหลัก
        }

        /**
         * ฟังก์ชันออกจากระบบ
         */
        function logout() {
            isAdminLoggedIn = false;                      // รีเซ็ตสถานะการล็อกอิน
            showMainApp(false);                          // แสดงหน้าหลักแบบผู้ใช้ทั่วไป
            
            // ล้างข้อมูลในฟอร์มล็อกอิน
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            
            showNotification('👋 ออกจากระบบเรียบร้อย', 'success');
        }

        /**
         * ฟังก์ชันแสดงหน้าหลักของเว็บไซต์
         * @param {boolean} isAdmin - true ถ้าเป็นการล็อกอินในฐานะแอดมิน
         */
        function showMainApp(isAdmin = false) {
            document.getElementById('loginPage').classList.add('hidden');      // ซ่อนหน้าล็อกอิน
            document.getElementById('mainApp').classList.remove('hidden');     // แสดงหน้าหลัก
            
            // จัดการการแสดงปุ่มต่างๆ ตามสิทธิ์ผู้ใช้
            if (isAdmin) {
                document.getElementById('adminTab').classList.remove('hidden');   // แสดงแท็บแอดมิน
                document.getElementById('logoutBtn').classList.remove('hidden');  // แสดงปุ่มออกจากระบบ
                document.getElementById('adminBtn').classList.add('hidden');      // ซ่อนปุ่มแอดมิน
            } else {
                document.getElementById('adminTab').classList.add('hidden');      // ซ่อนแท็บแอดมิน
                document.getElementById('logoutBtn').classList.add('hidden');     // ซ่อนปุ่มออกจากระบบ
                document.getElementById('adminBtn').classList.remove('hidden');   // แสดงปุ่มแอดมิน
            }
            
            loadInitialData(); // โหลดข้อมูลเริ่มต้น
        }

        // =================== ฟังก์ชันการจัดการข้อมูล ===================
        
        /**
         * ฟังก์ชันโหลดข้อมูลเริ่มต้น
         * ตรวจสอบว่ามีข้อมูลใน localStorage หรือไม่ ถ้าไม่มีจะใช้ข้อมูลตัวอย่าง
         */
        function loadInitialData() {
            const savedData = localStorage.getItem('schoolMapData');
            if (savedData) {
                roomData = JSON.parse(savedData);  // โหลดข้อมูลที่บันทึกไว้
            } else {
                roomData = { ...sampleRoomData };   // ใช้ข้อมูลตัวอย่าง
                saveDataToLocalStorage();          // บันทึกลง localStorage
            }
            
            updateUI(); // อัปเดตส่วนติดต่อผู้ใช้
        }

        /**
         * ฟังก์ชันโหลดข้อมูลตัวอย่าง 20 รายการ
         */
        function loadSampleData() {
            roomData = { ...sampleRoomData };       // คัดลอกข้อมูลตัวอย่าง
            saveDataToLocalStorage();              // บันทึกลง localStorage
            updateUI();                             // อัปเดต UI
            showNotification('✅ โหลดข้อมูลตัวอย่าง 20 รายการเรียบร้อย!', 'success');
        }

        /**
         * ฟังก์ชันล้างข้อมูลทั้งหมด
         */
        function clearAllData() {
            if (confirm('คุณต้องการล้างข้อมูลทั้งหมดหรือไม่?\n\n⚠️ การดำเนินการนี้ไม่สามารถยกเลิกได้')) {
                roomData = {};                      // ล้างข้อมูลห้อง
                saveDataToLocalStorage();          // บันทึกลง localStorage
                updateUI();                         // อัปเดต UI
                showNotification('🗑️ ล้างข้อมูลทั้งหมดเรียบร้อย', 'success');
            }
        }

        /**
         * ฟังก์ชันตั้งค่าโหมดข้อมูล
         * @param {string} mode - 'sample' หรือ 'real'
         */
        function setDataMode(mode) {
            dataMode = mode;
            localStorage.setItem('dataMode', mode);
            
            if (mode === 'sample') {
                showNotification('🔄 เปลี่ยนเป็นโหมดข้อมูลตัวอย่าง', 'success');
                loadSampleData();
            } else {
                showNotification('🔄 เปลี่ยนเป็นโหมดข้อมูลจริง', 'success');
                // ในระบบจริงจะมีการเชื่อมต่อฐานข้อมูล
            }
        }

        /**
         * ฟังก์ชันบันทึกข้อมูลลง localStorage
         */
        function saveDataToLocalStorage() {
            localStorage.setItem('schoolMapData', JSON.stringify(roomData));
        }

        /**
         * ฟังก์ชันอัปเดต UI ทั้งหมด
         */
        function updateUI() {
            updateRoomTable();      // อัปเดตตารางห้อง
            updateRoomMarkers();    // อัปเดตจุดบนแผนที่
            updateSuggestions();    // อัปเดตคำแนะนำ
            updateStatistics();     // อัปเดตสถิติ
            populateDropdowns();    // อัปเดต dropdown
        }

        // =================== ฟังก์ชันการนำทางหน้าเว็บ ===================
        
        /**
         * ฟังก์ชันแสดงหน้าต่างๆ
         * @param {string} pageId - ID ของหน้าที่ต้องการแสดง
         */
        function showPage(pageId) {
            // ซ่อนหน้าทั้งหมด
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // ยกเลิกการเลือกปุ่มแท็บทั้งหมด
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // แสดงหน้าที่เลือก
            document.getElementById(pageId + '-page').classList.add('active');
            event.target.classList.add('active');
            
            // ถ้าเป็นหน้าแอดมินและยังไม่ได้ล็อกอิน
            if (pageId === 'admin' && !isAdminLoggedIn) {
                showNotification('❌ กรุณาเข้าสู่ระบบก่อน', 'error');
                showAdminLogin();
                return;
            }
        }

        /**
         * ฟังก์ชันแสดงเนื้อหาแอดมิน
         * @param {string} contentId - ID ของเนื้อหาที่ต้องการแสดง
         */
        function showAdminContent(contentId) {
            // ซ่อนเนื้อหาทั้งหมด
            document.querySelectorAll('.admin-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ยกเลิกการเลือกแท็บทั้งหมด
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // แสดงเนื้อหาและแท็บที่เลือก
            document.getElementById(contentId).classList.add('active');
            event.target.classList.add('active');
        }

        // =================== ฟังก์ชันการค้นหา ===================
        
        /**
         * ฟังก์ชันเปลี่ยนโหมดการค้นหา
         * @param {string} mode - 'free' หรือ 'dropdown'
         */
        function switchSearchMode(mode) {
            searchMode = mode;
            
            // อัปเดตปุ่มโหมดการค้นหา
            document.querySelectorAll('.search-mode-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.mode === mode) {
                    btn.classList.add('active');
                }
            });
            
            // แสดง/ซ่อนส่วนการค้นหา
            document.querySelectorAll('.search-section').forEach(section => {
                section.classList.remove('active');
            });
            
            if (mode === 'free') {
                document.getElementById('freeSearch').classList.add('active');
            } else {
                document.getElementById('dropdownSearch').classList.add('active');
                populateDropdowns(); // เติมข้อมูล dropdown
            }
            
            // ล้างผลการค้นหา
            document.getElementById('searchResults').innerHTML = '';
            document.getElementById('liveResults').innerHTML = '';
        }

        /**
         * ฟังก์ชันจัดการการกดปุ่ม Enter ในช่องค้นหา
         */
        function handleSearchKeyPress(event) {
            if (event.key === 'Enter') {
                searchRoom();
            }
        }

        /**
         * ฟังก์ชันค้นหาแบบเรียลไทม์
         * จะทำการค้นหาทุกครั้งที่มีการพิมพ์ในช่องค้นหา
         */
        function liveSearch() {
            // ล้าง timeout เดิมก่อน
            if (liveSearchTimeout) {
                clearTimeout(liveSearchTimeout);
            }
            
            // ตั้ง timeout ใหม่เพื่อป้องกันการค้นหาบ่อยเกินไป
            liveSearchTimeout = setTimeout(() => {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
                const resultsContainer = document.getElementById('liveResults');
                
                // ถ้าไม่มีคำค้นหา ให้ล้างผลลัพธ์
                if (!searchTerm) {
                    resultsContainer.innerHTML = '';
                    return;
                }
                
                // ค้นหาห้องที่ตรงกับคำค้นหา
                const results = Object.values(roomData).filter(room => 
                    room.name.toLowerCase().includes(searchTerm) || 
                    room.code.toLowerCase().includes(searchTerm) ||
                    room.location.toLowerCase().includes(searchTerm) ||
                    room.description.toLowerCase().includes(searchTerm)
                );
                
                // แสดงผลลัพธ์ (สูงสุด 5 รายการ)
                if (results.length > 0) {
                    resultsContainer.innerHTML = results.slice(0, 5).map(room => `
                        <div class="live-result-item" onclick="viewOnMap('${room.code}')">
                            <div class="live-result-icon">${getRoomIcon(room.name)}</div>
                            <div class="live-result-content">
                                <div class="live-result-title">${room.name}</div>
                                <div class="live-result-subtitle">${room.location}</div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    resultsContainer.innerHTML = `
                        <div class="no-results">
                            <div class="no-results-icon">🔍</div>
                            <p>ไม่พบห้องที่ค้นหา</p>
                        </div>
                    `;
                }
            }, 300); // รอ 300 มิลลิวินาทีก่อนค้นหา
        }

        /**
         * ฟังก์ชันค้นหาห้อง
         */
        function searchRoom() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const resultsContainer = document.getElementById('searchResults');
            
            // ตรวจสอบว่ามีคำค้นหาหรือไม่
            if (!searchTerm) {
                resultsContainer.innerHTML = '<p style="text-align: center; color: #666;">กรุณาใส่ชื่อห้องที่ต้องการค้นหา</p>';
                return;
            }
            
            // ค้นหาห้องที่ตรงกับคำค้นหา
            const results = Object.values(roomData).filter(room => 
                room.name.toLowerCase().includes(searchTerm) || 
                room.code.toLowerCase().includes(searchTerm) ||
                room.location.toLowerCase().includes(searchTerm) ||
                room.description.toLowerCase().includes(searchTerm)
            );
            
            // เพิ่มจำนวนการค้นหา
            searchCount++;
            document.getElementById('todaySearches').textContent = searchCount;
            
            // แสดงผลการค้นหา
            if (results.length > 0) {
                resultsContainer.innerHTML = `<h3>✅ ผลการค้นหา (${results.length} รายการ):</h3>` + 
                    results.map(room => `
                        <div class="result-item" onclick="viewOnMap('${room.code}')">
                            <h4><i class="fas fa-map-marker-alt"></i> ${room.name}</h4>
                            <p><strong>📍 ตำแหน่ง:</strong> ${room.location}</p>
                            <p><strong>⏰ เวลาเปิด:</strong> ${room.hours}</p>
                            <p><strong>📝 รายละเอียด:</strong> ${room.description.length > 100 ? room.description.substring(0, 100) + '...' : room.description}</p>
                        </div>
                    `).join('');
            } else {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">❌</div>
                        <h4>ไม่พบห้อง "${searchTerm}"</h4>
                        <p>💡 ลองค้นหาด้วยคำอื่น หรือดูห้องยอดนิยมด้านล่าง</p>
                    </div>
                `;
            }
        }

        /**
         * ฟังก์ชันค้นหาด่วนตามหมวดหมู่
         * @param {string} category - หมวดหมู่ที่ต้องการค้นหา
         */
        function quickSearch(category) {
            let searchResults = [];
            
            // กำหนดเงื่อนไขการค้นหาตามหมวดหมู่
            switch(category) {
                case 'classroom':
                    searchResults = Object.values(roomData).filter(room => 
                        room.name.includes('ห้องเรียน') || room.name.includes('ม.')
                    );
                    break;
                case 'special':
                    searchResults = Object.values(roomData).filter(room => 
                        room.name.includes('คอมพิวเตอร์') || 
                        room.name.includes('วิทยาศาสตร์') || 
                        room.name.includes('ดนตรี') ||
                        room.name.includes('ศิลปะ') ||
                        room.name.includes('ห้องปฏิบัติการ')
                    );
                    break;
                case 'facilities':
                    searchResults = Object.values(roomData).filter(room => 
                        room.name.includes('สมุด') || 
                        room.name.includes('อาหาร') || 
                        room.name.includes('ประชุม') ||
                        room.name.includes('โรงยิม')
                    );
                    break;
                case 'office':
                    searchResults = Object.values(roomData).filter(room => 
                        room.name.includes('สำนักงาน') || 
                        room.name.includes('ผู้อำนวยการ') || 
                        room.name.includes('พยาบาล') ||
                        room.name.includes('ธุรการ')
                    );
                    break;
            }
            
            const resultsContainer = document.getElementById('searchResults');
            
            // แสดงผลการค้นหา
            if (searchResults.length > 0) {
                resultsContainer.innerHTML = `<h3>✅ ผลการค้นหา (${searchResults.length} รายการ):</h3>` + 
                    searchResults.map(room => `
                        <div class="result-item" onclick="viewOnMap('${room.code}')">
                            <h4>${getRoomIcon(room.name)} ${room.name}</h4>
                            <p><strong>📍 ตำแหน่ง:</strong> ${room.location}</p>
                            <p><strong>⏰ เวลาเปิด:</strong> ${room.hours}</p>
                            <p><strong>📝 รายละเอียด:</strong> ${room.description.length > 100 ? room.description.substring(0, 100) + '...' : room.description}</p>
                        </div>
                    `).join('');
            } else {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">❌</div>
                        <p>ไม่พบห้องในหมวดหมู่นี้</p>
                    </div>
                `;
            }
            
            // เลื่อนไปยังผลการค้นหา
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
            searchCount++;
            document.getElementById('todaySearches').textContent = searchCount;
        }

        // =================== ฟังก์ชันจัดการ Dropdown ===================
        
        /**
         * ฟังก์ชันเติมข้อมูลลงใน dropdown ทั้งหมด
         */
        function populateDropdowns() {
            const rooms = Object.values(roomData);
            
            // เติมข้อมูลรหัสห้อง
            const codeDropdown = document.getElementById('codeDropdown');
            codeDropdown.innerHTML = rooms.map(room => `
                <div class="dropdown-option" onclick="selectDropdownOption('code', '${room.code}', '${room.name}')">
                    <div class="dropdown-option-icon">${getRoomIcon(room.name)}</div>
                    <div class="dropdown-option-text">
                        <div>${room.code}</div>
                        <div class="dropdown-option-subtitle">${room.name}</div>
                    </div>
                </div>
            `).join('');
            
            // เติมข้อมูลชื่อห้อง
            const nameDropdown = document.getElementById('nameDropdown');
            nameDropdown.innerHTML = rooms.map(room => `
                <div class="dropdown-option" onclick="selectDropdownOption('name', '${room.name}', '${room.code}')">
                    <div class="dropdown-option-icon">${getRoomIcon(room.name)}</div>
                    <div class="dropdown-option-text">
                        <div>${room.name}</div>
                        <div class="dropdown-option-subtitle">${room.code} - ${room.location}</div>
                    </div>
                </div>
            `).join('');
            
            // เติมข้อมูลตำแหน่ง (ไม่ซ้ำกัน)
            const locations = [...new Set(rooms.map(room => room.location))];
            const locationDropdown = document.getElementById('locationDropdown');
            locationDropdown.innerHTML = locations.map(location => `
                <div class="dropdown-option" onclick="selectDropdownOption('location', '${location}', '')">
                    <div class="dropdown-option-icon"><i class="fas fa-map-marker-alt"></i></div>
                    <div class="dropdown-option-text">
                        <div>${location}</div>
                        <div class="dropdown-option-subtitle">${rooms.filter(r => r.location === location).length} ห้อง</div>
                    </div>
                </div>
            `).join('');
        }

        /**
         * ฟังก์ชันแสดง/ซ่อน dropdown
         * @param {string} type - ประเภท dropdown: 'code', 'name', 'location'
         */
        function showDropdown(type) {
            // ปิด dropdown อื่นๆ ก่อน
            Object.keys(isDropdownOpen).forEach(key => {
                if (key !== type) {
                    const dropdown = document.getElementById(key + 'Dropdown');
                    const container = dropdown.parentElement;
                    dropdown.classList.remove('show');
                    container.classList.remove('open');
                    isDropdownOpen[key] = false;
                }
            });
            
            // เปิด/ปิด dropdown ที่เลือก
            const dropdown = document.getElementById(type + 'Dropdown');
            const container = dropdown.parentElement;
            
            if (isDropdownOpen[type]) {
                dropdown.classList.remove('show');
                container.classList.remove('open');
                isDropdownOpen[type] = false;
            } else {
                dropdown.classList.add('show');
                container.classList.add('open');
                isDropdownOpen[type] = true;
            }
        }

        /**
         * ฟังก์ชันเลือกตัวเลือกใน dropdown
         * @param {string} type - ประเภท dropdown
         * @param {string} value - ค่าที่เลือก
         * @param {string} subtitle - ข้อความเสริม
         */
        function selectDropdownOption(type, value, subtitle) {
            const input = document.getElementById(type === 'code' ? 'roomCodeSelect' : 
                                               type === 'name' ? 'roomNameSelect' : 'locationSelect');
            input.value = value;
            
            // ปิด dropdown
            const dropdown = document.getElementById(type + 'Dropdown');
            const container = dropdown.parentElement;
            dropdown.classList.remove('show');
            container.classList.remove('open');
            isDropdownOpen[type] = false;
        }

        /**
         * ฟังก์ชันกรอง dropdown ตามข้อความที่พิมพ์
         * @param {string} type - ประเภท dropdown
         */
        function filterDropdown(type) {
            const input = document.getElementById(type === 'code' ? 'roomCodeSelect' : 
                                               type === 'name' ? 'roomNameSelect' : 'locationSelect');
            const filter = input.value.toLowerCase();
            const dropdown = document.getElementById(type + 'Dropdown');
            const options = dropdown.querySelectorAll('.dropdown-option');
            
            // แสดง/ซ่อนตัวเลือกตามการกรอง
            options.forEach(option => {
                const text = option.textContent.toLowerCase();
                if (text.includes(filter)) {
                    option.style.display = 'flex';
                } else {
                    option.style.display = 'none';
                }
            });
            
            // แสดง dropdown ถ้ายังไม่เปิด
            if (!isDropdownOpen[type]) {
                showDropdown(type);
            }
        }

        /**
         * ฟังก์ชันค้นหาจาก dropdown
         */
        function searchFromDropdown() {
            const roomCode = document.getElementById('roomCodeSelect').value.trim();
            const roomName = document.getElementById('roomNameSelect').value.trim();
            const location = document.getElementById('locationSelect').value.trim();
            
            // ตรวจสอบว่ามีการเลือกเงื่อนไขหรือไม่
            if (!roomCode && !roomName && !location) {
                showNotification('❌ กรุณาเลือกเงื่อนไขการค้นหาอย่างน้อย 1 รายการ', 'error');
                return;
            }
            
            // ค้นหาห้องตามเงื่อนไข
            const results = Object.values(roomData).filter(room => {
                let match = true;
                
                if (roomCode && !room.code.toLowerCase().includes(roomCode.toLowerCase())) {
                    match = false;
                }
                if (roomName && !room.name.toLowerCase().includes(roomName.toLowerCase())) {
                    match = false;
                }
                if (location && !room.location.toLowerCase().includes(location.toLowerCase())) {
                    match = false;
                }
                
                return match;
            });
            
            // แสดงผลการค้นหา
            const resultsContainer = document.getElementById('searchResults');
            
            if (results.length > 0) {
                resultsContainer.innerHTML = `<h3>✅ ผลการค้นหา (${results.length} รายการ):</h3>` + 
                    results.map(room => `
                        <div class="result-item" onclick="viewOnMap('${room.code}')">
                            <h4>${getRoomIcon(room.name)} ${room.name}</h4>
                            <p><strong>📍 ตำแหน่ง:</strong> ${room.location}</p>
                            <p><strong>⏰ เวลาเปิด:</strong> ${room.hours}</p>
                            <p><strong>📝 รายละเอียด:</strong> ${room.description.length > 100 ? room.description.substring(0, 100) + '...' : room.description}</p>
                        </div>
                    `).join('');
            } else {
                resultsContainer.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">❌</div>
                        <p>ไม่พบห้องตามเงื่อนไขที่ระบุ</p>
                    </div>
                `;
            }
            
            // เลื่อนไปยังผลการค้นหา และเพิ่มจำนวนการค้นหา
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
            searchCount++;
            document.getElementById('todaySearches').textContent = searchCount;
        }

        /**
         * ฟังก์ชันล้าง dropdown ทั้งหมด
         */
        function clearAllDropdowns() {
            document.getElementById('roomCodeSelect').value = '';
            document.getElementById('roomNameSelect').value = '';
            document.getElementById('locationSelect').value = '';
            document.getElementById('searchResults').innerHTML = '';
            
            // ปิด dropdown ทั้งหมด
            Object.keys(isDropdownOpen).forEach(key => {
                const dropdown = document.getElementById(key + 'Dropdown');
                const container = dropdown.parentElement;
                dropdown.classList.remove('show');
                container.classList.remove('open');
                isDropdownOpen[key] = false;
            });
            
            showNotification('🔄 ล้างข้อมูลการค้นหาเรียบร้อย', 'success');
        }

        // ปิด dropdown เมื่อคลิกข้างนอก
        document.addEventListener('click', function(event) {
            const isDropdownElement = event.target.closest('.custom-dropdown');
            if (!isDropdownElement) {
                Object.keys(isDropdownOpen).forEach(key => {
                    const dropdown = document.getElementById(key + 'Dropdown');
                    const container = dropdown.parentElement;
                    dropdown.classList.remove('show');
                    container.classList.remove('open');
                    isDropdownOpen[key] = false;
                });
            }
        });

        // =================== ฟังก์ชันจัดการแผนที่ ===================
        
        /**
         * ฟังก์ชันดูห้องบนแผนที่
         * @param {string} roomCode - รหัสห้องที่ต้องการดู
         */
        function viewOnMap(roomCode) {
            showPage('map');  // เปลี่ยนไปหน้าแผนที่
            setTimeout(() => {
                highlightRoom(roomCode);    // เน้นห้องบนแผนที่
                showRoomInfo(roomCode);     // แสดงข้อมูลห้อง
            }, 300);
        }

        /**
         * ฟังก์ชันเน้นห้องบนแผนที่
         * @param {string} roomCode - รหัสห้องที่ต้องการเน้น
         */
        function highlightRoom(roomCode) {
            // ลบการเน้นเดิม
            document.querySelectorAll('.room-marker').forEach(marker => {
                marker.classList.remove('highlighted');
            });
            
            // เน้นห้องที่เลือก
            const targetMarker = document.querySelector(`[data-room="${roomCode}"]`);
            if (targetMarker) {
                targetMarker.classList.add('highlighted');
                selectedRoom = roomCode;
                
                // ลบการเน้นหลังจาก 3 วินาที
                setTimeout(() => {
                    targetMarker.classList.remove('highlighted');
                }, 3000);
            }
        }

        /**
         * ฟังก์ชันแสดงข้อมูลห้อง
         * @param {string} roomCode - รหัสห้องที่ต้องการแสดงข้อมูล
         */
        function showRoomInfo(roomCode) {
            const room = roomData[roomCode];
            if (!room) return;

            // ซ่อนข้อมูลเริ่มต้น แสดงข้อมูลห้อง
            document.getElementById('defaultInfo').style.display = 'none';
            document.getElementById('roomDetails').classList.add('active');
            
            // เติมข้อมูลห้อง
            document.getElementById('roomName').innerHTML = `${getRoomIcon(room.name)} ${room.name}`;
            document.getElementById('roomLocation').textContent = room.location;
            document.getElementById('roomDescription').textContent = room.description;
            document.getElementById('roomHours').textContent = room.hours;
            document.getElementById('roomContact').textContent = room.contact || 'ไม่มีข้อมูล';
            
            // แสดงรูปภาพ
            updateImageGallery(room.images || []);
        }

        /**
         * ฟังก์ชันอัปเดตแกลอรี่รูปภาพ
         * @param {Array} images - อาร์เรย์ของ URL รูปภาพ
         */
        function updateImageGallery(images) {
            const galleryContainer = document.getElementById('galleryImages');
            const gallerySection = document.getElementById('imageGallery');
            
            if (images.length > 0) {
                gallerySection.style.display = 'block';
                galleryContainer.innerHTML = images.map((url, index) => `
                    <img src="${url}" alt="รูปห้อง ${index + 1}" class="gallery-image" 
                         onclick="openImageModal('${url}')" 
                         onerror="this.style.display='none'"
                         style="transform: ${viewMode === '3d' ? 'perspective(1000px) rotateY(10deg)' : 'none'};">
                `).join('');
            } else {
                gallerySection.style.display = 'none';
            }
        }

        /**
         * ฟังก์ชันตั้งค่าโหมดการแสดงรูปภาพ
         * @param {string} mode - '2d' หรือ '3d'
         */
        function setViewMode(mode) {
            viewMode = mode;
            
            // อัปเดตปุ่ม
            document.querySelectorAll('.view-mode-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.mode === mode) {
                    btn.classList.add('active');
                }
            });
            
            // อัปเดตรูปภาพ
            if (selectedRoom) {
                const room = roomData[selectedRoom];
                if (room) {
                    updateImageGallery(room.images || []);
                }
            }
            
            showNotification(`🖼️ เปลี่ยนเป็นโหมด ${mode.toUpperCase()}`, 'success');
        }

        /**
         * ฟังก์ชันเปิด Modal รูปภาพ
         * @param {string} imageUrl - URL ของรูปภาพ
         */
        function openImageModal(imageUrl) {
            document.getElementById('modalImage').src = imageUrl;
            document.getElementById('imageModal').style.display = 'block';
        }

        /**
         * ฟังก์ชันปิด Modal รูปภาพ
         */
        function closeImageModal() {
            document.getElementById('imageModal').style.display = 'none';
        }

        /**
         * ฟังก์ชันเปิดแผนที่เต็มจอ
         */
        function openFullscreenMap() {
            const fullscreenModal = document.getElementById('fullscreenModal');
            const fullscreenContainer = document.getElementById('fullscreenMapContainer');
            const originalMap = document.getElementById('mapArea');
            
            // คัดลอกเนื้อหาแผนที่ไปยังโหมดเต็มจอ
            fullscreenContainer.innerHTML = originalMap.innerHTML;
            fullscreenModal.classList.add('active');
            
            showNotification('🖥️ เปิดแผนที่เต็มจอ', 'success');
        }

        /**
         * ฟังก์ชันปิดแผนที่เต็มจอ
         */
        function closeFullscreenMap() {
            document.getElementById('fullscreenModal').classList.remove('active');
            showNotification('↩️ ปิดแผนที่เต็มจอ', 'success');
        }

        /**
         * ฟังก์ชันแสดง/ซ่อนตำแหน่งผู้ใช้
         */
        function toggleUserPosition() {
            const userMarker = document.getElementById('userMarker');
            
            if (userMarker.classList.contains('hidden')) {
                userMarker.classList.remove('hidden');
                makeUserMarkerDraggable();
                showNotification('📍 แสดงตำแหน่งของคุณ - ลากเพื่อย้าย', 'success');
            } else {
                userMarker.classList.add('hidden');
                clearRoute();
                showNotification('❌ ซ่อนตำแหน่งของคุณ', 'success');
            }
        }

        /**
         * ฟังก์ชันทำให้ตัวชี้ตำแหน่งผู้ใช้ลากได้
         */
        function makeUserMarkerDraggable() {
            const userMarker = document.getElementById('userMarker');
            const mapArea = document.getElementById('mapArea');
            
            let isDragging = false;
            
            userMarker.addEventListener('mousedown', function(e) {
                isDragging = true;
                userMarker.style.cursor = 'grabbing';
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isDragging) {
                    const mapRect = mapArea.getBoundingClientRect();
                    const x = ((e.clientX - mapRect.left) / mapRect.width) * 100;
                    const y = ((e.clientY - mapRect.top) / mapRect.height) * 100;
                    
                    // จำกัดไม่ให้ออกนอกแผนที่
                    if (x >= 0 && x <= 100 && y >= 0 && y <= 100) {
                        userMarker.style.left = x + '%';
                        userMarker.style.top = y + '%';
                        userPosition.x = x;
                        userPosition.y = y;
                    }
                }
            });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
                userMarker.style.cursor = 'move';
            });
        }

        /**
         * ฟังก์ชันใช้ GPS หาตำแหน่งปัจจุบัน
         */
        function getCurrentLocation() {
            if (navigator.geolocation) {
                showNotification('📡 กำลังค้นหาตำแหน่งของคุณ...', 'warning');
                
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        // ในระบบจริงจะแปลงพิกัด GPS เป็นตำแหน่งบนแผนที่
                        // ที่นี่จำลองโดยการสุ่มตำแหน่ง
                        const randomX = Math.random() * 80 + 10;
                        const randomY = Math.random() * 80 + 10;
                        
                        const userMarker = document.getElementById('userMarker');
                        userMarker.style.left = randomX + '%';
                        userMarker.style.top = randomY + '%';
                        userMarker.classList.remove('hidden');
                        
                        userPosition.x = randomX;
                        userPosition.y = randomY;
                        
                        makeUserMarkerDraggable();
                        showNotification('✅ พบตำแหน่งของคุณแล้ว!', 'success');
                    },
                    function(error) {
                        showNotification('❌ ไม่สามารถหาตำแหน่งได้ กรุณาลากจุดเขียวเพื่อตั้งตำแหน่งเอง', 'error');
                    }
                );
            } else {
                showNotification('❌ เบราว์เซอร์ไม่รองรับ GPS', 'error');
            }
        }

        /**
         * ฟังก์ชันขอเส้นทาง
         */
        function getDirections() {
            if (!selectedRoom) {
                showNotification('❌ กรุณาเลือกห้องปลายทางก่อน', 'error');
                return;
            }
            
            const userMarker = document.getElementById('userMarker');
            if (userMarker.classList.contains('hidden')) {
                showNotification('❌ กรุณาตั้งตำแหน่งของคุณก่อน', 'error');
                return;
            }
            
            const targetRoom = roomData[selectedRoom];
            if (!targetRoom) return;
            
            drawRoute(userPosition, { x: targetRoom.x, y: targetRoom.y });
            showNotification('🧭 แสดงเส้นทางแล้ว', 'success');
        }

        /**
         * ฟังก์ชันวาดเส้นทาง
         * @param {Object} start - จุดเริ่มต้น {x, y}
         * @param {Object} end - จุดปลายทาง {x, y}
         */
        function drawRoute(start, end) {
            clearRoute(); // ล้างเส้นทางเดิม
            
            const routeContainer = document.getElementById('routePath');
            
            // คำนวณระยะทางและมุม
            const deltaX = end.x - start.x;
            const deltaY = end.y - start.y;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            const angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;
            
            // สร้างเส้นทาง
            const routeLine = document.createElement('div');
            routeLine.className = 'route-path';
            routeLine.style.position = 'absolute';
            routeLine.style.left = start.x + '%';
            routeLine.style.top = start.y + '%';
            routeLine.style.width = distance + '%';
            routeLine.style.height = '3px';
            routeLine.style.background = '#28a745';
            routeLine.style.transformOrigin = '0 0';
            routeLine.style.transform = `rotate(${angle}deg)`;
            routeLine.style.zIndex = '50';
            routeLine.style.borderRadius = '2px';
            
            routeContainer.appendChild(routeLine);
        }

        /**
         * ฟังก์ชันล้างเส้นทาง
         */
        function clearRoute() {
            document.getElementById('routePath').innerHTML = '';
        }

        /**
         * ฟังก์ชันแสดงรายละเอียดเส้นทาง
         */
        function showRouteDetails() {
            if (!selectedRoom) {
                showNotification('❌ กรุณาเลือกห้องปลายทางก่อน', 'error');
                return;
            }
            
            const targetRoom = roomData[selectedRoom];
            if (!targetRoom) return;
            
            // คำนวณระยะทางประมาณ (สมมติ 1% = 10 เมตร)
            const deltaX = targetRoom.x - userPosition.x;
            const deltaY = targetRoom.y - userPosition.y;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            const meters = Math.round(distance * 10);
            const walkingTime = Math.ceil(meters / 80); // ความเร็วเดิน 80 เมตร/นาที
            
            // สร้างรายละเอียดเส้นทาง
            let directions = `🗺️ เส้นทางไป ${targetRoom.name}\n\n`;
            directions += `📏 ระยะทาง: ประมาณ ${meters} เมตร\n`;
            directions += `⏱️ เวลาเดิน: ประมาณ ${walkingTime} นาที\n\n`;
            
            // เพิ่มจุดสำคัญระหว่างทาง
            directions += `🚶‍♂️ คำแนะนำการเดินทาง:\n`;
            directions += `1. เริ่มจากตำแหน่งปัจจุบันของคุณ\n`;
            
            if (targetRoom.location.includes('ชั้น 1')) {
                directions += `2. มุ่งหน้าสู่ชั้น 1\n`;
            } else if (targetRoom.location.includes('ชั้น 2')) {
                directions += `2. ขึ้นบันไดสู่ชั้น 2\n`;
            } else if (targetRoom.location.includes('ชั้น 3')) {
                directions += `2. ขึ้นบันไดสู่ชั้น 3\n`;
            }
            
            if (targetRoom.location.includes('อาคาร A')) {
                directions += `3. เดินไปยังอาคาร A (อาคารหลัก)\n`;
            } else if (targetRoom.location.includes('อาคาร B')) {
                directions += `3. เดินไปยังอาคาร B (อาคารวิทยาศาสตร์)\n`;
            } else if (targetRoom.location.includes('อาคาร C')) {
                directions += `3. เดินไปยังอาคาร C (อาคารห้องสมุด)\n`;
            }
            
            directions += `4. มองหาป้าย "${targetRoom.name}"\n`;
            directions += `5. ถึงจุดหมายแล้ว! 🎯\n\n`;
            
            directions += `💡 เคล็ดลับ: ถ้าหลงทาง สามารถถามเจ้าหน้าที่หรือนักเรียนได้`;
            
            alert(directions);
        }

        /**
         * ฟังก์ชันซูมแผนที่
         */
        function zoomIn() {
            mapZoom = Math.min(mapZoom + 0.2, 3);
            applyZoom();
            showNotification('🔍 ขยายแผนที่', 'success');
        }

        function zoomOut() {
            mapZoom = Math.max(mapZoom - 0.2, 0.5);
            applyZoom();
            showNotification('🔍 ย่อแผนที่', 'success');
        }

        function resetZoom() {
            mapZoom = 1;
            applyZoom();
            showNotification('🏠 รีเซ็ตการซูม', 'success');
        }

        /**
         * ฟังก์ชันใช้การซูม
         */
        function applyZoom() {
            const mapImage = document.getElementById('schoolMap');
            mapImage.style.transform = `scale(${mapZoom})`;
        }

        // =================== ฟังก์ชันจัดการข้อมูลห้อง ===================
        
        /**
         * ฟังก์ชันอัปเดตตารางห้อง
         */
        function updateRoomTable() {
            const tbody = document.getElementById('roomTableBody');
            tbody.innerHTML = Object.values(roomData).map(room => `
                <tr>
                    <td>${room.code}</td>
                    <td>${room.name}</td>
                    <td>${room.location}</td>
                    <td>${getStatusIcon(room.status)} ${getStatusText(room.status)}</td>
                    <td>
                        <button class="btn btn-success" onclick="editRoom('${room.code}')">
                            <i class="fas fa-edit"></i> แก้ไข
                        </button>
                        <button class="btn btn-danger" onclick="deleteRoom('${room.code}')">
                            <i class="fas fa-trash"></i> ลบ
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        /**
         * ฟังก์ชันช่วยแสดงไอคอนสถานะ
         */
        function getStatusIcon(status) {
            switch(status) {
                case 'active': return '✅';
                case 'maintenance': return '🔧';
                case 'closed': return '❌';
                default: return '❓';
            }
        }

        /**
         * ฟังก์ชันช่วยแสดงข้อความสถานะ
         */
        function getStatusText(status) {
            switch(status) {
                case 'active': return 'ใช้งาน';
                case 'maintenance': return 'ปรับปรุง';
                case 'closed': return 'ปิด';
                default: return 'ไม่ทราบ';
            }
        }

        /**
         * ฟังก์ชันอัปเดต Markers บนแผนที่
         */
        function updateRoomMarkers() {
            const markersContainer = document.getElementById('roomMarkers');
            markersContainer.innerHTML = Object.values(roomData).map(room => {
                const icon = getRoomIcon(room.name);
                return `
                    <div class="room-marker" data-room="${room.code}" 
                         onclick="showRoomInfo('${room.code}')" 
                         style="top: ${room.y}%; left: ${room.x}%;"
                         title="${room.name}">
                        ${icon}
                    </div>
                `;
            }).join('');
        }

        /**
         * ฟังก์ชันช่วยเลือกไอคอนห้อง
         */
        function getRoomIcon(roomName) {
            if (roomName.includes('คอมพิวเตอร์')) return '💻';
            if (roomName.includes('สมุด')) return '📚';
            if (roomName.includes('อาหาร')) return '🍽️';
            if (roomName.includes('ดนตรี')) return '🎵';
            if (roomName.includes('ศิลปะ')) return '🎨';
            if (roomName.includes('ยิม')) return '🏃';
            if (roomName.includes('ประชุม')) return '🏛️';
            if (roomName.includes('วิทยาศาสตร์') || roomName.includes('ปฏิบัติการ')) return '🧪';
            if (roomName.includes('ผู้อำนวยการ') || roomName.includes('สำนักงาน')) return '🏢';
            if (roomName.includes('พยาบาล')) return '🏥';
            if (roomName.includes('ห้องเรียน') || roomName.includes('ม.')) return '🎓';
            return '🏠';
        }

        /**
         * ฟังก์ชันอัปเดตห้องแนะนำ
         */
        function updateSuggestions() {
            // ฟังก์ชันนี้จะอัปเดตส่วนแสดงห้องแนะนำ
            // ปัจจุบันใช้ข้อมูลคงที่ในส่วน HTML
        }

        /**
         * ฟังก์ชันอัปเดตสถิติ
         */
        function updateStatistics() {
            const totalRooms = Object.keys(roomData).length;
            const activeRooms = Object.values(roomData).filter(room => room.status === 'active').length;
            
            document.getElementById('totalRooms').textContent = totalRooms;
            document.getElementById('activeRooms').textContent = activeRooms;
            document.getElementById('todaySearches').textContent = searchCount;
        }

        /**
         * ฟังก์ชันแก้ไขห้อง
         * @param {string} roomCode - รหัสห้องที่ต้องการแก้ไข
         */
        function editRoom(roomCode) {
            const room = roomData[roomCode];
            if (!room) return;
            
            // เติมข้อมูลในฟอร์ม
            document.getElementById('editingRoomId').value = roomCode;
            document.getElementById('roomCode').value = room.code;
            document.getElementById('roomName').value = room.name;
            document.getElementById('roomLocation').value = room.location;
            document.getElementById('roomDescription').value = room.description;
            document.getElementById('roomHours').value = room.hours;
            document.getElementById('roomContact').value = room.contact || '';
            document.getElementById('roomStatus').value = room.status;
            document.getElementById('roomX').value = room.x;
            document.getElementById('roomY').value = room.y;
            document.getElementById('roomImages').value = (room.images || []).join(', ');
            
            // เลื่อนไปยังฟอร์ม
            document.getElementById('roomForm').scrollIntoView({ behavior: 'smooth' });
            
            showNotification('📝 พร้อมแก้ไขข้อมูลห้อง', 'success');
        }

        /**
         * ฟังก์ชันลบห้อง
         * @param {string} roomCode - รหัสห้องที่ต้องการลบ
         */
        function deleteRoom(roomCode) {
            if (confirm('คุณต้องการลบห้องนี้หรือไม่?\n\n⚠️ การลบจะไม่สามารถยกเลิกได้')) {
                delete roomData[roomCode];     // ลบข้อมูลห้อง
                saveDataToLocalStorage();     // บันทึกลง localStorage
                updateUI();                   // อัปเดต UI
                showNotification('🗑️ ลบห้องเรียบร้อยแล้ว', 'success');
            }
        }

        /**
         * ฟังก์ชันบันทึกห้อง
         * @param {Event} event - เหตุการณ์การ submit ฟอร์ม
         */
        function saveRoom(event) {
            event.preventDefault(); // ป้องกันการ submit form แบบปกติ
            
            const roomCode = document.getElementById('roomCode').value.trim();
            const roomName = document.getElementById('roomName').value.trim();
            const editingId = document.getElementById('editingRoomId').value;
            
            // ตรวจสอบข้อมูลพื้นฐาน
            if (!roomCode || !roomName) {
                showNotification('❌ กรุณากรอกรหัสห้องและชื่อห้อง', 'error');
                return;
            }
            
            // ตรวจสอบรหัสห้องซ้ำ (ยกเว้นตอนแก้ไข)
            if (!editingId && roomData[roomCode]) {
                showNotification('❌ รหัสห้องนี้มีอยู่แล้ว', 'error');
                return;
            }
            
            // รวบรวมข้อมูลรูปภาพ
            const imageUrls = document.getElementById('roomImages').value
                .split(',')                    // แยกด้วยคอมม่า
                .map(url => url.trim())        // ตัดช่องว่าง
                .filter(url => url);          // เอาเฉพาะที่ไม่ว่าง
            
            // สร้างออบเจ็กต์ข้อมูลห้อง
            const roomInfo = {
                code: roomCode,
                name: roomName,
                location: document.getElementById('roomLocation').value.trim(),
                description: document.getElementById('roomDescription').value.trim(),
                hours: document.getElementById('roomHours').value.trim() || '08:00 - 17:00',
                contact: document.getElementById('roomContact').value.trim(),
                status: document.getElementById('roomStatus').value,
                x: parseFloat(document.getElementById('roomX').value) || 0,
                y: parseFloat(document.getElementById('roomY').value) || 0,
                images: imageUrls
            };
            
            // ถ้าเป็นการแก้ไขและเปลี่ยนรหัสห้อง ให้ลบข้อมูลเดิมก่อน
            if (editingId && editingId !== roomCode) {
                delete roomData[editingId];
            }
            
            // บันทึกข้อมูล
            roomData[roomCode] = roomInfo;
            saveDataToLocalStorage();
            updateUI();
            clearForm();
            
            const action = editingId ? 'แก้ไข' : 'เพิ่ม';
            showNotification(`✅ ${action}ข้อมูลห้องเรียบร้อยแล้ว`, 'success');
        }

        /**
         * ฟังก์ชันล้างฟอร์ม
         */
        function clearForm() {
            document.getElementById('roomForm').reset();
            document.getElementById('editingRoomId').value = '';
        }

        // =================== ฟังก์ชันจัดการแผนที่ ===================
        
        /**
         * ฟังก์ชันจัดการอัปโหลดแผนที่
         * @param {Event} event - เหตุการณ์การเปลี่ยนไฟล์
         */
        function handleMapUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // ตรวจสอบประเภทไฟล์
            if (!file.type.startsWith('image/')) {
                showNotification('❌ กรุณาเลือกไฟล์รูปภาพเท่านั้น', 'error');
                return;
            }
            
            // ตรวจสอบขนาดไฟล์ (5MB)
            if (file.size > 5 * 1024 * 1024) {
                showNotification('❌ ไฟล์ใหญ่เกินไป กรุณาเลือกไฟล์ที่มีขนาดไม่เกิน 5MB', 'error');
                return;
            }
            
            // อ่านไฟล์และแสดงตัวอย่าง
            const reader = new FileReader();
            reader.onload = function(e) {
                customMapImage = e.target.result;
                
                // แสดงตัวอย่างแผนที่
                const preview = document.getElementById('currentMapPreview');
                preview.src = customMapImage;
                preview.classList.remove('hidden');
                
                document.getElementById('mapStatus').textContent = 'พร้อมใช้งาน - รอการนำไปใช้';
                showNotification('✅ อัปโหลดแผนที่สำเร็จ! คลิก "ใช้แผนที่ที่อัปโหลด" เพื่อนำไปใช้', 'success');
            };
            reader.readAsDataURL(file);
        }

        /**
         * ฟังก์ชันใช้แผนที่ที่อัปโหลด
         */
        function applyCustomMap() {
            if (!customMapImage) {
                showNotification('❌ กรุณาอัปโหลดแผนที่ก่อน', 'error');
                return;
            }
            
            // เปลี่ยนแผนที่หลัก
            document.getElementById('schoolMap').src = customMapImage;
            document.getElementById('mapStatus').textContent = 'กำลังใช้งาน - แผนที่กำหนดเอง';
            
            // บันทึกลง localStorage
            localStorage.setItem('customMapImage', customMapImage);
            
            showNotification('✅ เปลี่ยนเป็นแผนที่กำหนดเองเรียบร้อย', 'success');
        }

        /**
         * ฟังก์ชันรีเซ็ตเป็นแผนที่เริ่มต้น
         */
        function resetToDefaultMap() {
            const defaultMapSrc = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f0f0f0'/%3E%3Ctext x='400' y='250' text-anchor='middle' font-family='Arial' font-size='24' fill='%23666'%3E🏫 แผนที่โรงเรียนอัจฉริยะ%3C/text%3E%3Ctext x='400' y='280' text-anchor='middle' font-family='Arial' font-size='16' fill='%23999'%3E(อัปโหลดแผนที่ในหน้าจัดการข้อมูล)%3C/text%3E%3Ctext x='400' y='320' text-anchor='middle' font-family='Arial' font-size='14' fill='%23999'%3E📍 คลิกจุดสีน้ำเงินเพื่อดูข้อมูลห้อง%3C/text%3E%3Ctext x='400' y='350' text-anchor='middle' font-family='Arial' font-size='14' fill='%23999'%3E🟢 ลากจุดเขียวเพื่อตั้งตำแหน่งของคุณ%3C/text%3E%3C/svg%3E";
            
            document.getElementById('schoolMap').src = defaultMapSrc;
            document.getElementById('mapStatus').textContent = 'ใช้แผนที่เริ่มต้น';
            document.getElementById('currentMapPreview').classList.add('hidden');
            
            customMapImage = null;
            localStorage.removeItem('customMapImage');
            
            showNotification('🔄 เปลี่ยนกลับเป็นแผนที่เริ่มต้นแล้ว', 'success');
        }

        /**
         * ฟังก์ชันอัปเดตข้อมูลโรงเรียน
         */
        function updateSchoolInfo() {
            const schoolName = document.getElementById('schoolName').value.trim();
            const schoolAddress = document.getElementById('schoolAddress').value.trim();
            
            if (schoolName) {
                document.getElementById('currentLocation').textContent = schoolName;
                localStorage.setItem('schoolName', schoolName);
            }
            
            if (schoolAddress) {
                localStorage.setItem('schoolAddress', schoolAddress);
            }
            
            showNotification('✅ อัปเดตข้อมูลโรงเรียนเรียบร้อย', 'success');
        }

        // =================== ฟังก์ชันจัดการ Google Sheets ===================
        
        /**
         * ฟังก์ชันทดสอบการเชื่อมต่อ Google Sheets
         */
        function testConnection() {
            const sheetId = document.getElementById('sheetId').value.trim();
            const sheetName = document.getElementById('sheetName').value.trim();
            
            if (!sheetId) {
                showNotification('❌ กรุณากรอก Google Sheet ID', 'error');
                return;
            }
            
            showNotification('🔍 กำลังทดสอบการเชื่อมต่อ...', 'warning');
            
            // จำลองการทดสอบการเชื่อมต่อ
            setTimeout(() => {
                const success = Math.random() > 0.3; // 70% โอกาสสำเร็จ
                if (success) {
                    showNotification('✅ เชื่อมต่อ Google Sheet สำเร็จ!', 'success');
                } else {
                    showNotification('❌ ไม่สามารถเชื่อมต่อได้ กรุณาตรวจสอบ Sheet ID', 'error');
                }
            }, 2000);
        }

        /**
         * ฟังก์ชันซิงค์ข้อมูลจาก Google Sheets
         */
        function syncFromGoogleSheets() {
            showNotification('📥 กำลังดึงข้อมูลจาก Google Sheets...', 'warning');
            
            // จำลองการดึงข้อมูล
            setTimeout(() => {
                // ในระบบจริงจะมีการเรียก API ของ Google Sheets
                showNotification('✅ ดึงข้อมูลจาก Google Sheets เรียบร้อย!', 'success');
                updateUI();
            }, 3000);
        }

        /**
         * ฟังก์ชันซิงค์ข้อมูลไป Google Sheets
         */
        function syncToGoogleSheets() {
            showNotification('📤 กำลังส่งข้อมูลไป Google Sheets...', 'warning');
            
            // จำลองการส่งข้อมูล
            setTimeout(() => {
                // ในระบบจริงจะมีการส่งข้อมูลไป Google Sheets API
                showNotification('✅ ส่งข้อมูลไป Google Sheets เรียบร้อย!', 'success');
            }, 2000);
        }

        /**
         * ฟังก์ชันสำรองข้อมูล
         */
        function backupData() {
            const backupData = {
                rooms: roomData,
                customMap: customMapImage,
                schoolInfo: {
                    name: localStorage.getItem('schoolName') || 'โรงเรียนอัจฉริยะ',
                    address: localStorage.getItem('schoolAddress') || ''
                },
                settings: {
                    dataMode: dataMode,
                    viewMode: viewMode
                },
                timestamp: new Date().toISOString()
            };
            
            // สร้างไฟล์ JSON และดาวน์โหลด
            const blob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `school_map_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('💾 สำรองข้อมูลเรียบร้อย! ไฟล์ถูกดาวน์โหลดแล้ว', 'success');
        }

        // =================== ฟังก์ชันช่วยเหลือ ===================
        
        /**
         * ฟังก์ชันแสดงช่วยเหลือด่วน
         */
        function showQuickHelp() {
            const helpText = `
🏫 คู่มือใช้งานระบบแผนที่โรงเรียนอัจฉริยะ

🔍 การค้นหา:
• ค้นหาแบบอิสระ: พิมพ์ชื่อห้อง รหัส หรือตำแหน่ง
• ค้นหาแบบเลือก: เลือกจาก dropdown
• ค้นหาด่วน: คลิกการ์ดหมวดหมู่

🗺️ การใช้แผนที่:
• คลิกจุดสีน้ำเงินเพื่อดูข้อมูลห้อง
• ลากจุดเขียวเพื่อตั้งตำแหน่งของคุณ
• กดปุ่ม "ขอเส้นทาง" เพื่อดูเส้นทาง
• ใช้ปุ่มซูมเพื่อขยาย/ย่อแผนที่

📱 เคล็ดลับ:
• กดปุ่ม "ดูแผนที่เต็มจอ" เพื่อดูรายละเอียดมากขึ้น
• ใช้ GPS เพื่อหาตำแหน่งอัตโนมัติ
• เปลี่ยนมุมมองรูปภาพเป็น 2D หรือ 3D

❓ ต้องการความช่วยเหลือเพิ่มเติม?
ติดต่อเจ้าหน้าที่โรงเรียนได้ที่ 02-123-4567
            `;
            
            alert(helpText);
        }

        // =================== ฟังก์ชันการแจ้งเตือน ===================
        
        /**
         * ฟังก์ชันแสดงการแจ้งเตือน
         * @param {string} message - ข้อความที่ต้องการแสดง
         * @param {string} type - ประเภทการแจ้งเตือน: 'success', 'error', 'warning'
         */
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            
            // ตั้งค่าข้อความและประเภท
            notification.textContent = message;
            notification.className = `notification ${type}`;
            
            // แสดงการแจ้งเตือน
            notification.classList.add('show');
            
            // ซ่อนหลังจาก 4 วินาที
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // =================== ฟังก์ชัน Drag and Drop ===================
        
        /**
         * ฟังก์ชันตั้งค่า Drag and Drop สำหรับอัปโหลดแผนที่
         */
        function setupDragAndDrop() {
            const uploadArea = document.getElementById('mapUploadArea');
            
            // จัดการเหตุการณ์ลากไฟล์เข้ามา
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            // จัดการเหตุการณ์ลากไฟล์ออกไป
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });
            
            // จัดการเหตุการณ์วางไฟล์
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    document.getElementById('mapFileInput').files = files;
                    handleMapUpload({ target: { files: files } });
                }
            });
        }

        // =================== ฟังก์ชันจัดการ Device Orientation ===================
        
        /**
         * ฟังก์ชันจัดการการหมุนของอุปกรณ์
         */
        function setupDeviceOrientation() {
            if (window.DeviceOrientationEvent) {
                window.addEventListener('deviceorientation', function(event) {
                    // อัปเดตทิศทางของเข็มทิศ
                    deviceOrientation = event.alpha || 0;
                    updateCompass();
                });
            }
        }

        /**
         * ฟังก์ชันอัปเดตเข็มทิศ
         */
        function updateCompass() {
            const compass = document.getElementById('compass');
            const needle = document.getElementById('compassNeedle');
            
            if (needle) {
                needle.style.transform = `rotate(${-deviceOrientation}deg)`;
            }
        }

        // =================== ฟังก์ชันเริ่มต้นระบบ ===================
        
        /**
         * ฟังก์ชันเริ่มต้นระบบ
         * จะทำงานเมื่อหน้าเว็บโหลดเสร็จ
         */
        function initializeSystem() {
            // โหลดข้อมูลที่บันทึกไว้ใน localStorage
            const savedMapImage = localStorage.getItem('customMapImage');
            if (savedMapImage) {
                customMapImage = savedMapImage;
                document.getElementById('schoolMap').src = savedMapImage;
                document.getElementById('mapStatus').textContent = 'กำลังใช้งาน - แผนที่กำหนดเอง';
                
                // แสดงตัวอย่างแผนที่
                const preview = document.getElementById('currentMapPreview');
                preview.src = savedMapImage;
                preview.classList.remove('hidden');
            }
            
            // โหลดข้อมูลโรงเรียน
            const savedSchoolName = localStorage.getItem('schoolName');
            if (savedSchoolName) {
                document.getElementById('schoolName').value = savedSchoolName;
                document.getElementById('currentLocation').textContent = savedSchoolName;
            }
            
            const savedSchoolAddress = localStorage.getItem('schoolAddress');
            if (savedSchoolAddress) {
                document.getElementById('schoolAddress').value = savedSchoolAddress;
            }
            
            // โหลดโหมดข้อมูล
            const savedDataMode = localStorage.getItem('dataMode');
            if (savedDataMode) {
                dataMode = savedDataMode;
                const radioButton = document.querySelector(`input[value="${savedDataMode}"]`);
                if (radioButton) {
                    radioButton.checked = true;
                }
            }
            
            // ตั้งค่าฟีเจอร์ต่างๆ
            setupDragAndDrop();           // ตั้งค่า Drag and Drop
            setupDeviceOrientation();     // ตั้งค่าการหมุนอุปกรณ์
            
            // แสดงหน้าหลักโดยไม่ต้องล็อกอิน (สำหรับผู้ใช้ทั่วไป)
            showMainApp(false);
            
            // จำลองจำนวนการค้นหาวันนี้ (ในระบบจริงจะดึงจากฐานข้อมูล)
            searchCount = Math.floor(Math.random() * 50) + 10;
            document.getElementById('todaySearches').textContent = searchCount;
            
            // ซ่อนคำแนะนำสำหรับผู้ใช้เก่า
            const isFirstVisit = !localStorage.getItem('hasVisited');
            if (!isFirstVisit) {
                document.getElementById('userGuide').style.display = 'none';
            } else {
                localStorage.setItem('hasVisited', 'true');
                
                // แสดงข้อความต้อนรับสำหรับผู้ใช้ใหม่
                setTimeout(() => {
                    showNotification('🎉 ยินดีต้อนรับสู่ระบบแผนที่โรงเรียนอัจฉริยะ! คลิกปุ่ม ? เพื่อดูคำแนะนำ', 'success');
                }, 1000);
            }
        }

        // =================== Event Listeners ===================
        
        // เริ่มต้นระบบเมื่อหน้าเว็บโหลดเสร็จ
        document.addEventListener('DOMContentLoaded', initializeSystem);
        
        // จัดการการปิดหน้าต่าง (บันทึกข้อมูลก่อนปิด)
        window.addEventListener('beforeunload', function(e) {
            saveDataToLocalStorage();
        });
        
        // จัดการการเปลี่ยนขนาดหน้าจอ
        window.addEventListener('resize', function() {
            // อัปเดตการแสดงผลเมื่อเปลี่ยนขนาดหน้าจอ
            updateCompass();
        });
        
        // ป้องกันการคลิกขวา (เสริม - สามารถเอาออกได้)
        // document.addEventListener('contextmenu', e => e.preventDefault());
        
        // จัดการปุ่มลัด (Keyboard Shortcuts)
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + K = โฟกัสที่ช่องค้นหา
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                document.getElementById('searchInput').focus();
            }
            
            // ESC = ปิด Modal ต่างๆ
            if (e.key === 'Escape') {
                closeImageModal();
                closeFullscreenMap();
            }
            
            // F11 = เปิด/ปิดแผนที่เต็มจอ
            if (e.key === 'F11') {
                e.preventDefault();
                const fullscreenModal = document.getElementById('fullscreenModal');
                if (fullscreenModal.classList.contains('active')) {
                    closeFullscreenMap();
                } else {
                    openFullscreenMap();
                }
            }
        });

        // =================== เสร็จสิ้นระบบ ===================
        
        // แสดงข้อความเสร็จสิ้นการโหลดใน Console
        console.log('🏫 ระบบแผนที่โรงเรียนอัจฉริยะ โหลดเสร็จสิ้น');
        console.log('📝 เวอร์ชัน: 14.0');
        console.log('👨‍💻 พัฒนาโดย: Claude AI');
        console.log('📅 วันที่อัปเดต:', new Date().toLocaleDateString('th-TH'));
        
        // สำหรับ Debug (สามารถเอาออกได้ในเวอร์ชันจริง)
        window.debugInfo = {
            roomData: roomData,
            userPosition: userPosition,
            searchCount: searchCount,
            dataMode: dataMode,
            viewMode: viewMode
        };
    </script>
</body>
</html>ติ
         