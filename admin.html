<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ v6 - Admin Interface</title>
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* =================== CSS Variables =================== */
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --dark-color: #343a40;
            
            --admin-bg: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --card-background: #ffffff;
            --text-primary: #333333;
            --text-secondary: #666666;
            --text-light: #ffffff;
            --border-color: #e0e6ff;
            
            --border-radius: 15px;
            --box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
            
            --sidebar-width: 280px;
            --header-height: 70px;
            --mobile-nav-height: 70px;
        }

        /* =================== Base Styles =================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--admin-bg);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* =================== Login Screen =================== */
        .login-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--admin-bg);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .login-card {
            background: var(--card-background);
            border-radius: var(--border-radius);
            padding: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 100%;
            margin: 20px;
            text-align: center;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .login-header {
            margin-bottom: 30px;
        }

        .login-logo {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .login-title {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .login-form {
            text-align: left;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .login-input {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
            background: var(--card-background);
        }

        .login-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .login-error {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
            padding: 12px;
            border-radius: var(--border-radius);
            margin-top: 15px;
            font-size: 14px;
            display: none;
        }

        .login-info {
            background: rgba(23, 162, 184, 0.1);
            color: var(--info-color);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-top: 20px;
            font-size: 13px;
        }

        /* =================== Layout =================== */
        .admin-container {
            display: flex;
            min-height: 100vh;
            padding-bottom: 0;
        }

        /* Desktop Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-right: 1px solid var(--border-color);
            position: fixed;
            height: 100vh;
            left: 0;
            top: 0;
            transition: var(--transition);
            z-index: 1000;
            overflow-y: auto;
        }

        .sidebar.collapsed {
            width: 70px;
        }

        /* Mobile Bottom Navigation */
        .mobile-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: var(--mobile-nav-height);
            background: rgba(255,255,255,0.95);
            border-top: 1px solid var(--border-color);
            display: none;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
        }

        .mobile-nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            padding: 8px 4px;
            color: var(--text-secondary);
            text-decoration: none;
        }

        .mobile-nav-item.active {
            color: var(--primary-color);
        }

        .mobile-nav-item:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .mobile-nav-item i {
            font-size: 18px;
            margin-bottom: 4px;
        }

        .mobile-nav-item span {
            font-size: 10px;
            font-weight: 600;
        }

        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
            min-height: 100vh;
        }

        .main-content.expanded {
            margin-left: 70px;
        }

        /* =================== Responsive Design =================== */
        @media (max-width: 768px) {
            .admin-container {
                padding-bottom: var(--mobile-nav-height);
            }
            
            .sidebar {
                transform: translateX(-100%);
                width: 100%;
            }
            
            .sidebar.show {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-nav {
                display: flex;
            }
            
            .form-row, .form-row-3 {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-content {
                margin: 10px;
                max-width: none;
            }
            
            .login-card {
                margin: 10px;
                padding: 30px 20px;
            }
        }

        /* =================== Sidebar =================== */
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            text-align: center;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--text-light);
        }

        .sidebar-header h2 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 12px;
            opacity: 0.9;
        }

        .sidebar-toggle {
            position: absolute;
            top: 20px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            transition: var(--transition);
        }

        .sidebar-toggle:hover {
            background: rgba(255,255,255,0.3);
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            cursor: pointer;
            transition: var(--transition);
            border-left: 4px solid transparent;
            color: var(--text-primary);
            text-decoration: none;
        }

        .menu-item:hover {
            background: rgba(102, 126, 234, 0.1);
            border-left-color: var(--primary-color);
        }

        .menu-item.active {
            background: rgba(102, 126, 234, 0.15);
            border-left-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: 600;
        }

        .menu-item i {
            width: 20px;
            margin-right: 15px;
            font-size: 16px;
        }

        .menu-text {
            transition: var(--transition);
        }

        .sidebar.collapsed .menu-text {
            opacity: 0;
            width: 0;
        }

        /* =================== Header =================== */
        .main-header {
            height: var(--header-height);
            background: var(--card-background);
            box-shadow: var(--box-shadow);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .header-btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-btn.primary {
            background: var(--primary-color);
            color: white;
        }

        .header-btn.secondary {
            background: var(--card-background);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .header-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow);
        }

        .logout-btn {
            background: var(--danger-color);
            color: white;
        }

        /* =================== Content Area =================== */
        .content-area {
            padding: 30px;
            min-height: calc(100vh - var(--header-height));
        }

        .page-section {
            display: none;
            animation: fadeInUp 0.4s ease-out;
        }

        .page-section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* =================== Cards =================== */
        .admin-card {
            background: var(--card-background);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-bottom: 25px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* =================== Forms =================== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 14px;
            transition: var(--transition);
            background: var(--card-background);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        /* =================== Buttons =================== */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            text-align: center;
            justify-content: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow);
        }

        .btn-primary { background: var(--primary-color); color: white; }
        .btn-success { background: var(--accent-color); color: white; }
        .btn-danger { background: var(--danger-color); color: white; }
        .btn-warning { background: var(--warning-color); color: var(--dark-color); }
        .btn-info { background: var(--info-color); color: white; }
        .btn-secondary { 
            background: var(--card-background); 
            color: var(--text-primary); 
            border: 2px solid var(--border-color); 
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
        }

        /* =================== Tables =================== */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--card-background);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
        }

        .data-table th {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            font-size: 13px;
        }

        .data-table tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        /* =================== Version Switch =================== */
        .version-switch {
            background: linear-gradient(135deg, #f8f9ff, #e6f3ff);
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            border: 2px solid var(--border-color);
        }

        .switch-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .switch-option {
            flex: 1;
            text-align: center;
            padding: 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid var(--border-color);
            background: var(--card-background);
        }

        .switch-option.active {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary-color);
        }

        .switch-option:hover {
            transform: translateY(-3px);
            box-shadow: var(--box-shadow);
        }

        .switch-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .switch-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .switch-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* =================== Stats Cards =================== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-background);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 32px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* =================== Modal =================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }

        .modal-content {
            background: var(--card-background);
            border-radius: var(--border-radius);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .modal-header {
            padding: 25px;
            border-bottom: 2px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }

        .modal-body {
            padding: 25px;
        }

        .modal-footer {
            padding: 20px 25px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        /* =================== Status Indicators =================== */
        .status-indicator {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: rgba(40, 167, 69, 0.1);
            color: var(--accent-color);
        }

        .status-inactive {
            background: rgba(108, 117, 125, 0.1);
            color: #6c757d;
        }

        .status-connected {
            background: rgba(23, 162, 184, 0.1);
            color: var(--info-color);
        }

        .status-error {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }

        /* =================== Image Upload =================== */
        .image-upload-container {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            margin-bottom: 15px;
            transition: var(--transition);
            cursor: pointer;
        }

        .image-upload-container:hover {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.05);
        }

        .image-upload-container.dragover {
            border-color: var(--primary-color);
            background: rgba(102, 126, 234, 0.1);
        }

        .uploaded-images {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .uploaded-image {
            position: relative;
            width: 100px;
            height: 80px;
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 2px solid var(--border-color);
        }

        .uploaded-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            cursor: pointer;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* =================== Interactive Map =================== */
        .position-map {
            width: 100%;
            height: 250px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            position: relative;
            background: #f8f9ff;
            cursor: crosshair;
            overflow: hidden;
        }

        .position-marker {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--danger-color);
            border: 3px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 10;
        }

        .position-info {
            background: rgba(102, 126, 234, 0.1);
            padding: 10px;
            border-radius: var(--border-radius);
            margin-top: 10px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* =================== Google Sheets Integration =================== */
        .sheets-config {
            background: linear-gradient(135deg, #e8f5e8, #d4edda);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--accent-color);
            margin-bottom: 25px;
        }

        .setup-guide {
            background: var(--card-background);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            border-left: 4px solid var(--info-color);
        }

        .setup-step {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: var(--border-radius);
        }

        .setup-step h5 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 14px;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 10px 0;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-dot.connected { background: var(--accent-color); }
        .status-dot.disconnected { background: var(--danger-color); }
        .status-dot.loading { background: var(--warning-color); }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* =================== Loading States =================== */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* =================== Utility Classes =================== */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mb-20 { margin-bottom: 20px; }
        .mt-20 { margin-top: 20px; }
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-between { justify-content: space-between; }
        .flex-center { justify-content: center; align-items: center; }
        .gap-10 { gap: 10px; }
        .gap-15 { gap: 15px; }
        .gap-20 { gap: 20px; }

        /* =================== Notification =================== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 600;
            box-shadow: var(--box-shadow);
            z-index: 3000;
            opacity: 0;
            transform: translateX(350px);
            transition: var(--transition);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.success { background: var(--accent-color); }
        .notification.error { background: var(--danger-color); }
        .notification.warning { background: var(--warning-color); color: var(--dark-color); }
        .notification.info { background: var(--info-color); }

        /* =================== Deployment Guide Section =================== */
        .deployment-guide {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--warning-color);
            margin-bottom: 25px;
        }

        .guide-step {
            background: var(--card-background);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            border-left: 4px solid var(--warning-color);
        }

        .guide-step h4 {
            color: var(--warning-color);
            margin-bottom: 10px;
            font-size: 16px;
        }

        .guide-step pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 13px;
            border: 1px solid #dee2e6;
            margin: 10px 0;
        }

        .guide-step code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 13px;
            color: #e83e8c;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginContainer">
        <div class="login-card">
            <div class="login-header">
                <div class="login-logo">üîê</div>
                <h2 class="login-title">Admin Panel Login</h2>
                <p class="login-subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ v6</p>
            </div>
            
            <form class="login-form" onsubmit="handleLogin(event)">
                <div class="login-form-group">
                    <label class="login-label">Username</label>
                    <input type="text" class="login-input" id="loginUsername" placeholder="‡∏Å‡∏£‡∏≠‡∏Å username" required>
                </div>
                
                <div class="login-form-group">
                    <label class="login-label">Password</label>
                    <input type="password" class="login-input" id="loginPassword" placeholder="‡∏Å‡∏£‡∏≠‡∏Å password" required>
                </div>
                
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>
                
                <div class="login-error" id="loginError"></div>
                
                <div class="login-info">
                    <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö:</strong><br>
                    Username: <code>admin</code><br>
                    Password: <code>1234</code>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Admin Interface -->
    <div class="admin-container" id="adminContainer" style="display: none;">
        <!-- Desktop Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <button class="sidebar-toggle" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <h2>üè´ Admin Panel</h2>
                <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô v6</p>
            </div>
            
            <div class="sidebar-menu">
                <div class="menu-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="menu-text">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</span>
                </div>
                <div class="menu-item" onclick="showSection('version')">
                    <i class="fas fa-code-branch"></i>
                    <span class="menu-text">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô</span>
                </div>
                <div class="menu-item" onclick="showSection('buildings')">
                    <i class="fas fa-building"></i>
                    <span class="menu-text">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</span>
                </div>
                <div class="menu-item" onclick="showSection('rooms')">
                    <i class="fas fa-door-open"></i>
                    <span class="menu-text">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á</span>
                </div>
                <div class="menu-item" onclick="showSection('deployment')">
                    <i class="fas fa-rocket"></i>
                    <span class="menu-text">‡∏ß‡∏¥‡∏ò‡∏µ Deploy</span>
                </div>
                <div class="menu-item" onclick="showSection('sheets')">
                    <i class="fas fa-table"></i>
                    <span class="menu-text">Google Sheets</span>
                </div>
                <div class="menu-item" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i>
                    <span class="menu-text">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</span>
                </div>
                <div class="menu-item" onclick="openUserInterface()">
                    <i class="fas fa-external-link-alt"></i>
                    <span class="menu-text">‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</span>
                </div>
            </div>
        </div>

        <!-- Mobile Bottom Navigation -->
        <div class="mobile-nav" id="mobileNav">
            <div class="mobile-nav-item active" onclick="showSection('dashboard')">
                <i class="fas fa-tachometer-alt"></i>
                <span>‡πÅ‡∏î‡∏ä</span>
            </div>
            <div class="mobile-nav-item" onclick="showSection('buildings')">
                <i class="fas fa-building"></i>
                <span>‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</span>
            </div>
            <div class="mobile-nav-item" onclick="showSection('rooms')">
                <i class="fas fa-door-open"></i>
                <span>‡∏´‡πâ‡∏≠‡∏á</span>
            </div>
            <div class="mobile-nav-item" onclick="showSection('deployment')">
                <i class="fas fa-rocket"></i>
                <span>Deploy</span>
            </div>
            <div class="mobile-nav-item" onclick="showSection('settings')">
                <i class="fas fa-cog"></i>
                <span>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <!-- Header -->
            <div class="main-header">
                <h1 class="header-title" id="pageTitle">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h1>
                <div class="header-actions">
                    <button class="header-btn secondary" onclick="exportData()">
                        <i class="fas fa-download"></i>
                        <span>Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                    </button>
                    <button class="header-btn primary" onclick="syncData()">
                        <i class="fas fa-sync-alt"></i>
                        <span>Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                    </button>
                    <button class="header-btn logout-btn" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </button>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- ======================== Dashboard Section ======================== -->
                <div class="page-section active" id="dashboard-section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üè¢</div>
                            <div class="stat-number" id="buildingCount">5</div>
                            <div class="stat-label">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üö™</div>
                            <div class="stat-number" id="roomCount">42</div>
                            <div class="stat-label">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-number" id="activeRooms">38</div>
                            <div class="stat-label">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üîó</div>
                            <div class="stat-number" id="sheetStatus">Connected</div>
                            <div class="stat-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Google Sheets</div>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-chart-line"></i>
                                ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
                            </h3>
                        </div>
                        <div style="text-align: center; padding: 40px;">
                            <i class="fas fa-chart-bar" style="font-size: 64px; color: var(--primary-color); opacity: 0.3; margin-bottom: 20px;"></i>
                            <p style="color: var(--text-secondary);">‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                        </div>
                    </div>
                    <input type="hidden" id="roomX" value="">
                    <input type="hidden" id="roomY" value="">
                </div>

                <!-- ======================== Version Management Section ======================== -->
                <div class="page-section" id="version-section">
                    <div class="version-switch">
                        <h3 style="text-align: center; margin-bottom: 10px; color: var(--primary-color);">
                            <i class="fas fa-code-branch"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
                        </h3>
                        <p style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">
                            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Demo Version ‡∏´‡∏£‡∏∑‡∏≠ Live Version
                        </p>
                        
                        <div class="switch-container">
                            <div class="switch-option active" onclick="setVersion('demo')" id="demoOption">
                                <div class="switch-icon">üéÆ</div>
                                <div class="switch-title">Demo Version</div>
                                <div class="switch-desc">‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</div>
                            </div>
                            <div class="switch-option" onclick="setVersion('live')" id="liveOption">
                                <div class="switch-icon">üî¥</div>
                                <div class="switch-title">Live Version</div>
                                <div class="switch-desc">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏∞‡∏ö‡∏ö</div>
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <span class="status-indicator status-connected" id="versionStatus">
                                <i class="fas fa-play"></i> Demo Mode ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                            </span>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-info-circle"></i>
                                ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô
                            </h3>
                        </div>
                        <div id="versionDetails">
                            <div style="background: #f8f9ff; padding: 20px; border-radius: var(--border-radius); border-left: 4px solid var(--primary-color);">
                                <h4 style="color: var(--primary-color); margin-bottom: 10px;">üéÆ Demo Version</h4>
                                <ul style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                    <li>‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</li>
                                    <li>‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</li>
                                    <li>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö</li>
                                    <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏≤‡∏ß‡∏£</li>
                                    <li>‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ Demo</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ======================== Buildings Management Section ======================== -->
                <div class="page-section" id="buildings-section">
                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-building"></i>
                                ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£
                            </h3>
                            <button class="btn btn-primary" onclick="openBuildingModal()">
                                <i class="fas fa-plus"></i>
                                ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà
                            </button>
                        </div>
                        <div style="overflow-x: auto;">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</th>
                                        <th>‡∏ä‡∏∑‡πà‡∏≠‡πà‡∏≤‡∏Ñ‡∏≤‡∏£</th>
                                        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏±‡πâ‡∏ô</th>
                                        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡πâ‡∏≠‡∏á</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="buildingsTableBody">
                                    <!-- Data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ======================== Rooms Management Section ======================== -->
                <div class="page-section" id="rooms-section">
                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-door-open"></i>
                                ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á
                            </h3>
                            <button class="btn btn-primary" onclick="openRoomModal()">
                                <i class="fas fa-plus"></i>
                                ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
                            </button>
                        </div>
                        <div style="overflow-x: auto;">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á</th>
                                        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á</th>
                                        <th>‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</th>
                                        <th>‡∏ä‡∏±‡πâ‡∏ô</th>
                                        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                                        <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                    </tr>
                                </thead>
                                <tbody id="roomsTableBody">
                                    <!-- Data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ======================== Deployment Guide Section ======================== -->
                <div class="page-section" id="deployment-section">
                    <div class="deployment-guide">
                        <h3 style="text-align: center; margin-bottom: 10px; color: var(--warning-color);">
                            <i class="fas fa-rocket"></i> ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ Deploy ‡∏£‡∏∞‡∏ö‡∏ö
                        </h3>
                        <p style="text-align: center; color: var(--text-secondary); margin-bottom: 20px;">
                            ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ö‡∏ô GitHub Pages
                        </p>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-file-download"></i>
                                ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå
                            </h3>
                        </div>
                        
                        <div class="guide-step">
                            <h4><i class="fas fa-step-forward"></i> ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå</h4>
                            <p style="margin-bottom: 15px;">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
                            <pre>school_map_system_v6.html ‚Üí index.html
school_map_system_admin_v6.html ‚Üí admin.html</pre>
                            <p style="color: var(--danger-color); font-weight: 600; margin-top: 10px;">
                                <i class="fas fa-exclamation-triangle"></i> ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ GitHub Pages ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
                            </p>
                        </div>

                        <div class="guide-step">
                            <h4><i class="fas fa-step-forward"></i> ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Repository ‡∏ö‡∏ô GitHub</h4>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà GitHub ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á Repository ‡πÉ‡∏´‡∏°‡πà</li>
                                <li>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ Repository ‡πÄ‡∏ä‡πà‡∏ô <code>school-map-system</code></li>
                                <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Public Repository</li>
                                <li>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå <code>index.html</code> ‡πÅ‡∏•‡∏∞ <code>admin.html</code></li>
                            </ul>
                        </div>

                        <div class="guide-step">
                            <h4><i class="fas fa-step-forward"></i> ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô GitHub Pages</h4>
                            <ol style="margin-left: 20px; line-height: 1.8;">
                                <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà Settings ‡∏Ç‡∏≠‡∏á Repository</li>
                                <li>‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡πÑ‡∏õ‡∏´‡∏≤ "Pages" ‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏ã‡πâ‡∏≤‡∏¢</li>
                                <li>‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô Source ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Deploy from a branch"</li>
                                <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Branch: <code>main</code> ‡πÅ‡∏•‡∏∞ Folder: <code>/ (root)</code></li>
                                <li>‡∏Ñ‡∏•‡∏¥‡∏Å Save</li>
                            </ol>
                        </div>

                        <div class="guide-step">
                            <h4><i class="fas fa-step-forward"></i> ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î</h4>
                            <p style="margin-bottom: 15px;">‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å Deploy ‡πÅ‡∏•‡πâ‡∏ß ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç URL ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ:</p>
                            
                            <p><strong>‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå index.html ‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î:</strong></p>
                            <pre>function openAdminInterface() {
    window.open('school_map_system_admin_v6.html', '_blank');
}</pre>
                            
                            <p><strong>‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô:</strong></p>
                            <pre>function openAdminInterface() {
    window.open('https://[USERNAME].github.io/[REPO]/admin.html', '_blank');
}</pre>
                            
                            <p><strong>‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå admin.html ‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î:</strong></p>
                            <pre>function openUserInterface() {
    window.open('school_map_system_v6.html', '_blank');
}</pre>
                            
                            <p><strong>‡πÅ‡∏Å‡πâ‡πÄ‡∏õ‡πá‡∏ô:</strong></p>
                            <pre>function openUserInterface() {
    window.open('https://[USERNAME].github.io/[REPO]/index.html', '_blank');
}</pre>
                            
                            <p style="color: var(--info-color); margin-top: 10px;">
                                <i class="fas fa-info-circle"></i> ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà [USERNAME] ‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ GitHub ‡πÅ‡∏•‡∏∞ [REPO] ‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏∑‡πà‡∏≠ Repository
                            </p>
                        </div>

                        <div class="guide-step">
                            <h4><i class="fas fa-step-forward"></i> ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö</h4>
                            <ul style="margin-left: 20px; line-height: 1.8;">
                                <li>‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô URL: <code>https://[USERNAME].github.io/[REPO]/</code></li>
                                <li>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</li>
                                <li>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á</li>
                                <li>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà Admin Panel (admin/1234)</li>
                                <li>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</li>
                            </ul>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-tools"></i>
                                ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
                            </h3>
                        </div>
                        
                        <div style="background: #d1ecf1; padding: 20px; border-radius: var(--border-radius); border-left: 4px solid var(--info-color); margin-bottom: 20px;">
                            <h4 style="color: var(--info-color); margin-bottom: 10px;">üìã ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h4>
                            <ul style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                <li>‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: Chrome, Firefox, Safari, Edge (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</li>
                                <li>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏ö‡∏ô‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠</li>
                                <li>‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Server ‡∏´‡∏£‡∏∑‡∏≠ Database</li>
                                <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô localStorage ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå</li>
                            </ul>
                        </div>

                        <div style="background: #d4edda; padding: 20px; border-radius: var(--border-radius); border-left: 4px solid var(--accent-color);">
                            <h4 style="color: var(--accent-color); margin-bottom: 10px;">üí° ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h4>
                            <ul style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                <li>‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ú‡πà‡∏≤‡∏ô‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå Export ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</li>
                                <li>‡πÉ‡∏ä‡πâ Google Sheets ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Live Mode ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô</li>
                                <li>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏à‡∏£‡∏¥‡∏á</li>
                                <li>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- ======================== Google Sheets Section ======================== -->
                <div class="page-section" id="sheets-section">
                    <div class="sheets-config">
                        <div class="connection-status">
                            <div class="status-dot disconnected" id="connectionDot"></div>
                            <h3 style="color: var(--text-primary); margin: 0;">
                                <i class="fas fa-table"></i>
                                Google Sheets Integration
                            </h3>
                            <span class="status-indicator status-error" id="connectionStatus">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
                        </div>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
                        </p>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-rocket"></i>
                                ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets ‡πÅ‡∏ö‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå
                            </h3>
                        </div>
                        
                        <div class="setup-guide">
                            <h4 style="color: var(--info-color); margin-bottom: 15px;">
                                <i class="fas fa-list-ol"></i> ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ Setup (5 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô)
                            </h4>
                            
                            <div class="setup-step">
                                <h5>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏™‡∏£‡πâ‡∏≤‡∏á Google Sheets</h5>
                                <p style="margin-bottom: 10px;">1. ‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheets ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà</p>
                                <p style="margin-bottom: 10px;">2. ‡∏™‡∏£‡πâ‡∏≤‡∏á 2 ‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô: <strong>Buildings</strong> ‡πÅ‡∏•‡∏∞ <strong>Rooms</strong></p>
                                
                                <p style="color: var(--primary-color); font-weight: 600; margin: 15px 0 10px 0;">üìã ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet "Buildings":</p>
                                <div class="code-block">code | name | floors | year | description | rooms | status | created | updated</div>
                                
                                <p style="color: var(--primary-color); font-weight: 600; margin: 15px 0 10px 0;">üìã ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Sheet "Rooms":</p>
                                <div class="code-block">code | name | building | floor | type | description | status | x | y | images | created | updated</div>
                            </div>
                            
                            <div class="setup-step">
                                <h5>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏õ‡∏¥‡∏î Google Apps Script</h5>
                                <p style="margin-bottom: 10px;">1. ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Google Sheets ‡πÑ‡∏õ‡∏ó‡∏µ‡πà <strong>‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢ ‚Üí Apps Script</strong></p>
                                <p style="margin-bottom: 10px;">2. ‡∏•‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏Å‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á:</p>
                                
                                <div class="code-block">function doGet(e) {
  return handleRequest(e);
}

function doPost(e) {
  return handleRequest(e);
}

function handleRequest(e) {
  const action = e.parameter.action;
  const sheetName = e.parameter.sheet || 'Buildings';
  
  try {
    switch(action) {
      case 'getData':
        return getData(sheetName);
      case 'addData':
        return addData(sheetName, e.parameter);
      case 'updateData':
        return updateData(sheetName, e.parameter);
      case 'deleteData':
        return deleteData(sheetName, e.parameter.id);
      default:
        return ContentService.createTextOutput(JSON.stringify({
          success: false,
          error: 'Invalid action'
        })).setMimeType(ContentService.MimeType.JSON);
    }
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({
      success: false,
      error: error.toString()
    })).setMimeType(ContentService.MimeType.JSON);
  }
}

function getData(sheetName) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  const data = sheet.getDataRange().getValues();
  const headers = data[0];
  const rows = data.slice(1);
  
  const result = rows.map(row => {
    const obj = {};
    headers.forEach((header, index) => {
      obj[header] = row[index];
    });
    return obj;
  });
  
  return ContentService.createTextOutput(JSON.stringify({
    success: true,
    data: result
  })).setMimeType(ContentService.MimeType.JSON);
}

function addData(sheetName, params) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
  
  const row = headers.map(header => params[header] || '');
  sheet.appendRow(row);
  
  return ContentService.createTextOutput(JSON.stringify({
    success: true,
    message: 'Data added successfully'
  })).setMimeType(ContentService.MimeType.JSON);
}

function updateData(sheetName, params) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  const data = sheet.getDataRange().getValues();
  const headers = data[0];
  const codeIndex = headers.indexOf('code');
  
  for (let i = 1; i < data.length; i++) {
    if (data[i][codeIndex] === params.code) {
      headers.forEach((header, index) => {
        if (params[header] !== undefined) {
          sheet.getRange(i + 1, index + 1).setValue(params[header]);
        }
      });
      break;
    }
  }
  
  return ContentService.createTextOutput(JSON.stringify({
    success: true,
    message: 'Data updated successfully'
  })).setMimeType(ContentService.MimeType.JSON);
}

function deleteData(sheetName, id) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(sheetName);
  const data = sheet.getDataRange().getValues();
  const headers = data[0];
  const codeIndex = headers.indexOf('code');
  
  for (let i = 1; i < data.length; i++) {
    if (data[i][codeIndex] === id) {
      sheet.deleteRow(i + 1);
      break;
    }
  }
  
  return ContentService.createTextOutput(JSON.stringify({
    success: true,
    message: 'Data deleted successfully'
  })).setMimeType(ContentService.MimeType.JSON);
}</div>
                            </div>
                            
                            <div class="setup-step">
                                <h5>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: Deploy Web App</h5>
                                <p style="margin-bottom: 10px;">1. ‡∏Ñ‡∏•‡∏¥‡∏Å <strong>Deploy ‚Üí New deployment</strong></p>
                                <p style="margin-bottom: 10px;">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Type: <strong>Web app</strong></p>
                                <p style="margin-bottom: 10px;">3. Execute as: <strong>Me</strong></p>
                                <p style="margin-bottom: 10px;">4. Who has access: <strong>Anyone</strong></p>
                                <p style="margin-bottom: 10px;">5. ‡∏Ñ‡∏•‡∏¥‡∏Å <strong>Deploy</strong> ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å <strong>Web app URL</strong></p>
                            </div>
                            
                            <div class="setup-step">
                                <h5>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡πÉ‡∏™‡πà URL ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Admin</h5>
                                <p style="margin-bottom: 10px;">‡∏ô‡∏≥ Web app URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á "Google Sheets URL" ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p>
                                <p style="color: var(--warning-color); font-size: 12px;">
                                    <i class="fas fa-exclamation-triangle"></i> 
                                    URL ‡∏à‡∏∞‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞: https://script.google.com/macros/s/[ID]/exec
                                </p>
                            </div>
                            
                            <div class="setup-step">
                                <h5>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</h5>
                                <p style="margin-bottom: 10px;">1. ‡πÉ‡∏™‡πà URL ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠"</p>
                                <p style="margin-bottom: 10px;">2. ‡∏´‡∏≤‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</p>
                                <p style="color: var(--accent-color); font-size: 12px;">
                                    <i class="fas fa-check-circle"></i> 
                                    ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÉ‡∏ô Google Sheets ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-cog"></i>
                                ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets
                            </h3>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Google Sheets Web App URL *</label>
                            <input type="url" class="form-input" id="sheetsUrl" 
                                   placeholder="https://script.google.com/macros/s/[YOUR_SCRIPT_ID]/exec">
                            <p style="font-size: 12px; color: var(--text-secondary); margin-top: 5px;">
                                <i class="fas fa-info-circle"></i> 
                                URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£ Deploy Web App ‡πÉ‡∏ô Google Apps Script
                            </p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Sheet Name (Buildings)</label>
                                <input type="text" class="form-input" id="buildingsSheetName" 
                                       value="Buildings" placeholder="Buildings">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Sheet Name (Rooms)</label>
                                <input type="text" class="form-input" id="roomsSheetName" 
                                       value="Rooms" placeholder="Rooms">
                            </div>
                        </div>
                        
                        <div class="flex gap-10">
                            <button class="btn btn-primary" onclick="testConnection()">
                                <i class="fas fa-plug"></i>
                                ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                            </button>
                            <button class="btn btn-success" onclick="saveSheetConfig()">
                                <i class="fas fa-save"></i>
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                            </button>
                            <button class="btn btn-info" onclick="syncSheetData()">
                                <i class="fas fa-sync-alt"></i>
                                ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-history"></i>
                                ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </h3>
                        </div>
                        <div id="syncHistory">
                            <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                                <i class="fas fa-clock" style="font-size: 48px; opacity: 0.3; margin-bottom: 15px;"></i>
                                <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ======================== Settings Section ======================== -->
                <div class="page-section" id="settings-section">
                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-cog"></i>
                                ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
                            </h3>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                                <input type="text" class="form-input" id="schoolName" 
                                       value="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞">
                            </div>
                            <div class="form-group">
                                <label class="form-label">‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label>
                                <select class="form-input" id="defaultLanguage">
                                    <option value="th">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</option>
                                    <option value="en">English</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</label>
                            <textarea class="form-input" id="welcomeMessage" rows="3" 
                                      placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö..."></textarea>
                        </div>

                        <div class="flex gap-10">
                            <button class="btn btn-primary" onclick="saveSettings()">
                                <i class="fas fa-save"></i>
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                            </button>
                            <button class="btn btn-secondary" onclick="resetSettings()">
                                <i class="fas fa-undo"></i>
                                ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                            </button>
                        </div>
                    </div>

                    <div class="admin-card">
                        <div class="card-header">
                            <h3 class="card-title">
                                <i class="fas fa-database"></i>
                                ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </h3>
                        </div>
                        
                        <div class="flex gap-10 mb-20">
                            <button class="btn btn-info" onclick="backupData()">
                                <i class="fas fa-download"></i>
                                ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                            <button class="btn btn-warning" onclick="clearDemoData()">
                                <i class="fas fa-trash-alt"></i>
                                ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Demo
                            </button>
                            <button class="btn btn-danger" onclick="resetSystem()">
                                <i class="fas fa-power-off"></i>
                                ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö
                            </button>
                        </div>
                        
                        <div style="background: #fff3cd; padding: 15px; border-radius: var(--border-radius); color: #856404;">
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong>‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</strong> ‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ======================== Building Modal ======================== -->
    <div class="modal-overlay" id="buildingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="buildingModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</h3>
                <button class="modal-close" onclick="closeBuildingModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ *</label>
                    <input type="text" class="form-input" id="buildingCode" placeholder="‡πÄ‡∏ä‡πà‡∏ô B001">
                </div>
                
                <div class="form-group">
                    <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ *</label>
                    <input type="text" class="form-input" id="buildingName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 1">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏±‡πâ‡∏ô</label>
                        <input type="number" class="form-input" id="buildingFloors" placeholder="3" min="1" max="20">
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á</label>
                        <input type="number" class="form-input" id="buildingYear" placeholder="2020" min="1900" max="2030">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea class="form-input" id="buildingDescription" rows="3" 
                              placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeBuildingModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" onclick="saveBuildingData()">
                    <i class="fas fa-save"></i>
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                </button>
            </div>
        </div>
    </div>

    <!-- ======================== Room Modal ======================== -->
    <div class="modal-overlay" id="roomModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="roomModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</h3>
                <button class="modal-close" onclick="closeRoomModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á *</label>
                        <input type="text" class="form-input" id="roomCode" placeholder="‡πÄ‡∏ä‡πà‡∏ô R001">
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á *</label>
                        <input type="text" class="form-input" id="roomName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.1/1">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ *</label>
                        <select class="form-input" id="roomBuilding">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡∏ä‡∏±‡πâ‡∏ô</label>
                        <input type="number" class="form-input" id="roomFloor" placeholder="1" min="1" max="20">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà</label>
                        <div class="position-map" id="positionMap" onclick="selectPosition(event)">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--text-secondary); font-size: 14px; pointer-events: none;">
                                ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡πâ‡∏≠‡∏á
                            </div>
                            <div class="position-marker" id="positionMarker" style="display: none;"></div>
                        </div>
                        <div class="position-info" id="positionInfo">
                            <i class="fas fa-info-circle"></i> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡πâ‡∏≠‡∏á (X: -, Y: -)
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡πâ‡∏≠‡∏á</label>
                    <div class="image-upload-container" id="imageUploadContainer" 
                         onclick="document.getElementById('roomImages').click()"
                         ondrop="handleImageDrop(event)" 
                         ondragover="handleImageDragOver(event)"
                         ondragleave="handleImageDragLeave(event)">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 32px; color: var(--primary-color); margin-bottom: 10px;"></i>
                        <p>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                        <p style="font-size: 12px; color: var(--text-secondary);">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5MB ‡∏ï‡πà‡∏≠‡∏£‡∏π‡∏õ)</p>
                    </div>
                    <input type="file" id="roomImages" multiple accept="image/*" style="display: none;" onchange="handleImageSelect(event)">
                    <div class="uploaded-images" id="uploadedImages"></div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á</label>
                    <select class="form-input" id="roomType">
                        <option value="classroom">‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</option>
                        <option value="computer">‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</option>
                        <option value="lab">‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£</option>
                        <option value="library">‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î</option>
                        <option value="office">‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>
                        <option value="facility">‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea class="form-input" id="roomDescription" rows="3" 
                              placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡πâ‡∏≠‡∏á..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
                    <select class="form-input" id="roomStatus">
                        <option value="active">‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                        <option value="inactive">‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</option>
                        <option value="maintenance">‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeRoomModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn btn-primary" onclick="saveRoomData()">
                    <i class="fas fa-save"></i>
                    ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // =================== Global Variables ===================
        let currentVersion = 'demo';
        let buildingsData = {};
        let roomsData = {};
        let sheetsConfig = {
            url: '',
            buildingsSheet: 'Buildings',
            roomsSheet: 'Rooms',
            connected: false
        };
        let editingBuilding = null;
        let editingRoom = null;
        let isLoggedIn = false;

        // =================== Login System ===================
        
        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const errorDiv = document.getElementById('loginError');
            
            // Simple authentication
            if (username === 'admin' && password === '1234') {
                isLoggedIn = true;
                sessionStorage.setItem('adminLoggedIn', 'true');
                
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminContainer').style.display = 'flex';
                
                initializeAdmin();
                showNotification('üéâ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
            } else {
                errorDiv.style.display = 'block';
                errorDiv.textContent = '‚ùå Username ‡∏´‡∏£‡∏∑‡∏≠ Password ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                
                // Clear error after 3 seconds
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 3000);
            }
        }

        function handleLogout() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                isLoggedIn = false;
                sessionStorage.removeItem('adminLoggedIn');
                
                document.getElementById('adminContainer').style.display = 'none';
                document.getElementById('loginContainer').style.display = 'flex';
                
                // Clear form
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                
                showNotification('üëã ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'info');
            }
        }

        function checkLoginStatus() {
            const loggedIn = sessionStorage.getItem('adminLoggedIn');
            if (loggedIn === 'true') {
                isLoggedIn = true;
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminContainer').style.display = 'flex';
                return true;
            }
            return false;
        }

        // =================== Sample Data ===================
        const sampleBuildings = {
            'B001': {
                code: 'B001',
                name: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 1',
                floors: 3,
                year: 2015,
                description: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥',
                rooms: 15,
                status: 'active',
                created: '2024-01-15',
                updated: '2024-08-01'
            },
            'B002': {
                code: 'B002',
                name: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô 2',
                floors: 4,
                year: 2018,
                description: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£',
                rooms: 20,
                status: 'active',
                created: '2024-01-15',
                updated: '2024-08-01'
            },
            'B003': {
                code: 'B003',
                name: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
                floors: 2,
                year: 2010,
                description: '‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£',
                rooms: 8,
                status: 'active',
                created: '2024-01-15',
                updated: '2024-08-01'
            }
        };

        const sampleRooms = {
            'R001': {
                code: 'R001',
                name: '‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.1/1',
                building: 'B001',
                floor: 1,
                type: 'classroom',
                description: '‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1',
                status: 'active',
                x: 20,
                y: 30,
                images: [],
                created: '2024-01-15',
                updated: '2024-08-01'
            },
            'R002': {
                code: 'R002',
                name: '‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°.1/2',
                building: 'B001',
                floor: 1,
                type: 'classroom',
                description: '‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1',
                status: 'active',
                x: 45,
                y: 30,
                images: [],
                created: '2024-01-15',
                updated: '2024-08-01'
            },
            'C001': {
                code: 'C001',
                name: '‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 1',
                building: 'B002',
                floor: 2,
                type: 'computer',
                description: '‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå 30 ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á',
                status: 'active',
                x: 25,
                y: 65,
                images: [],
                created: '2024-01-15',
                updated: '2024-08-01'
            },
            'L001': {
                code: 'L001',
                name: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î‡∏´‡∏•‡∏±‡∏Å',
                building: 'B002',
                floor: 1,
                type: 'library',
                description: '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏°‡∏µ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 15,000 ‡πÄ‡∏•‡πà‡∏°',
                status: 'active',
                x: 80,
                y: 70,
                images: [],
                created: '2024-01-15',
                updated: '2024-08-01'
            }
        };

        // =================== Utility Functions ===================
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            if (!notification) return;
            
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('th-TH', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // =================== Navigation Functions ===================
        
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            
            if (window.innerWidth > 768) {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
            }
        }

        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.page-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all menu items (both desktop and mobile)
            document.querySelectorAll('.menu-item, .mobile-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show target section
            const targetSection = document.getElementById(sectionId + '-section');
            if (targetSection) {
                targetSection.classList.add('active');
            }
            
            // Add active class to clicked menu item
            if (event && event.target) {
                const clickedItem = event.target.closest('.menu-item') || event.target.closest('.mobile-nav-item');
                if (clickedItem) {
                    clickedItem.classList.add('active');
                }
            }
            
            // Update page title
            const titles = {
                'dashboard': '‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î',
                'version': '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô',
                'buildings': '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£',
                'rooms': '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á',
                'deployment': '‡∏ß‡∏¥‡∏ò‡∏µ Deploy',
                'sheets': 'Google Sheets',
                'settings': '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö'
            };
            
            const pageTitle = document.getElementById('pageTitle');
            if (pageTitle && titles[sectionId]) {
                pageTitle.textContent = titles[sectionId];
            }
            
            // Close mobile sidebar if open
            if (window.innerWidth <= 768) {
                const sidebar = document.getElementById('sidebar');
                if (sidebar) {
                    sidebar.classList.remove('show');
                }
            }
            
            // Load data based on section
            switch(sectionId) {
                case 'dashboard':
                    updateDashboardStats();
                    break;
                case 'buildings':
                    loadBuildingsTable();
                    break;
                case 'rooms':
                    loadRoomsTable();
                    populateRoomBuildingSelect();
                    break;
                case 'sheets':
                    updateSheetsStatus();
                    break;
            }
        }

        function openUserInterface() {
            showNotification('üöÄ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ...', 'info');
            // ‡∏´‡∏•‡∏±‡∏á Deploy ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ URL ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô GitHub Pages URL
            setTimeout(() => {
                window.open('school_map_system_v6.html', '_blank');
                showNotification('‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà', 'success');
            }, 1000);
        }

        // =================== Version Management ===================
        
        function setVersion(version) {
            currentVersion = version;
            localStorage.setItem('systemVersion', version);
            
            // Update UI
            document.querySelectorAll('.switch-option').forEach(option => {
                option.classList.remove('active');
            });
            
            const targetOption = document.getElementById(version + 'Option');
            if (targetOption) {
                targetOption.classList.add('active');
            }
            
            // Update status
            const versionStatus = document.getElementById('versionStatus');
            const versionDetails = document.getElementById('versionDetails');
            
            if (version === 'demo') {
                if (versionStatus) {
                    versionStatus.innerHTML = '<i class="fas fa-play"></i> Demo Mode ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                    versionStatus.className = 'status-indicator status-connected';
                }
                
                if (versionDetails) {
                    versionDetails.innerHTML = `
                        <div style="background: #f8f9ff; padding: 20px; border-radius: var(--border-radius); border-left: 4px solid var(--primary-color);">
                            <h4 style="color: var(--primary-color); margin-bottom: 10px;">üéÆ Demo Version</h4>
                            <ul style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                <li>‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</li>
                                <li>‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</li>
                                <li>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö</li>
                                <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ñ‡∏≤‡∏ß‡∏£</li>
                                <li>‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ Demo</li>
                            </ul>
                        </div>
                    `;
                }
                
                // Load demo data
                buildingsData = { ...sampleBuildings };
                roomsData = { ...sampleRooms };
                sheetsConfig.connected = false;
                
                showNotification('üéÆ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô Demo Version ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
                
            } else if (version === 'live') {
                if (versionStatus) {
                    versionStatus.innerHTML = '<i class="fas fa-broadcast-tower"></i> Live Mode ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                    versionStatus.className = 'status-indicator status-active';
                }
                
                if (versionDetails) {
                    versionDetails.innerHTML = `
                        <div style="background: #d4edda; padding: 20px; border-radius: var(--border-radius); border-left: 4px solid var(--accent-color);">
                            <h4 style="color: var(--accent-color); margin-bottom: 10px;">üî¥ Live Version</h4>
                            <ul style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                <li>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏∞‡∏ö‡∏ö</li>
                                <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</li>
                                <li>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô</li>
                                <li>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                                <li>‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</li>
                            </ul>
                        </div>
                    `;
                }
                
                showNotification('üî¥ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô Live Version ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
                
                // In live version, try to connect to Google Sheets
                if (sheetsConfig.url) {
                    setTimeout(() => {
                        testConnection();
                    }, 1000);
                }
            }
            
            updateDashboardStats();
            loadBuildingsTable();
            loadRoomsTable();
        }

        // =================== Dashboard Functions ===================
        
        function updateDashboardStats() {
            const buildingCount = Object.keys(buildingsData).length;
            const roomCount = Object.keys(roomsData).length;
            const activeRooms = Object.values(roomsData).filter(room => room.status === 'active').length;
            const sheetStatusText = currentVersion === 'live' ? (sheetsConfig.connected ? 'Connected' : 'Disconnected') : 'Demo Mode';
            
            const elements = {
                'buildingCount': buildingCount,
                'roomCount': roomCount,
                'activeRooms': activeRooms,
                'sheetStatus': sheetStatusText
            };
            
            Object.entries(elements).forEach(([id, value]) => {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = value;
                }
            });
        }

        // =================== Buildings Management ===================
        
        function loadBuildingsTable() {
            const tbody = document.getElementById('buildingsTableBody');
            if (!tbody) return;
            
            const buildings = Object.values(buildingsData);
            
            if (buildings.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            <i class="fas fa-building" style="font-size: 32px; margin-bottom: 10px; opacity: 0.3;"></i>
                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = buildings.map(building => `
                <tr>
                    <td><strong>${building.code}</strong></td>
                    <td>${building.name}</td>
                    <td>${building.floors} ‡∏ä‡∏±‡πâ‡∏ô</td>
                    <td>${building.rooms || 0} ‡∏´‡πâ‡∏≠‡∏á</td>
                    <td>
                        <span class="status-indicator ${building.status === 'active' ? 'status-active' : 'status-inactive'}">
                            ${building.status === 'active' ? '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô'}
                        </span>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-info" onclick="editBuilding('${building.code}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteBuilding('${building.code}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function openBuildingModal(buildingCode = null) {
            const modal = document.getElementById('buildingModal');
            const title = document.getElementById('buildingModalTitle');
            
            if (buildingCode) {
                // Edit mode
                const building = buildingsData[buildingCode];
                if (!building) return;
                
                editingBuilding = buildingCode;
                title.textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£';
                
                document.getElementById('buildingCode').value = building.code;
                document.getElementById('buildingName').value = building.name;
                document.getElementById('buildingFloors').value = building.floors;
                document.getElementById('buildingYear').value = building.year;
                document.getElementById('buildingDescription').value = building.description;
                
                // Disable code field in edit mode
                document.getElementById('buildingCode').disabled = true;
            } else {
                // Add mode
                editingBuilding = null;
                title.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà';
                
                // Clear form
                document.getElementById('buildingCode').value = '';
                document.getElementById('buildingName').value = '';
                document.getElementById('buildingFloors').value = '';
                document.getElementById('buildingYear').value = '';
                document.getElementById('buildingDescription').value = '';
                
                document.getElementById('buildingCode').disabled = false;
            }
            
            modal.style.display = 'flex';
        }

        function closeBuildingModal() {
            const modal = document.getElementById('buildingModal');
            modal.style.display = 'none';
            editingBuilding = null;
        }

        function saveBuildingData() {
            const code = document.getElementById('buildingCode').value.trim();
            const name = document.getElementById('buildingName').value.trim();
            const floors = parseInt(document.getElementById('buildingFloors').value) || 1;
            const year = parseInt(document.getElementById('buildingYear').value) || new Date().getFullYear();
            const description = document.getElementById('buildingDescription').value.trim();
            
            if (!code || !name) {
                showNotification('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£', 'error');
                return;
            }
            
            // Check if code already exists (only for new buildings)
            if (!editingBuilding && buildingsData[code]) {
                showNotification('‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß', 'error');
                return;
            }
            
            const buildingData = {
                code,
                name,
                floors,
                year,
                description,
                status: 'active',
                rooms: editingBuilding ? buildingsData[editingBuilding].rooms : 0,
                created: editingBuilding ? buildingsData[editingBuilding].created : new Date().toISOString().split('T')[0],
                updated: new Date().toISOString().split('T')[0]
            };
            
            buildingsData[code] = buildingData;
            
            // If editing and code changed, update related rooms
            if (editingBuilding && editingBuilding !== code) {
                Object.values(roomsData).forEach(room => {
                    if (room.building === editingBuilding) {
                        room.building = code;
                    }
                });
                delete buildingsData[editingBuilding];
            }
            
            // Save to appropriate storage
            if (currentVersion === 'live' && sheetsConfig.connected) {
                syncBuildingToSheets(buildingData);
            } else {
                localStorage.setItem('buildingsData', JSON.stringify(buildingsData));
            }
            
            loadBuildingsTable();
            updateDashboardStats();
            closeBuildingModal();
            
            showNotification(
                editingBuilding ? '‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' : '‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                'success'
            );
        }

        function editBuilding(buildingCode) {
            openBuildingModal(buildingCode);
        }

        function deleteBuilding(buildingCode) {
            const building = buildingsData[buildingCode];
            if (!building) return;
            
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ "${building.name}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏à‡∏∞‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ô‡∏µ‡πâ`)) {
                // Check if there are rooms in this building
                const roomsInBuilding = Object.values(roomsData).filter(room => room.building === buildingCode);
                if (roomsInBuilding.length > 0) {
                    if (!confirm(`‡∏û‡∏ö‡∏´‡πâ‡∏≠‡∏á ${roomsInBuilding.length} ‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ô‡∏µ‡πâ\n‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                        return;
                    }
                    
                    // Delete related rooms
                    roomsInBuilding.forEach(room => {
                        delete roomsData[room.code];
                    });
                }
                
                delete buildingsData[buildingCode];
                
                // Save to appropriate storage
                if (currentVersion === 'live' && sheetsConfig.connected) {
                    deleteBuildingFromSheets(buildingCode);
                } else {
                    localStorage.setItem('buildingsData', JSON.stringify(buildingsData));
                    localStorage.setItem('roomsData', JSON.stringify(roomsData));
                }
                
                loadBuildingsTable();
                loadRoomsTable();
                updateDashboardStats();
                
                showNotification('üóëÔ∏è ‡∏•‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            }
        }

        // =================== Image Upload Functions ===================
        
        let roomImages = [];
        let selectedPosition = { x: null, y: null };

        function handleImageSelect(event) {
            const files = Array.from(event.target.files);
            processImages(files);
        }

        function handleImageDrop(event) {
            event.preventDefault();
            event.stopPropagation();
            
            const container = document.getElementById('imageUploadContainer');
            container.classList.remove('dragover');
            
            const files = Array.from(event.dataTransfer.files).filter(file => file.type.startsWith('image/'));
            processImages(files);
        }

        function handleImageDragOver(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('imageUploadContainer').classList.add('dragover');
        }

        function handleImageDragLeave(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('imageUploadContainer').classList.remove('dragover');
        }

        function processImages(files) {
            files.forEach(file => {
                if (file.size > 5 * 1024 * 1024) {
                    showNotification(`‚ùå ‡πÑ‡∏ü‡∏•‡πå ${file.name} ‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB`, 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageData = {
                        name: file.name,
                        data: e.target.result,
                        size: file.size
                    };
                    
                    roomImages.push(imageData);
                    updateImagePreview();
                };
                reader.readAsDataURL(file);
            });
        }

        function updateImagePreview() {
            const container = document.getElementById('uploadedImages');
            if (!container) return;
            
            container.innerHTML = roomImages.map((image, index) => `
                <div class="uploaded-image">
                    <img src="${image.data}" alt="${image.name}">
                    <button class="remove-image" onclick="removeImage(${index})" title="‡∏•‡∏ö‡∏£‡∏π‡∏õ">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');
        }

        function removeImage(index) {
            roomImages.splice(index, 1);
            updateImagePreview();
        }

        function clearImages() {
            roomImages = [];
            updateImagePreview();
        }

        // =================== Position Selection Functions ===================
        
        function selectPosition(event) {
            const map = document.getElementById('positionMap');
            const marker = document.getElementById('positionMarker');
            const info = document.getElementById('positionInfo');
            
            if (!map || !marker || !info) return;
            
            const rect = map.getBoundingClientRect();
            const x = ((event.clientX - rect.left) / rect.width) * 100;
            const y = ((event.clientY - rect.top) / rect.height) * 100;
            
            selectedPosition = { x: Math.round(x * 10) / 10, y: Math.round(y * 10) / 10 };
            
            marker.style.left = selectedPosition.x + '%';
            marker.style.top = selectedPosition.y + '%';
            marker.style.display = 'block';
            
            info.innerHTML = `
                <i class="fas fa-check-circle" style="color: var(--accent-color);"></i> 
                ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: X: ${selectedPosition.x}%, Y: ${selectedPosition.y}%
            `;
        }

        function clearPosition() {
            selectedPosition = { x: null, y: null };
            const marker = document.getElementById('positionMarker');
            const info = document.getElementById('positionInfo');
            
            if (marker) marker.style.display = 'none';
            if (info) {
                info.innerHTML = '<i class="fas fa-info-circle"></i> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡πâ‡∏≠‡∏á (X: -, Y: -)';
            }
        }
        
        function loadRoomsTable() {
            const tbody = document.getElementById('roomsTableBody');
            if (!tbody) return;
            
            const rooms = Object.values(roomsData);
            
            if (rooms.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                            <i class="fas fa-door-open" style="font-size: 32px; margin-bottom: 10px; opacity: 0.3;"></i>
                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = rooms.map(room => {
                const building = buildingsData[room.building];
                return `
                    <tr>
                        <td><strong>${room.code}</strong></td>
                        <td>${room.name}</td>
                        <td>${building ? building.name : room.building}</td>
                        <td>‡∏ä‡∏±‡πâ‡∏ô ${room.floor || 'N/A'}</td>
                        <td>
                            <span style="background: rgba(102, 126, 234, 0.1); padding: 4px 8px; border-radius: 12px; font-size: 11px; color: var(--primary-color);">
                                ${getRoomTypeText(room.type)}
                            </span>
                        </td>
                        <td>
                            <span class="status-indicator ${getStatusClass(room.status)}">
                                ${getStatusText(room.status)}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-info" onclick="editRoom('${room.code}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="deleteRoom('${room.code}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function populateRoomBuildingSelect() {
            const select = document.getElementById('roomBuilding');
            if (!select) return;
            
            const buildings = Object.values(buildingsData);
            
            select.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£</option>' +
                buildings.map(building => 
                    `<option value="${building.code}">${building.name}</option>`
                ).join('');
        }

        function openRoomModal(roomCode = null) {
            const modal = document.getElementById('roomModal');
            const title = document.getElementById('roomModalTitle');
            
            populateRoomBuildingSelect();
            clearImages();
            clearPosition();
            
            if (roomCode) {
                // Edit mode
                const room = roomsData[roomCode];
                if (!room) return;
                
                editingRoom = roomCode;
                title.textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á';
                
                document.getElementById('roomCode').value = room.code;
                document.getElementById('roomName').value = room.name;
                document.getElementById('roomBuilding').value = room.building;
                document.getElementById('roomFloor').value = room.floor || '';
                document.getElementById('roomType').value = room.type || 'classroom';
                document.getElementById('roomDescription').value = room.description || '';
                document.getElementById('roomStatus').value = room.status || 'active';
                
                // Set position
                if (room.x !== undefined && room.y !== undefined) {
                    selectedPosition = { x: room.x, y: room.y };
                    const marker = document.getElementById('positionMarker');
                    const info = document.getElementById('positionInfo');
                    
                    if (marker) {
                        marker.style.left = room.x + '%';
                        marker.style.top = room.y + '%';
                        marker.style.display = 'block';
                    }
                    
                    if (info) {
                        info.innerHTML = `
                            <i class="fas fa-check-circle" style="color: var(--accent-color);"></i> 
                            ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: X: ${room.x}%, Y: ${room.y}%
                        `;
                    }
                }
                
                // Load existing images
                if (room.images && Array.isArray(room.images)) {
                    roomImages = room.images.map(url => ({
                        name: 'existing-image',
                        data: url,
                        size: 0
                    }));
                    updateImagePreview();
                }
                
                // Disable code field in edit mode
                document.getElementById('roomCode').disabled = true;
            } else {
                // Add mode
                editingRoom = null;
                title.textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà';
                
                // Clear form
                ['roomCode', 'roomName', 'roomFloor', 'roomDescription'].forEach(id => {
                    document.getElementById(id).value = '';
                });
                document.getElementById('roomBuilding').value = '';
                document.getElementById('roomType').value = 'classroom';
                document.getElementById('roomStatus').value = 'active';
                
                document.getElementById('roomCode').disabled = false;
            }
            
            modal.style.display = 'flex';
        }

        function closeRoomModal() {
            const modal = document.getElementById('roomModal');
            modal.style.display = 'none';
            editingRoom = null;
            clearImages();
            clearPosition();
        }

        function saveRoomData() {
            const code = document.getElementById('roomCode').value.trim();
            const name = document.getElementById('roomName').value.trim();
            const building = document.getElementById('roomBuilding').value;
            const floor = parseInt(document.getElementById('roomFloor').value) || 1;
            const type = document.getElementById('roomType').value;
            const description = document.getElementById('roomDescription').value.trim();
            const status = document.getElementById('roomStatus').value;
            
            if (!code || !name || !building) {
                showNotification('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (‡∏£‡∏´‡∏±‡∏™, ‡∏ä‡∏∑‡πà‡∏≠, ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£)', 'error');
                return;
            }
            
            if (selectedPosition.x === null || selectedPosition.y === null) {
                showNotification('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà', 'error');
                return;
            }
            
            // Check if code already exists (only for new rooms)
            if (!editingRoom && roomsData[code]) {
                showNotification('‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß', 'error');
                return;
            }
            
            // Check if building exists
            if (!buildingsData[building]) {
                showNotification('‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å', 'error');
                return;
            }
            
            const roomData = {
                code,
                name,
                building,
                floor,
                type,
                description,
                status,
                x: selectedPosition.x,
                y: selectedPosition.y,
                images: roomImages.map(img => img.data),
                created: editingRoom ? roomsData[editingRoom].created : new Date().toISOString().split('T')[0],
                updated: new Date().toISOString().split('T')[0]
            };
            
            roomsData[code] = roomData;
            
            // If editing and code changed
            if (editingRoom && editingRoom !== code) {
                delete roomsData[editingRoom];
            }
            
            // Update building room count
            updateBuildingRoomCount();
            
            // Save to appropriate storage
            if (currentVersion === 'live' && sheetsConfig.connected) {
                syncRoomToSheets(roomData);
            } else {
                localStorage.setItem('roomsData', JSON.stringify(roomsData));
                localStorage.setItem('buildingsData', JSON.stringify(buildingsData));
            }
            
            loadRoomsTable();
            loadBuildingsTable();
            updateDashboardStats();
            closeRoomModal();
            
            showNotification(
                editingRoom ? '‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' : '‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                'success'
            );
        }

        function editRoom(roomCode) {
            openRoomModal(roomCode);
        }

        function deleteRoom(roomCode) {
            const room = roomsData[roomCode];
            if (!room) return;
            
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á "${room.name}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                delete roomsData[roomCode];
                
                // Update building room count
                updateBuildingRoomCount();
                
                // Save to appropriate storage
                if (currentVersion === 'live' && sheetsConfig.connected) {
                    deleteRoomFromSheets(roomCode);
                } else {
                    localStorage.setItem('roomsData', JSON.stringify(roomsData));
                    localStorage.setItem('buildingsData', JSON.stringify(buildingsData));
                }
                
                loadRoomsTable();
                loadBuildingsTable();
                updateDashboardStats();
                
                showNotification('üóëÔ∏è ‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            }
        }

        function updateBuildingRoomCount() {
            // Reset all room counts
            Object.keys(buildingsData).forEach(code => {
                buildingsData[code].rooms = 0;
            });
            
            // Count rooms for each building
            Object.values(roomsData).forEach(room => {
                if (buildingsData[room.building]) {
                    buildingsData[room.building].rooms++;
                }
            });
        }

        function getRoomTypeText(type) {
            const types = {
                'classroom': '‡∏´‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô',
                'computer': '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå',
                'lab': '‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£',
                'library': '‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î',
                'office': '‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
                'facility': '‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å'
            };
            return types[type] || type;
        }

        function getStatusClass(status) {
            const statusClasses = {
                'active': 'status-active',
                'inactive': 'status-inactive',
                'maintenance': 'status-error'
            };
            return statusClasses[status] || 'status-inactive';
        }

        function getStatusText(status) {
            const statusTexts = {
                'active': '‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
                'inactive': '‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
                'maintenance': '‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á'
            };
            return statusTexts[status] || status;
        }

        // =================== Google Sheets Functions ===================
        
        function updateSheetsStatus() {
            const connectionDot = document.getElementById('connectionDot');
            const connectionStatus = document.getElementById('connectionStatus');
            
            if (currentVersion === 'demo') {
                if (connectionDot) {
                    connectionDot.className = 'status-dot disconnected';
                }
                if (connectionStatus) {
                    connectionStatus.innerHTML = 'Demo Mode';
                    connectionStatus.className = 'status-indicator status-connected';
                }
            } else if (sheetsConfig.connected) {
                if (connectionDot) {
                    connectionDot.className = 'status-dot connected';
                }
                if (connectionStatus) {
                    connectionStatus.innerHTML = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß';
                    connectionStatus.className = 'status-indicator status-connected';
                }
            } else {
                if (connectionDot) {
                    connectionDot.className = 'status-dot disconnected';
                }
                if (connectionStatus) {
                    connectionStatus.innerHTML = '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
                    connectionStatus.className = 'status-indicator status-error';
                }
            }
        }

        function testConnection() {
            if (currentVersion === 'demo') {
                showNotification('üí° ‡πÉ‡∏ô Demo Mode ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets', 'info');
                return;
            }
            
            const url = document.getElementById('sheetsUrl').value.trim();
            if (!url) {
                showNotification('‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Sheets', 'error');
                return;
            }
            
            // Simulate connection test
            showNotification('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...', 'info');
            
            setTimeout(() => {
                // In real implementation, this would actually test the connection
                const isValid = url.includes('docs.google.com/spreadsheets');
                
                if (isValid) {
                    sheetsConfig.connected = true;
                    sheetsConfig.url = url;
                    updateSheetsStatus();
                    showNotification('‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                } else {
                    sheetsConfig.connected = false;
                    updateSheetsStatus();
                    showNotification('‚ùå URL ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ', 'error');
                }
            }, 2000);
        }

        function saveSheetConfig() {
            const url = document.getElementById('sheetsUrl').value.trim();
            const buildingsSheet = document.getElementById('buildingsSheetName').value.trim();
            const roomsSheet = document.getElementById('roomsSheetName').value.trim();
            
            sheetsConfig.url = url;
            sheetsConfig.buildingsSheet = buildingsSheet || 'Buildings';
            sheetsConfig.roomsSheet = roomsSheet || 'Rooms';
            
            localStorage.setItem('sheetsConfig', JSON.stringify(sheetsConfig));
            
            showNotification('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
        }

        function syncSheetData() {
            if (currentVersion === 'demo') {
                showNotification('üí° ‡πÉ‡∏ô Demo Mode ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'info');
                return;
            }
            
            if (!sheetsConfig.connected) {
                showNotification('‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets', 'error');
                return;
            }
            
            showNotification('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏±‡∏ö Google Sheets...', 'info');
            
            // Simulate sync process
            setTimeout(() => {
                // In real implementation, this would sync with Google Sheets
                addSyncHistoryItem('‚úÖ ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                showNotification('‚úÖ ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏±‡∏ö Google Sheets ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
            }, 3000);
        }

        function addSyncHistoryItem(message, type) {
            const syncHistory = document.getElementById('syncHistory');
            if (!syncHistory) return;
            
            const now = new Date().toLocaleString('th-TH');
            const item = document.createElement('div');
            item.style.cssText = `
                padding: 15px;
                border-left: 4px solid ${type === 'success' ? 'var(--accent-color)' : 'var(--danger-color)'};
                background: ${type === 'success' ? 'rgba(40, 167, 69, 0.1)' : 'rgba(220, 53, 69, 0.1)'};
                margin-bottom: 10px;
                border-radius: var(--border-radius);
            `;
            item.innerHTML = `
                <div style="font-weight: 600; margin-bottom: 5px;">${message}</div>
                <div style="font-size: 12px; color: var(--text-secondary);">${now}</div>
            `;
            
            // Clear empty state message
            if (syncHistory.querySelector('p')) {
                syncHistory.innerHTML = '';
            }
            
            syncHistory.insertBefore(item, syncHistory.firstChild);
        }

        // Mock Google Sheets sync functions
        function syncBuildingToSheets(building) {
            // In real implementation, this would sync to Google Sheets
            console.log('Syncing building to sheets:', building);
        }

        function deleteBuildingFromSheets(buildingCode) {
            // In real implementation, this would delete from Google Sheets
            console.log('Deleting building from sheets:', buildingCode);
        }

        function syncRoomToSheets(room) {
            // In real implementation, this would sync to Google Sheets
            console.log('Syncing room to sheets:', room);
        }

        function deleteRoomFromSheets(roomCode) {
            // In real implementation, this would delete from Google Sheets
            console.log('Deleting room from sheets:', roomCode);
        }

        // =================== Settings Functions ===================
        
        function saveSettings() {
            const schoolName = document.getElementById('schoolName').value.trim();
            const defaultLanguage = document.getElementById('defaultLanguage').value;
            const welcomeMessage = document.getElementById('welcomeMessage').value.trim();
            
            const settings = {
                schoolName,
                defaultLanguage,
                welcomeMessage
            };
            
            localStorage.setItem('systemSettings', JSON.stringify(settings));
            showNotification('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
        }

        function resetSettings() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                document.getElementById('schoolName').value = '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞';
                document.getElementById('defaultLanguage').value = 'th';
                document.getElementById('welcomeMessage').value = '';
                
                showNotification('üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            }
        }

        // =================== Data Management ===================
        
        function exportData() {
            const data = {
                version: currentVersion,
                buildings: buildingsData,
                rooms: roomsData,
                sheets: sheetsConfig,
                exported: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `school-map-backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('üì• Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
        }

        function syncData() {
            if (currentVersion === 'live' && sheetsConfig.connected) {
                syncSheetData();
            } else {
                showNotification('üîÑ ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Local ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'info');
            }
        }

        function backupData() {
            exportData();
        }

        function clearDemoData() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Demo ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                buildingsData = {};
                roomsData = {};
                localStorage.removeItem('buildingsData');
                localStorage.removeItem('roomsData');
                
                loadBuildingsTable();
                loadRoomsTable();
                updateDashboardStats();
                
                showNotification('üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Demo ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢', 'success');
            }
        }

        function resetSystem() {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô: ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î!')) {
                if (confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á: ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) {
                    localStorage.clear();
                    sessionStorage.clear();
                    location.reload();
                }
            }
        }

        // =================== Event Handlers ===================
        
        function setupEventHandlers() {
            // Close modals when clicking outside
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal-overlay')) {
                    closeBuildingModal();
                    closeRoomModal();
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeBuildingModal();
                    closeRoomModal();
                }
                
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    syncData();
                }
            });
            
            // Mobile menu toggle
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('sidebar-toggle') && window.innerWidth <= 768) {
                    const sidebar = document.getElementById('sidebar');
                    if (sidebar) {
                        sidebar.classList.toggle('show');
                    }
                }
            });
        }

        // =================== Initialization ===================
        
        function loadInitialData() {
            // Load saved version
            const savedVersion = localStorage.getItem('systemVersion') || 'demo';
            
            // Load data based on version
            if (savedVersion === 'demo') {
                buildingsData = { ...sampleBuildings };
                roomsData = { ...sampleRooms };
            } else {
                const savedBuildings = localStorage.getItem('buildingsData');
                const savedRooms = localStorage.getItem('roomsData');
                const savedSheets = localStorage.getItem('sheetsConfig');
                
                buildingsData = savedBuildings ? JSON.parse(savedBuildings) : {};
                roomsData = savedRooms ? JSON.parse(savedRooms) : {};
                
                if (savedSheets) {
                    sheetsConfig = { ...sheetsConfig, ...JSON.parse(savedSheets) };
                }
            }
            
            setVersion(savedVersion);
            
            // Load settings
            const savedSettings = localStorage.getItem('systemSettings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    if (document.getElementById('schoolName')) {
                        document.getElementById('schoolName').value = settings.schoolName || '‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞';
                    }
                    if (document.getElementById('defaultLanguage')) {
                        document.getElementById('defaultLanguage').value = settings.defaultLanguage || 'th';
                    }
                    if (document.getElementById('welcomeMessage')) {
                        document.getElementById('welcomeMessage').value = settings.welcomeMessage || '';
                    }
                } catch (error) {
                    console.error('Error loading settings:', error);
                }
            }
            
            // Load Google Sheets config
            if (sheetsConfig.url && document.getElementById('sheetsUrl')) {
                document.getElementById('sheetsUrl').value = sheetsConfig.url;
                document.getElementById('buildingsSheetName').value = sheetsConfig.buildingsSheet;
                document.getElementById('roomsSheetName').value = sheetsConfig.roomsSheet;
            }
        }

        function initializeAdmin() {
            try {
                loadInitialData();
                setupEventHandlers();
                updateDashboardStats();
                loadBuildingsTable();
                
                setTimeout(() => {
                    showNotification('üéâ Admin Panel ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!', 'success');
                }, 1000);
                
                console.log('üè´ Admin Panel v6 Initialized');
                console.log('‚ú® Features: Login System, Mobile Nav, CRUD Buildings/Rooms, Deployment Guide');
                
            } catch (error) {
                console.error('Admin initialization error:', error);
                showNotification('‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ', 'error');
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            if (checkLoginStatus()) {
                initializeAdmin();
            }
        });

        console.log('üéâ ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ v6 - Admin Panel ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!');
        console.log('üîê Login System: admin/1234');
        console.log('üì± Mobile Navigation: ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠');
        console.log('üöÄ Deployment Guide: ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ Deploy ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
        console.log('üè¢ CRUD Buildings: ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£');
        console.log('üö™ CRUD Rooms: ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á + ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ + Interactive Map');
        console.log('üìä Google Sheets: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏∞‡∏ö‡∏ö + ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ Setup ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
    </script>
</body>
</html>
                